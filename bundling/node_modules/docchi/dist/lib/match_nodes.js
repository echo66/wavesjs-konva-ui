'use strict';

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _array_proxy = require('./array_proxy');

/**
 * Match comments to nodes.
 */

var arrayProxy = _interopRequireWildcard(_array_proxy);

exports['default'] = function (comments, nodes) {
  return comments.map(function (comment) {
    var obj = {
      comment: {
        type: comment.type.toLowerCase(),
        value: comment.value,
        location: comment.loc
      }
    };

    var match = arrayProxy.find(nodes, function (node) {
      return comment.end <= node.start;
    });

    if (match) obj.context = match;

    return obj;
  }).map(function (obj, index, array) {
    // Remove duplicate matches.
    if (obj.context) {
      var nextObj = array[index + 1];
      if (nextObj && nextObj.context && nextObj.context.start === obj.context.start && nextObj.context.end === obj.context.end) delete obj.context;else {
        delete obj.context.start;
        delete obj.context.end;
      }
    }

    return obj;
  });
};

module.exports = exports['default'];