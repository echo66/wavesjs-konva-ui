!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.wavesUI=e()}}(function(){var e;return function t(e,i,n){function a(s,o){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return a(i?i:t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/set")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("../core/layer"),u=l(h),c=e("../shapes/segment"),d=l(c),f=e("../behaviors/base-behavior"),p=l(f),v=function(e){function t(e,i){var a=this;s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"entity",[],i),this._generator=e,this._contextShape=new d["default"]({}),this._contextShape.install({opacity:function(){return 1},color:function(){return a.params.context.color},width:function(){return a.timeContext.visibleDuration},height:function(){return a._renderingContext.valueToPixel.domain()[1]},y:function(){return a._renderingContext.valueToPixel.domain()[0]},x:function(){return-a.timeContext.offset}}),this._contextShape.params.handlerWidth=this.params.context.handlerWidth,this._contextShape.render(this._renderingContext),this._contextShape.layer=this;for(var r=0;r<this._contextShape.$el.length;r++)this._contextLayer.add(this._contextShape.$el[r]);this.setBehavior(new p["default"])}return a(t,e),r(t,[{key:"_generateData",value:function(){var e=this;this.contentLayers.forEach(function(t){t.destroy(),e.contentLayers["delete"](t)});var t=this._generator(this.timeContext);this.set([t])}},{key:"update",value:function(){this._generateData(),n(Object.getPrototypeOf(t.prototype),"update",this).call(this)}},{key:"updateContainer",value:function(){this._updateRenderingContext()}},{key:"updateShapes",value:function(){var e=new o,t=this;this.allocateShapesToContentLayers(this._stage,this.data,"datums",!0).forEach(function(t){e.add(t)}),e.forEach(function(e){e.y(t.params.top).offsetX(0),e.clear(),e.batchDraw()}),this._contextShape.update(this._renderingContext,this.timeContext),this._contextLayer.y(t.params.top).batchDraw().moveToBottom()}},{key:"_updateRenderingContext",value:function(){this._renderingContext.timeToPixel=this.timeContext.timeToPixel,this._renderingContext.valueToPixel=this._valueToPixel,this._renderingContext.height=this.params.height,this._renderingContext.width=this.timeContext.timeToPixel(this.timeContext.visibleDuration),this._renderingContext.offsetX=this.timeContext.timeToPixel(this.timeContext.offset),this._renderingContext.trackOffsetX=this.timeContext.timeToPixel(this.timeContext.offset),this._renderingContext.visibleWidth=this.timeContext.visibleWidth}},{key:"visible_data",value:function(e,t){return void 0}},{key:"sort_data",value:function(e){}},{key:"stretchRatio",set:function(e){},get:function(){}},{key:"offset",set:function(e){},get:function(){}},{key:"start",set:function(e){},get:function(){}},{key:"duration",set:function(e){},get:function(){}},{key:"generator",set:function(e){this._generator=e},get:function(){return this._generator}}]),t}(u["default"]);i["default"]=v,t.exports=v,t.exports=i["default"]},{"../behaviors/base-behavior":4,"../core/layer":17,"../shapes/segment":47,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],2:[function(e,t,i){"use strict";function n(e,t){var i=e/60,n=(1/parseInt(t.split("/")[1],10),parseInt(t.split("/")[0],10));return function(e){for(var t=e.visibleDuration,a=e.offset,r=[],s=-a,o=t-a,l=e.computedPixelsPerSecond,h=1/i,u=s%h,c=(s-u)/h,d=h*c,f=c%n,p=l/i,v=5,m=d;o>m;m+=h){var g=f++%n===0;v>=p&&!g||r.push({time:m,focused:g})}return r}}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n,t.exports=n,t.exports=i["default"]},{}],3:[function(e,t,i){"use strict";function n(){return function(e){var t=e.visibleDuration,i=e.offset,n=[],r=-i,s=t-i,o=e.computedPixelsPerSecond,l=7,h=void 0,u=void 0,c=void 0,d=void 0,f=void 0;4*o>l&&(h=1,c=0,d=60,f=5,u="60sec"),2*o>l&&(h=1,c=0,d=30,f=1,u="30sec"),o>l&&(h=1,c=0,d=10,f=1,u="sec"),o/10>l&&(h=.1,c=1,d=10,f=1,u="ds"),o/100>l&&(h=.01,c=2,d=10,f=1,u="cs"),o/1e3>l&&(h=.001,c=3,d=10,f=1,u="ms");for(var p=r;s>p;p+=h){var v=p.toFixed(c);if(Math.round(v/h)%f===0){var m=Math.round(v/h)%d===0?!0:!1,g={time:v,focused:m};if(m===!0){var b=new Date(1e3*v),y=(0,a.padLeft)(b.getMinutes(),0,2),_=(0,a.padLeft)(b.getSeconds(),0,2),x=(0,a.padLeft)(b.getMilliseconds(),0,3),k=y+":"+_+":"+x;g.label=k}n.push(g)}}return n}}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n;var a=e("../utils/format");t.exports=n,t.exports=i["default"]},{"../utils/format":64}],4:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],r=e("babel-runtime/core-js/set")["default"];Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(){a(this,e),this._selectedDatums=new r,this._selectedClass=null,this._layer=null}return n(e,[{key:"initialize",value:function(e){this._layer=e,this._selectedClass=e.params.selectedClassName}},{key:"destroy",value:function(){this._selectedDatums.clear()}},{key:"select",value:function(e){this._selectedDatums.add(e)}},{key:"unselect",value:function(e){this._selectedDatums["delete"](e)}},{key:"toggleSelection",value:function(e){var t=this._selectedDatums.has(e)?"unselect":"select";this[t](e)}},{key:"edit",value:function(e,t,i,n,a,r){}},{key:"can",value:function(e,t){return!0}},{key:"create",value:function(e){}},{key:"remove",value:function(e){}},{key:"minimize",value:function(){}},{key:"highlight",value:function(e,t){}},{key:"selectedClass",set:function(e){this._selectedClass=e},get:function(){return this._selectedClass}},{key:"selectedDatums",get:function(){return this._selectedDatums}}]),e}();i["default"]=s,t.exports=i["default"]},{"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81}],5:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._beatGrid=e}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s="move";if(r.hasName("handler"))if(r.hasName("left"))s="resizeLeft";else{if(!r.hasName("right"))throw new Error("Unexpected konva shape name");s="resizeRight"}else{if(!r.hasName("segment"))throw new Error("Unexpected konva shape name");s="move"}this["_"+s](e,t,i,n,a,r)}},{key:"_move",value:function(e,t,i,n,a,r){var s=e.timeToPixel,o=e.height,l=e.timeToPixel(t.x(i)),h=e.valueToPixel(t.y(i)),u=(e.timeToPixel(t.width(i)),e.valueToPixel(t.height(i))),c=Math.max(l+n,0),d=h+a;d>o?d=o:0>d-(o-u)&&(d=o-u);var f=this._beatGrid.beat(s.invert(c)),p=this._beatGrid.seconds(Math.round(f)),v=this._beatGrid.beat(s.invert(c)+t.width(i)),m=this._beatGrid.seconds(Math.round(v));p!==m&&(t.x(i,p),t.width(i,m-p),t.y(i,e.valueToPixel.invert(d)))}},{key:"_resizeLeft",value:function(e,t,i,n,a,r){var s=e.timeToPixel,o=s(t.x(i)),l=s(t.width(i)),h=o+l,u=h>o+n?Math.max(o+n,0):o,c=0!==u?Math.max(l-n,1):l,d=this._beatGrid.beat(s.invert(u)),f=this._beatGrid.seconds(Math.round(d)),p=this._beatGrid.beat(s.invert(u)+s.invert(c)),v=this._beatGrid.seconds(Math.round(p));f!==v&&(t.x(i,f),t.width(i,v-f))}},{key:"_resizeRight",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.width(i)),o=Math.max(s+n,1),l=this._beatGrid.beat(t.x(i)+e.timeToPixel.invert(o)),h=this._beatGrid.seconds(Math.round(l));h-t.x(i)&&t.width(i,h-t.x(i))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});t?i.params.color="red":i.params.color="black"}},{key:"beatGrid",set:function(e){this._beatGrid=e},get:function(){return this._beatGrid}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],6:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s=this._layer.data,o=e.height,l=e.timeToPixel(t.x(i)),h=e.valueToPixel(t.y(i)),u=l+n,c=h+a;if(s.length>2){var d=s.map(function(i){return e.timeToPixel(t.x(i))});d.sort(function(e,t){return t>e?-1:1});var f=d.indexOf(l);(u<d[f-1]||u>d[f+1])&&(u=l)}0>u&&(u=0),0>c?c=0:c>o&&(c=o),t.x(i,e.timeToPixel.invert(u)),t.y(i,e.valueToPixel.invert(c))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});t?i.params.color="red":i.params.color="black"}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],7:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.x(i)),o=s+n>0?s+n:0;t.x(i,e.timeToPixel.invert(o))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});if(t)i.params.color="red",i.params.handlerColor="red";else{var n=i._getDefaults();i.params.color=n.color,i.params.handlerColor=n.handlerColor}}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],8:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"select",value:function(e){}},{key:"unselect",value:function(e){}},{key:"toggleSelection",value:function(e){}},{key:"edit",value:function(e,t,i,n,a,r){}},{key:"can",value:function(e,t){return!1}},{key:"create",value:function(e){}},{key:"remove",value:function(e){}},{key:"minimize",value:function(){}},{key:"highlight",value:function(e,t){}},{key:"selectedClass",set:function(e){},get:function(){}},{key:"selectedDatums",get:function(){}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],9:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.targetTimeline=e}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s="move";if(r.hasName("handler"))if(r.hasName("left"))s="resizeLeft";else{if(!r.hasName("right"))throw new Error("Unexpected konva shape name");s="resizeRight"}else{if(!r.hasName("segment"))throw new Error("Unexpected konva shape name");s="move"}this["_"+s](e,t,i,n,a,r)}},{key:"_move",value:function(e,t,i,n,a,r){var s=e.height,o=e.timeToPixel(t.x(i)),l=e.valueToPixel(t.y(i)),h=(e.timeToPixel(t.width(i)),e.valueToPixel(t.height(i))),u=Math.max(o+n,0),c=l+a;c>s?c=s:0>c-(s-h)&&(c=s-h),t.x(i,e.timeToPixel.invert(u)),t.y(i,e.valueToPixel.invert(c)),this.targetTimeline.visibleInterval={start:t.x(i),duration:t.width(i)},this.targetTimeline.tracks.update()}},{key:"_resizeLeft",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.x(i)),o=e.timeToPixel(t.width(i)),l=s+o,h=l>s+n?Math.max(s+n,0):s,u=0!==h?Math.max(o-n,1):o;t.x(i,e.timeToPixel.invert(h)),t.width(i,e.timeToPixel.invert(u)),this.targetTimeline.visibleInterval={start:t.x(i),duration:t.width(i)},this.targetTimeline.tracks.update()}},{key:"_resizeRight",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.width(i)),o=Math.max(s+n,1);t.width(i,e.timeToPixel.invert(o)),this.targetTimeline.visibleInterval={start:t.x(i),duration:t.width(i)},this.targetTimeline.tracks.update()}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],10:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s="move";if(r.hasName("handler"))if(r.hasName("left"))s="resizeLeft";else{if(!r.hasName("right"))throw new Error("Unexpected konva shape name");s="resizeRight"}else{if(!r.hasName("segment"))throw new Error("Unexpected konva shape name");s="move"}this["_"+s](e,t,i,n,a,r)}},{key:"_move",value:function(e,t,i,n,a,r){var s=e.height,o=e.timeToPixel(t.x(i)),l=e.valueToPixel(t.y(i)),h=(e.timeToPixel(t.width(i)),e.valueToPixel(t.height(i))),u=Math.max(o+n,0),c=l+a;c>s?c=s:0>c-(s-h)&&(c=s-h),t.x(i,e.timeToPixel.invert(u)),t.y(i,e.valueToPixel.invert(c))}},{key:"_resizeLeft",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.x(i)),o=e.timeToPixel(t.width(i)),l=s+o,h=l>s+n?Math.max(s+n,0):s,u=0!==h?Math.max(o-n,1):o;t.x(i,e.timeToPixel.invert(h)),t.width(i,e.timeToPixel.invert(u))}},{key:"_resizeRight",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.width(i)),o=Math.max(s+n,1);t.width(i,e.timeToPixel.invert(o))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});t?i.params.color="red":i.params.color="black"}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],11:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s=this._layer.data,o=e.height,l=e.timeToPixel(t.x(i)),h=e.valueToPixel(t.y(i)),u=l+n,c=h+a;if(s.length>2){var d=s.map(function(i){var n=e.timeToPixel(t.x(i)),a=e.timeToPixel(t.x(i)+t.width(i));return{start:n,end:n+a}});d.sort(function(e,t){return e.start<t.start?-1:1});var f=d.indexOf(l);(u<d[f-1].end||u+t.width(i)>d[f+1].start)&&(u=l)}0>u&&(u=0),0>c?c=0:c>o&&(c=o),t.x(i,e.timeToPixel.invert(u)),t.y(i,e.valueToPixel.invert(c))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});t?i.params.color="red":i.params.color="black"}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],12:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s="move";if(r.hasName("handler"))if(r.hasName("left"))s="resizeLeft";else{if(!r.hasName("right"))throw new Error("Unexpected konva shape name");s="resizeRight"}else{if(!r.hasName("segment"))throw new Error("Unexpected konva shape name");s="move"}this["_"+s](e,t,i,n,a,r)}},{key:"_move",value:function(e,t,i,n,a,r){var s=e.height,o=e.timeToPixel(t.x(i)),l=e.valueToPixel(t.y(i)),h=(e.timeToPixel(t.width(i)),e.valueToPixel(t.height(i))),u=Math.max(o+n,0),c=l+a;c>s?c=s:0>c-(s-h)&&(c=s-h),t.x(i,e.timeToPixel.invert(u)),t.y(i,e.valueToPixel.invert(c));var d=e.timeToPixel(Math.round(t.x(i)));t.x(i,e.timeToPixel.invert(d))}},{key:"_resizeLeft",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.x(i)),o=e.timeToPixel(t.width(i)),l=s+o,h=l>s+n?Math.max(s+n,0):s,u=0!==h?Math.max(o-n,1):o;t.x(i,e.timeToPixel.invert(h)),t.width(i,e.timeToPixel.invert(u))}},{key:"_resizeRight",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.width(i)),o=Math.max(s+n,1);t.width(i,e.timeToPixel.invert(o))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});t?i.params.color="red":i.params.color="black"}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],13:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n){var a=e.timeContext;if(n.hasName("handler"))if(n.hasName("left"))this._editLeft(a,t);else{if(!n.hasName("right"))throw new Error("Unexpected konva shape name");this._editRight(a,t)}else{if(!n.hasName("segment"))throw new Error("Unexpected konva shape name");this._move(a,t)}}},{key:"_editLeft",value:function(e,t){var i=e.parent.timeToPixel(e.start),n=e.timeToPixel(e.offset),a=e.timeToPixel(e.duration),r=i+t,s=n-t,o=Math.max(a-t,1);e.start=e.parent.timeToPixel.invert(r),e.offset=e.timeToPixel.invert(s),e.duration=e.timeToPixel.invert(o)}},{key:"_editRight",value:function(e,t){var i=e.timeToPixel(e.duration),n=Math.max(i+t,1);e.duration=e.timeToPixel.invert(n)}},{key:"_move",value:function(e,t){var i=e.parent.timeToPixel(e.start),n=Math.max(i+t,0);e.start=e.parent.timeToPixel.invert(n)}},{key:"stretch",value:function(e,t,i,n){var a=e.timeContext,r=a.duration,s=a.offset;this.edit(e,t,i,n);var o=a.duration,l=o/r;a.stretchRatio*=l,a.offset=s,a.duration=r}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],14:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){if(r.hasName("min"))this._editRange(e,t,i,n,-a,"min");else if(r.hasName("max"))this._editRange(e,t,i,n,-a,"max");else{if(!r.hasName("mean"))throw new Error("Unexpected konva shape name");this._editMean(e,t,i,n,-a)}}},{key:"_editMean",value:function(e,t,i,n,a){var r=e.timeToPixel(t.x(i)),s=e.valueToPixel(t.mean(i)),o=r+n,l=s-a;t.x(i,e.timeToPixel.invert(o)),t.mean(i,e.valueToPixel.invert(l))}},{key:"_editRange",value:function(e,t,i,n,a,r){var s=e.valueToPixel(t.range(i)),o="min"===r?s+2*a:s-2*a;o=Math.max(o,0),t.range(i,Math.max(0,e.valueToPixel.invert(o)))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer});if(t)i.params.meanColor="red",i.params.rangeColor="red";else{var n=i._getDefaults();i.params.meanColor=n.meanColor,i.params.rangeColor=n.rangeColor}}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],15:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-behavior"),h=o(l),u=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"edit",value:function(e,t,i,n,a,r){var s="move";if(r.hasName("handler"))if(r.hasName("left"))s="resizeLeft";else{if(!r.hasName("right"))throw new Error("Unexpected konva shape name");s="resizeRight"}else{if(!r.hasName("body")){if(r.hasName("header"))return;throw new Error("Unexpected konva shape name")}s="move"}this["_"+s](e,t,i,n,a,r)}},{key:"_move",value:function(e,t,i,n,a,r){var s=e.height,o=e.timeToPixel(t.x(i)),l=0,h=(e.timeToPixel(t.width(i)),e.height),u=Math.max(o+n,0),c=l+a;c>s?c=s:0>c-(s-h)&&(c=s-h),t.x(i,e.timeToPixel.invert(u))}},{key:"_resizeLeft",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.x(i)),o=e.timeToPixel(t.width(i)),l=s+o,h=l>s+n?Math.max(s+n,0):s,u=0!==h?Math.max(o-n,1):o;t.x(i,e.timeToPixel.invert(h)),t.width(i,e.timeToPixel.invert(u))}},{key:"_resizeRight",value:function(e,t,i,n,a,r){var s=e.timeToPixel(t.width(i)),o=Math.max(s+n,1);t.width(i,e.timeToPixel.invert(o))}},{key:"select",value:function(e){n(Object.getPrototypeOf(t.prototype),"select",this).call(this,e),this.highlight(e,!0)}},{key:"unselect",value:function(e){n(Object.getPrototypeOf(t.prototype),"unselect",this).call(this,e),this.highlight(e,!1)}},{key:"highlight",value:function(e,t){var i=this._layer.getShapeFromDatum(e);if(!i)throw new Error("No shape for this datum in this layer",{datum:e,layer:this._layer})}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-behavior":4,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],16:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],r=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var s=e("../utils/scales"),o=r(s),l=function(){function e(t){if(a(this,e),!t)throw new Error("LayerTimeContext must have a parent");this.parent=t,this._lockedToParentInterval=!1,this._timeToPixel=null,this._start=0,this._duration=t.visibleDuration,this._offset=0,this._stretchRatio=1,this.parent._children.push(this)}return n(e,[{key:"clone",value:function(){var e=new this;return e.parent=this.parent,e.start=this.start,e.duration=this.duration,e.offset=this.offset,e.stretchRatio=this.stretchRatio,e}},{key:"pixelToTime",value:function(e){return this._timeToPixel?this._timeToPixel.invert(e):this.parent.timeToPixel.invert(e)}},{key:"start",get:function(){return this._lockedToParentInterval?-this.parent.offset:this._start},set:function(e){this._start=e}},{key:"duration",get:function(){return this._lockedToParentInterval?this.parent.visibleDuration:this._duration},set:function(e){this._duration=e}},{key:"offset",get:function(){return this._lockedToParentInterval?this.parent.offset:this._offset},set:function(e){this._offset=e}},{key:"stretchRatio",get:function(){return this._stretchRatio},set:function(e){if(1===e)return void(this._timeToPixel=null);var t=this._timeToPixel?this._timeToPixel:o["default"].linear().domain([0,1]);t.range([0,this.parent.computedPixelsPerSecond*e]),this._timeToPixel=t,this._stretchRatio=e}},{key:"timeToPixel",get:function(){return this._timeToPixel?this._timeToPixel:this.parent.timeToPixel}},{key:"visibleInterval",get:function(){var e={};return e.start=-this.offset,e.duration=this.duration,e},set:function(e){this.offset=-e.start,this.duration=e.duration}},{key:"lockedToParentInterval",get:function(){return this._lockedToParentInterval},set:function(e){this._lockedToParentInterval=e}}]),e}();i["default"]=l,t.exports=i["default"]},{"../utils/scales":66,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/interop-require-default":84}],17:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/object/assign")["default"],l=e("babel-runtime/core-js/map")["default"],h=e("babel-runtime/core-js/set")["default"],u=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var c=e("../utils/scales"),d=u(c),f=e("events"),p=u(f),v=e("../shapes/segment"),m=u(v),g=e("../behaviors/time-context-behavior"),b=u(g),y=e("konva"),_=u(y),x=function(e){function t(e,i,a){var r=this;s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.dataType=e,a||(a={});var u={height:100,top:0,opacity:1,yDomain:[0,1],className:null,selectedClassName:"selected",context:{handlerWidth:10,handlerOpacity:.2,opacity:.5,color:"#787878"},hittable:!0};this._behavior=null,this.params=o({},u,a),this.timeContextBehavior=new b["default"],this._shapeConfiguration=null,this._commonShapeConfiguration=null,this._$datumToShape=new l,this._$shapeToDatum=new l,this._commonShape=null,this._renderingContext={},this.data=[],this._isContextEditable=!1,this._valueToPixel=d["default"].linear().domain(this.params.yDomain).range([this.params.height,0]),this.contentLayers=new h,this._dragLayer=new _["default"].Layer({}),this._commonShapeLayer=new _["default"].FastLayer({}),this._commonShapeLayer.addName("common-shape-layer"),this._commonShapeLayer.layer=this,this._contextLayer=new _["default"].Layer({}),this._contextLayer.layer=this,this._contextLayer.addName("context-layer"),
this.setContextEditable(this._isContextEditable),this._contextShape=new m["default"]({}),this._contextShape.install({opacity:function(){return 1},color:function(){return r.params.context.color},width:function(){return r.timeContext.duration},height:function(){return r._renderingContext.valueToPixel.domain()[1]},y:function(){return r._renderingContext.valueToPixel.domain()[0]},x:function(){return r.timeContext.start/r.timeContext.stretchRatio}}),this._contextShape.params.handlerWidth=this.params.context.handlerWidth,this._contextShape.render(this._renderingContext),this._contextShape.layer=this,this._contextShape.isContextShape=!0;for(var c=0;c<this._contextShape.$el.length;c++)this._contextLayer.add(this._contextShape.$el[c]);this._stage=null}return a(t,e),r(t,[{key:"createContainer",value:function(e){this._stage=e,this._stage.add(this._contextLayer),this._stage.add(this._commonShapeLayer),this._stage.add(this._dragLayer)}},{key:"_destroy",value:function(e){for(var t=e.next();!t.done;){var i=t.value;i.destroy()}}},{key:"destroy",value:function(){this._contextShape.destroy(),this._destroy(this._$datumToShape.values()),this._destroy(this.contentLayers.values),this.contentLayers.clear(),this._commonShapeLayer=null,this._contextLayer=null,this._contextShape=null,this._stage=null,this.params=null,this.timeContextBehavior=null,this._shapeConfiguration=null,this._commonShapeConfiguration=null,this._$datumToShape=null,this._$shapeToDatum=null,this._commonShape=null,this._renderingContext=null,this._isContextEditable=null,this._behavior=null}},{key:"setBehavior",value:function(e){e.initialize(this),this._behavior=e}},{key:"isSelected",value:function(e){return this._behavior._selectedDatums.has(e)}},{key:"select",value:function(e){var t=this;if((void 0===e||void 0===e.length&&void 0===e.size)&&(e=this.data),!this._behavior||!this._behavior.can("select",e))return!1;var i=this;return e.forEach(function(e){var n=i._$datumToShape.get(e);if(!n)throw new Error("No shape for this datum in this layer",{datum:e,layer:i});t._behavior.select(e),t._toFront(e),i.emit("select",e)}),!0}},{key:"unselect",value:function(e){var t=this;if((void 0===e||void 0===e.length&&void 0===e.size)&&(e=this.data),!this._behavior||!this._behavior.can("unselect",e))return!1;var i=this;return e.forEach(function(e){var n=i._$datumToShape.get(e);if(!n)throw new Error("No shape for this datum in this layer",{datum:e,layer:i});t._behavior.unselect(e),i.emit("unselect",e)}),!0}},{key:"_toFront",value:function(e){var t=this._$datumToShape.get(e);if(!t)throw new Error("No shape for this datum in this layer",{datum:e,layer:this});t.$el instanceof Array||t.$el instanceof h?t.$el.forEach(function(e){return e.moveToTop()}):t.$el.moveToTop()}},{key:"toDragLayer",value:function(e){var t=this,i=this;e.forEach(function(e){var n=t._$datumToShape.get(e);if(!n)throw new Error("No shape for this datum in this layer",{datum:e,layer:i});n.$el instanceof Array||n.$el instanceof h?n.$el.forEach(function(e){return i._dragLayer.add(e)}):t._dragLayer.add(n.$el)})}},{key:"toggleSelection",value:function(e){var t=this,i=this;e.forEach(function(e){var n=i._$datumToShape.get(e);if(!n)throw new Error("No shape for this datum in this layer",{datum:e,layer:i});t._behavior.toggleSelection(e),i.emit("toggle-select",e)})}},{key:"setTimeContext",value:function(e){this.timeContext=e,this._renderingContext={},this._updateRenderingContext()}},{key:"configureShape",value:function(e,t,i){t||(t={}),i||(i={}),this._shapeConfiguration={ctor:e,accessors:t,options:i}}},{key:"configureCommonShape",value:function(e,t,i){var n=this;t||(t={}),i||(i={}),this._commonShapeConfiguration={ctor:e,accessors:t,options:i},this._commonShape=new e(i),this._commonShape.install(t),this._commonShape.render(this._renderingContext),this._commonShape.$el instanceof Array||this._commonShape.$el instanceof h?this._commonShape.$el.forEach(function(e){return n._commonShapeLayer.add(e)}):this._commonShapeLayer.add(this._commonShape.$el)}},{key:"setContextEditable",value:function(e){void 0===e&&(e=!0),this._contextLayer.opacity(e?this.params.context.opacity:0),this._contextLayer.listening(e),this._contextLayer.visible(e),this._isContextEditable=e}},{key:"_updateRenderingContext",value:function(){this._renderingContext.timeToPixel=this.timeContext.timeToPixel,this._renderingContext.valueToPixel=this._valueToPixel,this._renderingContext.height=this.params.height,this._renderingContext.width=this.timeContext.timeToPixel(this.timeContext.duration),this._renderingContext.offsetX=this.timeContext.timeToPixel(this.timeContext.offset),this._renderingContext.startX=this.timeContext.parent.timeToPixel(this.timeContext.start),this._renderingContext.pixelsPerSecond=this.timeContext.parent.computedPixelsPerSecond,this._renderingContext.trackOffsetX=this.timeContext.parent.timeToPixel(this.timeContext.parent.offset),this._renderingContext.visibleWidth=this.timeContext.parent.visibleWidth}},{key:"getDatumFromShape",value:function(e){return this._$shapeToDatum.get(e)}},{key:"getShapeFromDatum",value:function(e){return this._$datumToShape.get(e)}},{key:"getDatumsInArea",value:function(e){var t=this,i=e.left,n=e.top,a=e.left+e.width,r=e.top+e.height+this.params.top,s=new h,o=(this._$datumToShape.entries(),this);return this.contentLayers.forEach(function(e){e.children.forEach(function(e){var l=e.shape;if(l){var h=o.getDatumFromShape(l),u=l.inArea(t._renderingContext,h,i,n,a,r);u&&s.add(h)}})}),s}},{key:"update",value:function(e){this.updateContainer(),this.updateShapes(e)}},{key:"sort_data",value:function(e){throw new Error("The developer must assign a proper function")}},{key:"visible_data",value:function(e,t){throw new Error("The developer must assign a proper function")}},{key:"updateShapes",value:function(e){var t=this,i=new h,n=null,a=null,r=!0;(void 0===e||this._commonShape)&&(a=this.visible_data(this.timeContext,this.data)),void 0===e?n=this.data.slice(a[0],Math.min(a[1]+1,this.data.length)):(n=e,r=!1),this.allocateShapesToContentLayers(this._stage,n,"datums",r).forEach(function(e){i.add(e)}),i.forEach(function(e){e.y(t.params.top).offsetX(-t._renderingContext.startX).x(t._renderingContext.offsetX).clip({x:-t._renderingContext.offsetX,y:0,width:t._renderingContext.width,height:t._renderingContext.height}),e.clear(),e.batchDraw()}),this._dragLayer.y(t.params.top).offsetX(-t._renderingContext.startX).x(t._renderingContext.offsetX).clip({x:-t._renderingContext.offsetX,y:0,width:t._renderingContext.width,height:t._renderingContext.height}).clear().batchDraw(),this._commonShape&&(this._commonShapeLayer.y(t.params.top).offsetX(-t._renderingContext.startX).x(t._renderingContext.offsetX).clip({x:-t._renderingContext.offsetX,y:0,width:t._renderingContext.width,height:t._renderingContext.height}),this._commonShape.update(this._renderingContext,t.data.slice(a[0],a[1]+1)),this._commonShapeLayer.batchDraw()),this._contextShape.update(this._renderingContext,this.timeContext),this._contextLayer.y(t.params.top).batchDraw()}},{key:"updateContainer",value:function(){var e=this;this._updateRenderingContext();this.contentLayers.forEach(function(t){t.offsetX(-e._renderingContext.startX).x(e._renderingContext.offsetX).clip({x:-e._renderingContext.offsetX,y:0,width:e._renderingContext.width,height:e._renderingContext.height})})}},{key:"allocateShapesToContentLayers",value:function(e,t,i,n){var a=30,r=new h,s=new h,o=this;if("datums"==i)t.forEach(function(e){var t=o.getShapeFromDatum(e);void 0===t&&(o._add(e),t=o.getShapeFromDatum(e)),t.update(o._renderingContext,e),t.$el instanceof Array||t.$el instanceof h?t.$el.forEach(function(e){return s.add(e)}):s.add(t.$el)});else{if("shapes"!=i)throw new Error("Unknown objects type");t.forEach(function(e){var t=o.getDatumFromShape(e);if(void 0===t)throw new Error("Unknown shape",{shape:e,layer:o});e.update(o._renderingContext,t),e.$el instanceof Array||e.$el instanceof h?e.$el.forEach(function(e){return s.add(e)}):s.add(e.$el)})}for(var l=s.entries(),u=this.contentLayers.entries(),c=u.next(),d=l.next(),f=null;!c.done;){for(var p=c.value[1];!d.done;){var v=d.value[1];if(p.children.length>=a&&v.shape!=f)break;n&&!r.has(p)&&p.removeChildren(),v.remove(),p.add(v),d=l.next(),r.add(p)}c=u.next()}for(;!d.done;){var p=new _["default"].Layer({});for(p.layer=this,p.addName("content-layer"),p.clearBeforeDraw(!0),this.contentLayers.add(p),e.add(p);!d.done&&p.children.length<a;){var v=d.value[1];v.remove(),p.add(v),d=l.next()}r.add(p)}return r}},{key:"set",value:function(e){if(!this._behavior||!this._behavior.can("add",e))return!1;var t=this;return this.unselect(),this.data.forEach(function(e){return t._$datumToShape.get(e).destroy()}),this._$datumToShape.clear(),this._$shapeToDatum.clear(),this.contentLayers.forEach(function(e){return e.destroy()}),this.data.length=0,e.forEach(function(e){t._add(e)}),this.data=e,this.sort_data(this.data),this.emit("set",e),!0}},{key:"_add",value:function(e){var t=this._shapeConfiguration.ctor,i=this._shapeConfiguration.accessors,n=this._shapeConfiguration.options,a=new t(n);a.install(i),a.render(this._renderingContext),a.layer=this,a.datum=e,this._$datumToShape.set(e,a),this._$shapeToDatum.set(a,e)}},{key:"add",value:function(e){return this._behavior&&this._behavior.can("add",[e])?(this._add(e),this.data[this.data.length]=e,this.sort_data(this.data),this.emit("add",e),!0):!1}},{key:"remove",value:function(e){var t=this;if(!this._behavior||!this._behavior.can("remove",[e]))return!1;this.unselect(e);var i=this._$datumToShape.get(e);return i&&!function(){var n=new h;i.$el instanceof Array||i.$el instanceof h?i.$el.forEach(function(e){return n.add(e)}):n.add(i.$el),i.layer=null,i.destroy(),t._$datumToShape["delete"](e),t._$shapeToDatum["delete"](i),n.forEach(function(e){0===e.children&&(e.destroy(),t.contentLayers["delete"](e))})}(),this.data.splice(this.data.indexOf(e),1),this.emit("remove",e),!0}},{key:"edit",value:function(e,t,i,n){var a=this;if(!this._behavior||!this._behavior.can("edit",e))return!1;var r=this;return e.forEach(function(e){var s=r._$datumToShape.get(e);a._behavior.edit(a._renderingContext,s,e,t,i,n)}),this.emit("edit",e),!0}},{key:"editContext",value:function(e,t,i){this.timeContextBehavior.edit(this,e,t,i),this.emit("edit-context")}},{key:"stretchContext",value:function(e,t,i){this.timeContextBehavior.stretch(this,e,t,i),this.emit("stretch-context")}},{key:"minimize",value:function(){}},{key:"visible",get:function(){return this._dragLayer.visible()},set:function(e){this._contextLayer.visible(e),this._commonShapeLayer.visible(e),this._dragLayer.visible(e),this.contentLayer.forEach(function(t){return t.visible(e)})}},{key:"zIndex",get:function(){return this._contextLayer.getZIndex()}},{key:"start",get:function(){return this.timeContext.start},set:function(e){this.timeContext.start=e}},{key:"offset",get:function(){return this.timeContext.offset},set:function(e){this.timeContext.offset=e}},{key:"duration",get:function(){return this.timeContext.duration},set:function(e){this.timeContext.duration=e}},{key:"stretchRatio",get:function(){return this.timeContext.stretchRatio},set:function(e){this.timeContext.stretchRatio=e}},{key:"yDomain",set:function(e){this.params.yDomain=e,this._valueToPixel.domain(e)},get:function(){return this.params.yDomain}},{key:"opacity",set:function(e){this.params.opacity=e},get:function(){return this.params.opacity}},{key:"timeToPixel",get:function(){return this.timeContext.timeToPixel}},{key:"valueToPixel",get:function(){return this._valueToPixel}},{key:"selectedDatums",get:function(){return this._behavior?this._behavior.selectedDatums:new h}}],[{key:"configureTimeContextBehavior",value:function(e){this.timeContextBehaviorCtor=e}}]),t}(p["default"].EventEmitter);i["default"]=x,t.exports=i["default"]},{"../behaviors/time-context-behavior":13,"../shapes/segment":47,"../utils/scales":66,"babel-runtime/core-js/map":69,"babel-runtime/core-js/object/assign":70,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,events:174,konva:172}],18:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],r=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var s=e("../utils/scales"),o=r(s),l=function(){function e(t,i){a(this,e),this._children=[],this._timeToPixel=null,this._offset=0,this._zoom=1,this._computedPixelsPerSecond=t,this._visibleWidth=i,this._maintainVisibleDuration=!1;var n=o["default"].linear().domain([0,1]).range([0,t]);this._timeToPixel=n,this._originalPixelsPerSecond=this._computedPixelsPerSecond}return n(e,[{key:"_updateTimeToPixelRange",value:function(){this.timeToPixel.range([0,this._computedPixelsPerSecond])}},{key:"pixelsPerSecond",get:function(){return this._originalPixelsPerSecond},set:function(e){this._computedPixelsPerSecond=e*this.zoom,this._originalPixelsPerSecond=e,this._updateTimeToPixelRange(),this._children.forEach(function(e){1!==e.stretchRatio&&(e.stretchRatio=e.stretchRatio)})}},{key:"computedPixelsPerSecond",get:function(){return this._computedPixelsPerSecond}},{key:"offset",get:function(){return this._offset},set:function(e){this._offset=e}},{key:"zoom",get:function(){return this._zoom},set:function(e){var t=e/this._zoom;this._zoom=e,this._computedPixelsPerSecond=this._originalPixelsPerSecond*e,this._updateTimeToPixelRange(),this._children.forEach(function(e){1!==e.stretchRatio&&(e.stretchRatio=e.stretchRatio*t)})}},{key:"visibleWidth",get:function(){return this._visibleWidth},set:function(e){var t=e/this.visibleWidth;this._visibleWidth=e,this.maintainVisibleDuration&&(this.pixelsPerSecond=this._computedPixelsPerSecond*t)}},{key:"visibleDuration",get:function(){return this.visibleWidth/this._computedPixelsPerSecond}},{key:"maintainVisibleDuration",get:function(){return this._maintainVisibleDuration},set:function(e){this._maintainVisibleDuration=e}},{key:"timeToPixel",get:function(){return this._timeToPixel}},{key:"visibleInterval",get:function(){var e={};return e.start=-this.offset,e.duration=this.visibleDuration,e},set:function(e){this.offset=-e.start,this.pixelsPerSecond=this.visibleWidth/e.duration}}]),e}();i["default"]=l,t.exports=i["default"]},{"../utils/scales":66,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/interop-require-default":84}],19:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/symbol/iterator")["default"],l=e("babel-runtime/regenerator")["default"],h=e("babel-runtime/core-js/get-iterator")["default"],u=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var c=e("events"),d=u(c),f=e("./track"),p=u(f),v=e("./track-collection"),m=u(v),g=e("./timeline-time-context"),b=u(g),y=e("./layer-time-context"),_=u(y),x=e("../interactions/konva-surface"),k=u(x),w=e("../interactions/keyboard"),S=u(w),C=function(e){function t(e,i,a){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),void 0===e&&(e=100),void 0===i&&(i=1e3),void 0===a?a={registerKeyboard:!0}:void 0===a.registerKeyboard&&(a.registerKeyboard=!0),this._tracks=new m["default"](this),this._state=null,this._surfaceCtor=k["default"],a.registerKeyboard&&this.createInteraction(S["default"],document),this._trackById={},this._groupedLayers={},this.timeContext=new b["default"](e,i)}return a(t,e),r(t,[{key:"configureSurface",value:function(e){this._surfaceCtor=e}},{key:"createInteraction",value:function(e,t,i){var n=this;void 0===i&&(i={});var a=new e(t,i);a.on("event",function(e){return n._handleEvent(e)})}},{key:"getHitLayers",value:function(e){var t=e.originalEvent.offsetX,i=e.originalEvent.offsetY,n=[];return this.layers.forEach(function(e){var a=e._contextShape.$segment.getAbsolutePosition().x,r=e._contextShape.$segment.getAbsolutePosition().y,s=e._contextShape.$segment.width(),o=e._contextShape.$segment.height();t>=a&&a+s>=t&&i>=r&&r+o>=i&&n.push(e)}),n}},{key:"_handleEvent",value:function(e){var t="surface"===e.source?this.getHitLayers(e):null;this.emit("event",e,t),this._state&&this._state.handleEvent(e,t)}},{key:"add",value:function(e,t){if(void 0===t&&(t=null),-1!==this.tracks.indexOf(e))throw new Error("track already added to the timeline");this._registerTrackId(e,t),e.configure(this.timeContext),this.tracks.push(e),this.createInteraction(this._surfaceCtor,e),this.emit("add",e,t)}},{key:"remove",value:function(e){var t;this.tracks.indexOf(e);-1!==this.tracks.indexOf(e)&&(e.destroy(),delete this._trackById[e.id],t=e.id,e.id=null),this.emit("remove",e,t)}},{key:"createTrack",value:function(e,t,i){void 0===t&&(t=100),void 0===i&&(i=null);var n=new p["default"](e,t);return this.add(n,i),n.update(),n}},{key:"_registerTrackId",value:function(e,t){if(null!==t){if(void 0!==this._trackById[t])throw new Error('trackId: "'+t+'" is already used');e.id=t,this._trackById[t]=e}}},{key:"addLayer",value:function(e,t,i,n){void 0===i&&(i="default"),void 0===n&&(n=!1);var a=t;if("string"==typeof t&&(a=this.getTrackById(t)),!e.timeContext){var r=n?this.timeContext:new _["default"](this.timeContext);e.setTimeContext(r)}a.add(e),this._groupedLayers[i]||(this._groupedLayers[i]=[]),this._groupedLayers[i].push(e),e.update()}},{key:"removeLayer",value:function(e){this.tracks.forEach(function(t){var i=t.layers.indexOf(e);-1!==i&&t.remove(e)});for(var t in this._groupedLayers){var i=this._groupedLayers[t],n=i.indexOf(e);-1!==n&&i.splice(e,1),i.length||delete this._groupedLayers[t]}}},{key:"getTrackById",value:function(e){return this._trackById[e]}},{key:"getTrackFromDOMElement",value:function(e){for(var t=0;t<this.tracks.length;t++)if(this.tracks[t].$stage.content===e)return this.tracks[t];return void 0}},{key:"getLayersByGroup",value:function(e){return this._groupedLayers[e]}},{key:o,value:l.mark(function i(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(h(this.tracks),"t0",1);case 1:case"end":return e.stop()}},i,this)})},{key:"offset",get:function(){return this.timeContext.offset},set:function(e){this.timeContext.offset=e}},{key:"zoom",get:function(){return this.timeContext.zoom},set:function(e){this.timeContext.zoom=e}},{key:"pixelsPerSecond",get:function(){return this.timeContext.pixelsPerSecond},set:function(e){this.timeContext.pixelsPerSecond=e}},{key:"visibleInterval",get:function(){return this.timeContext.visibleInterval},set:function(e){this.timeContext.visibleInterval=e}},{key:"visibleWidth",get:function(){return this.timeContext.visibleWidth},set:function(e){this.timeContext.visibleWidth=e}},{key:"timeToPixel",get:function(){return this.timeContext.timeToPixel}},{key:"visibleDuration",get:function(){return this.timeContext.visibleDuration}},{key:"maintainVisibleDuration",set:function(e){this.timeContext.maintainVisibleDuration=e},get:function(){return this.timeContext.maintainVisibleDuration}},{key:"groupedLayers",get:function(){return this._groupedLayers}},{key:"state",set:function(e){this._state&&this._state.exit(),this._state=e,this._state&&this._state.enter()},get:function(){return this._state}},{key:"tracks",get:function(){return this._tracks}},{key:"layers",get:function(){return this._tracks.layers}}]),t}(d["default"].EventEmitter);i["default"]=C,t.exports=i["default"]},{"../interactions/keyboard":36,"../interactions/konva-surface":37,"./layer-time-context":16,"./timeline-time-context":18,"./track":21,"./track-collection":20,"babel-runtime/core-js/get-iterator":68,"babel-runtime/core-js/symbol/iterator":79,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,"babel-runtime/regenerator":170,events:174}],20:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/set")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("./layer"),u=l(h),c=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._timeline=e}return a(t,e),r(t,[{key:"_getLayersOrGroups",value:function(e){void 0===e&&(e=null);var t=null;return t="string"==typeof e?this._timeline.groupedLayers[e]:e instanceof u["default"]?[e]:this.layers}},{key:"render",value:function(){this.forEach(function(e){return e.render()}),this._timeline.emit("render")}},{key:"update",value:function(e){var t=this._getLayersOrGroups(e);this.forEach(function(e){return e.update(t)}),this._timeline.emit("update",t)}},{key:"updateContainer",value:function(){this.forEach(function(e){return e.updateContainer()}),this._timeline.emit("update:containers")}},{key:"updateLayers",value:function(e){var t=this._getLayersOrGroups(e);this.forEach(function(e){return e.updateLayers(t)}),this._timeline.emit("update:layers",t)}},{key:"height",set:function(e){this.forEach(function(t){return t.height=e})},get:function(){throw new Error("Not implemented")}},{key:"layers",get:function(){var e=new o;return this.forEach(function(t){return t.layers.forEach(function(t){return e.add(t)})}),e}}]),t}(Array);i["default"]=c,t.exports=i["default"]},{"./layer":17,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],21:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/set")["default"],l=e("babel-runtime/core-js/get-iterator")["default"],h=e("babel-runtime/core-js/symbol/iterator")["default"],u=e("babel-runtime/regenerator")["default"],c=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var d=e("events"),f=c(d),p=e("konva"),v=c(p),m=function(e){function t(e,i){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),i||(i=100),this._height=i,this.$el=e,this.$stage=null,this.$dragLayer=null,this.$interactionsLayer=null,this.$backgroundLayer=null,this.layers=new o,this.renderingContext=null,this._createContainer()}return a(t,e),r(t,[{key:"configure",value:function(e){this.renderingContext=e}},{key:"destroy",value:function(){this.layers.forEach(function(e){return e.destroy()}),this.layers.clear(),this.$stage.destroy(),this.$interactionsLayer.destroy(),this.$backgroundLayer.destroy(),this._height=null,this.$el=null,this.$stage=null,this.$interactionsLayer=null,this.$backgroundLayer=null,this.renderingContext=null}},{key:"_createContainer",value:function(){this.$stage=new v["default"].Stage({height:this.height,container:this.$el}),this.$stage.addName("track-stage"),this.$interactionsLayer=new v["default"].Layer({}),this.$interactionsLayer.addName("track-interactions"),this.$backgroundLayer=new v["default"].Layer({}),this.$backgroundLayer.addName("track-background"),this.$backgroundLayer.add(new v["default"].Rect({})),this.$dragLayer=new v["default"].Layer({}),this.$dragLayer.addName("track-drag-layer"),this.$stage.add(this.$dragLayer),this.$stage.add(this.$interactionsLayer),this.$stage.add(this.$backgroundLayer)}},{key:"add",value:function(e){this.layers.has(e)||(e.createContainer(this.$stage),this.layers.add(e),this.moveToTop(e),this.emit("add",e))}},{key:"remove",value:function(e){if(!this.layers.has(e))throw new Error("Layer not found");this.layers["delete"](e),e.destroy(),this.emit("remove",e)}},{key:"hasElement",value:function(e){throw new Error("deprecated")}},{key:"hasLayer",value:function(e){return this.layers.has(e)}},{key:"render",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,a=l(this);!(e=(n=a.next()).done);e=!0){var r=n.value;r.render()}}catch(s){t=!0,i=s}finally{try{!e&&a["return"]&&a["return"]()}finally{if(t)throw i}}}},{key:"update",value:function(e){void 0===e&&(e=null),this.updateContainer(),this.updateLayers(e)}},{key:"updateContainer",value:function(){var e=this.renderingContext,t=(this.height,Math.round(e.visibleWidth)),i=-Math.round(e.timeToPixel(e.offset));this.$stage.width(t).height(this.height).offsetX(i),this.$interactionsLayer.offsetX(-i),this.$backgroundLayer.offsetX(-i),this.$backgroundLayer.children[0].x(0).y(0).width(t).height(this.height).opacity(0).moveToBottom(),this.$backgroundLayer.batchDraw()}},{key:"updateLayers",value:function(e){var t=this;void 0===e&&(e=null),e=null===e?this.layers:e,e instanceof o||e instanceof Array||(e=[e]),e.forEach(function(e){t.layers.has(e)&&e.update()}),this.$backgroundLayer.moveToBottom()}},{key:"minimize",value:function(){}},{key:"maximize",value:function(){}},{key:"moveToTop",value:function(e){e._contextLayer.moveToTop(),e._commonShapeLayer.moveToTop(),e.contentLayers.forEach(function(e){return e.moveToTop()}),this.$interactionsLayer.moveToTop(),this.$backgroundLayer.moveToBottom()}},{key:"moveToBottom",value:function(e){this.$interactionsLayer.moveToTop(),e.contentLayers.forEach(function(e){return e.moveToBottom()}),e._commonShapeLayer.moveToBottom(),e._contextLayer.moveToBottom(),this.$backgroundLayer.moveToBottom()}},{key:h,value:u.mark(function i(){return u.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(l(this.layers),"t0",1);case 1:case"end":return e.stop()}},i,this)})},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}]),t}(f["default"].EventEmitter);i["default"]=m,t.exports=i["default"]},{"babel-runtime/core-js/get-iterator":68,"babel-runtime/core-js/set":77,"babel-runtime/core-js/symbol/iterator":79,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,"babel-runtime/regenerator":170,events:174,konva:172}],22:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var o=e("../shapes/annotated-marker"),l=s(o),h=e("../core/layer"),u=s(h),c=e("../behaviors/marker-behavior"),d=s(c),f=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),this.configureShape(l["default"]),this.setBehavior(new d["default"])}return a(t,e),t}(u["default"]);i["default"]=f,t.exports=i["default"]},{"../behaviors/marker-behavior":7,"../core/layer":17,"../shapes/annotated-marker":40,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],23:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/annotated-segment"),c=o(u),d=e("../behaviors/segment-behavior"),f=o(d),p=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),i=s({displayHandlers:!0,opacity:.6},i),this.configureShape(c["default"],a,{displayHandlers:i.displayHandlers,opacity:i.opacity}),this.setBehavior(new f["default"])}return a(t,e),t}(h["default"]);i["default"]=p,t.exports=i["default"]},{"../behaviors/segment-behavior":10,"../core/layer":17,"../shapes/annotated-segment":41,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],24:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/marker"),c=o(u),d=e("../behaviors/marker-behavior"),f=o(d),p=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data,i=s({displayHandlers:!0},i);var o=i.color;o&&(a.color=function(){return o}),this.configureShape(c["default"],a,{displayHandlers:i.displayHandlers}),this.setBehavior(new f["default"])}return a(t,e),t}(h["default"]);i["default"]=p,t.exports=i["default"]},{"../behaviors/marker-behavior":7,"../core/layer":17,"../shapes/marker":46,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],25:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var o=e("../behaviors/breakpoint-behavior"),l=s(o),h=e("../shapes/dot"),u=s(h),c=e("../core/layer"),d=s(c),f=e("../shapes/line"),p=s(f),v=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data;var s=i.color,o={};s&&(a.color=function(){return s},o.color=s),this.configureCommonShape(p["default"],a,o),this.configureShape(u["default"],a,{}),this.setBehavior(new l["default"])}return a(t,e),t}(d["default"]);i["default"]=v,t.exports=i["default"]},{"../behaviors/breakpoint-behavior":6,"../core/layer":17,"../shapes/dot":44,"../shapes/line":45,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],26:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/object/assign")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("../core/layer"),u=l(h),c=e("../shapes/cursor"),d=l(c),f=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];s(this,t);var i={color:"red",hittable:!1},a={currentPosition:0
};e=o(i,e),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"entity",a,e),this.configureShape(d["default"],{x:function(e){return e.currentPosition}},{color:e.color}),this.data[0]=a}return a(t,e),r(t,[{key:"currentPosition",set:function(e){this.data[0].currentPosition=e},get:function(){return this.data[0].currentPosition}}]),t}(u["default"]);i["default"]=f,t.exports=i["default"]},{"../core/layer":17,"../shapes/cursor":43,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],27:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../axis/axis-layer"),h=o(l),u=e("../shapes/ticks"),c=o(u),d=e("../axis/grid-axis-generator"),f=o(d),p=function(e){function t(e){r(this,t),e=s({color:"steelblue",bpm:60,signature:"4/4"},e),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,(0,f["default"])(e.bpm,e.signature),e),this.configureShape(c["default"],{},{color:e.color})}return a(t,e),t}(h["default"]);i["default"]=p,t.exports=i["default"]},{"../axis/axis-layer":1,"../axis/grid-axis-generator":2,"../shapes/ticks":48,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],28:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/marker"),c=o(u),d=e("../behaviors/marker-behavior"),f=o(d),p=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data,i=s({displayHandlers:!0},i);var o=i.color;o&&(a.color=function(){return o}),this.configureShape(c["default"],a,{displayHandlers:i.displayHandlers}),this.setBehavior(new f["default"])}return a(t,e),t}(h["default"]);i["default"]=p,t.exports=i["default"]},{"../behaviors/marker-behavior":7,"../core/layer":17,"../shapes/marker":46,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],29:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],r=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var s=e("../core/timeline"),o=r(s),l=e("../core/track"),h=r(l),u=e("../core/layer"),c=r(u),d=e("../core/layer-time-context"),f=r(d),p=e("../behaviors/scroll-segment-behavior"),v=r(p),m=e("../shapes/segment"),g=r(m),b=e("../states/simple-edition-state"),y=r(b),_=function(){function e(t,i,n,r,s){a(this,e),this.auxTimeline=new o["default"](n,r);var l=document.createElement("div");l.classList.add("scroll-div"),t.appendChild(l),this.auxTrack=new h["default"](l,20,r),this.auxScrollLayer=new c["default"]("collection",[],{height:s,yDomain:[0,1]}),this.auxScrollLayer.setBehavior(new v["default"](i)),this.auxScrollLayer.setTimeContext(new f["default"](this.auxTimeline.timeContext)),this.auxScrollLayer.configureShape(g["default"],{}),this.auxScrollLayer.timeContext.lockedToParentInterval=!0,this.auxScrollLayer.sort_data=function(e){},this.auxScrollLayer.visible_data=function(e,t){return[0,t.length-1]},this.auxScrollLayer.timeContext.lockedToParentInterval=!0,this.scrollDatum={x:i.visibleInterval.start,duration:i.visibleInterval.duration},this.auxScrollLayer.add(this.scrollDatum),console.log(i.visibleInterval),console.log(this.scrollDatum),this.auxTimeline.visibleInterval=i.visibleInterval,this.auxTrack.add(this.auxScrollLayer),this.auxTimeline.add(this.auxTrack),this.auxTimeline.tracks.update(),this.auxScrollLayer.edit([this.scrollDatum],0,0,this.auxScrollLayer.getShapeFromDatum(this.scrollDatum).$segment),this.auxTimeline.state=new y["default"](this.auxTimeline);var u=this;this.auxTimeline.on("event",function(e){if("click"==e.type&&e.target&&!e.target.shape){var t=(-u.auxTimeline.timeContext.offset,u.auxTimeline.timeContext.timeToPixel.invert(e.x),e.x-u.auxTimeline.timeContext.timeToPixel(u.scrollDatum.x)),i=u.auxScrollLayer.getShapeFromDatum(u.scrollDatum);u.auxScrollLayer.edit([u.scrollDatum],t,0,i.$segment),u.auxTimeline.tracks.update()}})}return n(e,[{key:"availableScrollRange",set:function(e){this.auxTimeline.visibleInterval=e,this.auxTimeline.tracks.update()},get:function(){return this.auxTimeline.visibleInterval}},{key:"visibleRange",set:function(e){var t=this.auxTimeline.timeContext.timeToPixel(e.start),i=this.auxTimeline.timeContext.timeToPixel(this.scrollDatum.x),n=t-i;this.scrollDatum.width=e.duration;var a=this.auxScrollLayer.getShapeFromDatum(this.scrollDatum);this.auxScrollLayer.edit([this.scrollDatum],n,0,a.$segment),this.auxTimeline.tracks.update()},get:function(){return{start:this.scrollDatum.x,duration:this.scrollDatum.width}}},{key:"color",set:function(e){this.auxScrollLayer.getShapeFromDatum(this.scrollDatum).params.color=e,this.auxTimeline.tracks.update()},get:function(){return this.auxScrollLayer.getShapeFromDatum(this.scrollDatum).params.color}}]),e}();i["default"]=_,t.exports=i["default"]},{"../behaviors/scroll-segment-behavior":9,"../core/layer":17,"../core/layer-time-context":16,"../core/timeline":19,"../core/track":21,"../shapes/segment":47,"../states/simple-edition-state":63,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/interop-require-default":84}],30:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/segment"),c=o(u),d=e("../behaviors/segment-behavior"),f=o(d),p=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data,i=s({displayHandlers:!0,opacity:.6},i),this.configureShape(c["default"],a,{displayHandlers:i.displayHandlers,opacity:i.opacity}),this.setBehavior(new f["default"])}return a(t,e),t}(h["default"]);i["default"]=p,t.exports=i["default"]},{"../behaviors/segment-behavior":10,"../core/layer":17,"../shapes/segment":47,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],31:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/ticks"),c=o(u),d=function(e){function t(e,i,a){r(this,t),i=s({},i),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"entity",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data;var o=i.color?{color:i.color}:void 0;this.configureShape(c["default"],a,o)}return a(t,e),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"../core/layer":17,"../shapes/ticks":48,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],32:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../axis/axis-layer"),h=o(l),u=e("../shapes/ticks"),c=o(u),d=e("../axis/time-axis-generator"),f=o(d),p=function(e){function t(e){r(this,t),e=s({color:"steelblue"},e),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,(0,f["default"])(),e),this.sort_data=e.sort_data,this.visible_data=e.visible_data,this.configureShape(c["default"],{},{color:e.color})}return a(t,e),t}(h["default"]);i["default"]=p,t.exports=i["default"]},{"../axis/axis-layer":1,"../axis/time-axis-generator":3,"../shapes/ticks":48,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],33:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/trace-path"),c=o(u),d=e("../shapes/trace-dots"),f=o(d),p=e("../behaviors/trace-behavior"),v=o(p),m=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];r(this,t),i=s({displayDots:!0},i),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,i.displayDots?"collection":"entity",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data;var o={};void 0!==i.meanColor&&(o.meanColor=i.meanColor),void 0!==i.rangeColor&&(o.rangeColor=i.rangeColor),void 0!==i.displayMean&&(o.displayMean=i.displayMean),i.displayDots?(this.configureCommonShape(c["default"],a,o),this.configureShape(f["default"],a,o)):this.configureShape(c["default"],a,o),this.setBehavior(new v["default"])}return a(t,e),t}(h["default"]);i["default"]=m,t.exports=i["default"]},{"../behaviors/trace-behavior":14,"../core/layer":17,"../shapes/trace-dots":49,"../shapes/trace-path":50,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],34:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("../core/layer"),h=o(l),u=e("../shapes/waveform"),c=o(u),d={yDomain:[-1,1],channel:0,color:"steelblue",renderingStrategy:"svg"},f=function(e){function t(e,i){r(this,t),i=s({},d,i),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"collection",e,i),this.sort_data=i.sort_data,this.visible_data=i.visible_data,this.configureShape(c["default"],{},{sampleRate:buffer.sampleRate,color:i.color,renderingStrategy:i.renderingStrategy})}return a(t,e),t}(h["default"]);i["default"]=f,t.exports=i["default"]},{"../core/layer":17,"../shapes/waveform":51,"babel-runtime/core-js/object/assign":70,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],35:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("events"),h=o(l),u=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.$el=e,this._bindEvents()}return a(t,e),r(t,[{key:"_createEvent",value:function(e,t){}},{key:"_bindEvents",value:function(){}}]),t}(h["default"].EventEmitter);i["default"]=u,t.exports=i["default"]},{"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,events:174}],36:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./event-source"),h=o(l),u=e("./wave-event"),c=o(u),d=function(e){function t(e){return s(this,t),t._instance?t._instance:(n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.sourceName="keyboard",void(t._instance=this))}return a(t,e),r(t,[{key:"_createEvent",value:function(e,t){var i=new c["default"](this.sourceName,e,t);return i.shiftKey=t.shiftKey,i.ctrlKey=t.ctrlKey,i.altKey=t.altKey,i.metaKey=t.metaKey,i["char"]=String.fromCharCode(t.keyCode),i}},{key:"_bindEvents",value:function(){var e=this,t=function(t){var i=e._createEvent("keydown",t);e.emit("event",i)},i=function(t){var i=e._createEvent("keyup",t);e.emit("event",i)};this.$el.addEventListener("keydown",t,!1),this.$el.addEventListener("keyup",i,!1)}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./event-source":35,"./wave-event":39,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],37:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./event-source"),h=o(l),u=e("./konva-wave-event"),c=o(u),d=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.sourceName="surface",this._mouseDownEvent=null,this._lastEvent=null}return a(t,e),r(t,[{key:"_createEvent",value:function(e,t){var i=new c["default"](this.sourceName,e,t),n=this._getRelativePosition(t);return i.x=n.x,i.y=n.y,i}},{key:"_getRelativePosition",value:function(e){if(e instanceof MouseEvent){var t=e.offsetX,i=e.offsetY;return{x:t,y:i}}var t=e.evt.offsetX,i=e.evt.offsetY;return{x:t,y:i}}},{key:"_defineArea",value:function(e,t,i){if(t&&i){e.dx=e.x-i.x,e.dy=e.y-i.y;var n=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,r=Math.abs(Math.round(e.x-t.x)),s=Math.abs(Math.round(e.y-t.y));e.area={left:n,top:a,width:r,height:s}}}},{key:"_bindEvents",value:function(){var e=this,t=function(t){var i=e._createEvent("mousemove",t);e._defineArea(i,e._mouseDownEvent,e._lastEvent),e._lastEvent=i,e.emit("event",i)},i=function d(i){if("mousemove"==e._lastEvent.type){var n=e._createEvent("mouseup",i);e._defineArea(n,e._mouseDownEvent,e._lastEvent),e._mouseDownEvent=null,e._lastEvent=null,window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",d),e.emit("event",n)}else if("mousedown"==e._lastEvent.type){var a=e._createEvent("mouseup",i),r=e._createEvent("click",i);r.target=e._mouseDownEvent.target,e._mouseDownEvent=null,e._lastEvent=null,window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",d),e.emit("event",a),e.emit("event",r)}},n=function(n){window.getSelection().removeAllRanges();var a=e._createEvent("mousedown",n);e._mouseDownEvent=a,e._lastEvent=a,window.addEventListener("mousemove",t,!1),window.addEventListener("mouseup",i,!1),a.cancelBubble=!0,e.emit("event",a)},a=function(t){var i=e._createEvent("dblclick",t);e.emit("event",i)},r=function(t){var i=e._createEvent("mouseover",t);e.emit("event",i)},s=function(t){var i=e._createEvent("mouseout",t);e.emit("event",i)},o=function(t){var i=e._createEvent("dragstart",t);e.emit("event",i)},l=function(t){var i=e._createEvent("dragover",t);e.emit("event",i)},h=function(t){var i=e._createEvent("drop",t);e.emit("event",i)},u=function(t){var i=e._createEvent("dragleave",t);e.emit("event",i)},c=function(t){var i=e._createEvent("dragenter",t);e.emit("event",i)};this.$el.$stage.on("mousedown",n),this.$el.$stage.on("dblclick",a),this.$el.$stage.on("mouseover",r),this.$el.$stage.on("mouseout",s),this.$el.$stage.on("mouseover",r),this.$el.$stage.content.addEventListener("dragstart",o),this.$el.$stage.content.addEventListener("dragenter",c),this.$el.$stage.content.addEventListener("drop",h),this.$el.$stage.content.addEventListener("dragover",l),this.$el.$stage.content.addEventListener("dragleave",u)}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./event-source":35,"./konva-wave-event":38,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],38:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/class-call-check")["default"],s=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var o=e("./wave-event"),l=s(o),h=function(e){function t(e,i,a){r(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,i,a),a instanceof MouseEvent||(this.originalEvent=a.evt,this.currentTarget=a.evt.currentTarget)}return a(t,e),t}(l["default"]);i["default"]=h,t.exports=i["default"]},{"./wave-event":39,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],39:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(i,"__esModule",{value:!0});var a=function r(e,t,i){n(this,r),this.source=e,this.type=t,this.originalEvent=i,this.target=i.target,this.currentTarget=i.currentTarget};i["default"]=a,t.exports=i["default"]},{"babel-runtime/helpers/class-call-check":80}],40:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./marker"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$label.destroy(),this.$label=null,n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"annotated-segment"}},{key:"_getAccessorList",value:function(){var e=n(Object.getPrototypeOf(t.prototype),"_getAccessorList",this).call(this);return e.text="default",e}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=n(Object.getPrototypeOf(t.prototype),"render",this).call(this,e),this.$label=new c["default"].Text({listening:!1}),this.$label.addName("text"),this.$el.push(this.$label),this.$el)}},{key:"update",value:function(e,i){var a=i||this.datum;n(Object.getPrototypeOf(t.prototype),"update",this).call(this,e,a);var r=(e.timeToPixel(this.width(a)),Math.abs(e.valueToPixel(this.y(a)+this.height(a))-e.valueToPixel(this.y(a))),e.timeToPixel(this.x(a))),s=e.valueToPixel(this.y(a)+this.height(a)),o=this.text(a);this.$label.x(r+3).y(s+11),this.$label.height(s),this.$label.fill("#242424"),this.$label.fontSize(10),this.$label.fontFamily("monospace"),this.$label.text(o)}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./marker":46,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],41:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./segment"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$label.destroy(),this.$label=null,n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"annotated-segment"}},{key:"_getAccessorList",value:function(){var e=n(Object.getPrototypeOf(t.prototype),"_getAccessorList",this).call(this);return e.text="default",e}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=n(Object.getPrototypeOf(t.prototype),"render",this).call(this,e),this.$label=new c["default"].Text({listening:!1}),this.$label.addName("text"),this.$el.push(this.$label),this.$el)}},{key:"update",value:function(e,i){var a=i||this.datum;n(Object.getPrototypeOf(t.prototype),"update",this).call(this,e,a);var r=(e.timeToPixel(this.width(a)),Math.abs(e.valueToPixel(this.y(a)+this.height(a))-e.valueToPixel(this.y(a))),e.timeToPixel(this.x(a))),s=e.valueToPixel(this.y(a)+this.height(a)),o=this.text(a);this.$label.x(r+3).y(s+11),this.$label.height(s),this.$label.fill("#242424"),this.$label.fontSize(10),this.$label.fontFamily("monospace"),this.$label.text(o)}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./segment":47,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],42:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],r=e("babel-runtime/core-js/object/assign")["default"],s=e("babel-runtime/core-js/object/keys")["default"],o=e("babel-runtime/core-js/object/define-property")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("./segment"),u=(l(h),e("konva")),c=(l(u),function(){function e(t){a(this,e),void 0===t&&(t={}),this.$el=null,this.params=r({},this._getDefaults(),t),this.layer=null,this._visible=!0,this._highlight=!1,this._datum=null;var i=this._getAccessorList();this._createAccessors(i),this._setDefaultAccessors(i)}return n(e,[{key:"destroy",value:function(){if(this.$el instanceof Array){for(var e=0;e<this.$el.length;e++)this.$el[e].shape=null;this.$el.length=0}else this.$el&&(this.$el.shape=null);this.$el=null,this.$params=null,this._accessors=null,this._datum=null}},{key:"getClassName",value:function(){return"shape"}},{key:"_getDefaults",value:function(){return{}}},{key:"_getAccessorList",value:function(){return{}}},{key:"install",value:function(e){for(var t in e)this[t]=e[t]}},{key:"_createAccessors",value:function(e){this._accessors={};var t=Object.getPrototypeOf(this);s(e).forEach(function(e){t.hasOwnProperty(e)||o(t,e,{get:function(){return this._accessors[e]},set:function(t){this._accessors[e]=t}})})}},{key:"_setDefaultAccessors",value:function(e){var t=this;s(e).forEach(function(i){var n=e[i],a=function(e,t){return void 0===t&&(t=null),null===t?e[i]||n:void(e[i]=t)};t[i]=a})}},{key:"render",value:function(e){}},{key:"update",value:function(e,t){}},{key:"draw",value:function(){if(this.$el instanceof Array)for(var e=0;e<this.$el.length;e++)this.$el[e].draw();else this.$el.draw()}},{key:"inArea",value:function(e,t,i,n,a,r){}},{key:"minimize",value:function(){}},{key:"maximize",value:function(){}},{key:"startDrag",value:function(){this.$el instanceof Array?this.$el.forEach(function(e){return e.startDrag()}):this.$el.startDrag()}},{key:"stopDrag",value:function(){this.$el instanceof Array?this.$el.forEach(function(e){return e.stopDrag()}):this.$el.stopDrag()}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e}},{key:"datum",get:function(){return this._datum},set:function(e){this._datum=e}}]),e}());i["default"]=c,t.exports=i["default"]},{"./segment":47,"babel-runtime/core-js/object/assign":70,"babel-runtime/core-js/object/define-property":72,"babel-runtime/core-js/object/keys":74,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/interop-require-default":84,konva:172}],43:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"getClassName",value:function(){return"cursor"}},{key:"_getAccessorList",value:function(){return{x:0}}},{key:"_getDefaults",value:function(){return{color:"#000000",opacity:1,width:2}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=new c["default"].Rect({}),this.$el)}},{key:"update",value:function(e,t){var i=e.timeToPixel(this.x(t));this.$el.x(i).y(0).width(this.params.width).height(e.height).fill(this.params.color).opacity(this.params.opacity)}},{key:"inArea",value:function(){return!1}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],44:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$el.destroy(),n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"dot"}},{key:"_getAccessorList",value:function(){return{x:0,y:0}}},{key:"_getDefaults",value:function(){return{color:"black",r:3}}},{key:"render",value:function(){return this.$el?this.$el:(this.$el=new c["default"].Circle({}),this.$el.shape=this,this.$el.perfectDrawEnabled(!1),this.$el)}},{key:"update",value:function(e,t){var i=t||this.datum,n=e.timeToPixel(this.x(i)),a=e.valueToPixel(this.y(i)),r=this.params.r,s=this.params.color;this.$el.x(n),this.$el.y(a),this.$el.radius(r),this.$el.fill(s)}},{key:"inArea",value:function(e,t,i,n,a,r){var s=this.$el.getAbsolutePosition().x,o=this.$el.getAbsolutePosition().y;return s>=i&&a>=s&&o>=n&&r>=o?!0:!1}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],45:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$el.destroy(),n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"line"}},{key:"_getAccessorList",value:function(){return{x:0,y:0}}},{key:"_getDefaults",value:function(){return{color:"#000000",strokeWidth:1}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=new c["default"].Path({}),this.$el.perfectDrawEnabled(!1),this.$el)}},{key:"update",value:function(e,t){var i=this;t=t.slice(0),t.sort(function(e,t){return i.x(e)<i.x(t)?-1:1}),this.$el.data(this._buildLine(e,t)),this.$el.stroke(this.params.color),this.$el.strokeWidth(this.params.strokeWidth),t=null}},{key:"_buildLine",value:function(e,t){var i=this;if(!t.length)return"";var n=t.map(function(t,n){var a=e.timeToPixel(i.x(t)),r=e.valueToPixel(i.y(t))-.5;return a+","+r});return"M"+n.join("L")}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],46:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$line.destroy(),this.$line=null,this.$handler.destroy(),this.$handler=null,n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"marker"}},{key:"_getAccessorList",value:function(){return{x:0}}},{key:"_getDefaults",value:function(){return{handlerWidth:7,handlerHeight:10,displayHandlers:!0,opacity:1,strokeWidth:2,color:"black",handlerColor:"black"}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=[],this.$line=new c["default"].Rect({}),this.$line.addName("marker"),this.$line.shape=this,this.$handler=new c["default"].Rect({}),this.$handler.addName("handler"),this.$handler.shape=this,this.$el.push(this.$line),this.$el.push(this.$handler),this.$el)}},{key:"update",value:function(e,t){var i=t||this.datum;if(this.$line.visible(this.visible),this.$handler.visible(this.visible&&this.params.displayHandlers),
this.visible){var n=e.timeToPixel(this.x(i))-.5,a=e.height;this.$line.x(n).y(0).width(this.params.strokeWidth),this.$line.height(a),this.$line.fill(this.params.color),this.$handler.x(n).y(0).width(this.params.handlerWidth).height(this.params.handlerHeight).fill(this.params.handlerColor)}}},{key:"inArea",value:function(e,t,i,n,a,r){var s=t||this.datum,o=e.timeToPixel(this.x(s)),l=o-(this.params.handlerWidth-1)/2,h=l+this.params.handlerWidth,u=e.height-this.params.handlerHeight,c=e.height,d=Math.max(0,Math.min(a,h)-Math.max(i,l)),f=Math.max(0,Math.min(r,c)-Math.max(n,u)),p=d*f;return p>0}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],47:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$segment.destroy(),this.$segment=null,this.$leftHandler.destroy(),this.$leftHandler=null,this.$rightHandler.destroy(),this.$rightHandler=null,n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"segment"}},{key:"_getAccessorList",value:function(){return{x:0,y:0,width:1,height:1}}},{key:"_getDefaults",value:function(){return{displayHandlers:!0,handlerWidth:2,handlerOpacity:.8,opacity:.6,handlerColor:"#000000",color:"#000000"}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=[],this.$segment=new c["default"].Rect({}),this.$segment.name("segment"),this.$segment.shape=this,this.$el.push(this.$segment),this.$leftHandler=new c["default"].Rect({}),this.$leftHandler.addName("left"),this.$leftHandler.addName("handler"),this.$leftHandler.shape=this,this.$rightHandler=new c["default"].Rect({}),this.$rightHandler.addName("right"),this.$rightHandler.addName("handler"),this.$rightHandler.shape=this,this.$segment.perfectDrawEnabled(!1),this.$leftHandler.perfectDrawEnabled(!1),this.$rightHandler.perfectDrawEnabled(!1),this.$el.push(this.$leftHandler),this.$el.push(this.$rightHandler),this.$el)}},{key:"update",value:function(e,t){var i=t||this.datum;if(this.$segment.visible(this.visible),this.$leftHandler.visible(this.visible&&this.params.displayHandlers),this.$rightHandler.visible(this.visible&&this.params.displayHandlers),this.visible){var n=e.timeToPixel(this.width(i)),a=Math.abs(e.valueToPixel(this.y(i)+this.height(i))-e.valueToPixel(this.y(i))),r=e.timeToPixel(this.x(i)),s=e.valueToPixel(this.y(i)+this.height(i));this.$segment.x(r).y(s).width(Math.max(n,0)).height(a).fill(this.params.color).opacity(this.params.opacity),this.$leftHandler.x(r).y(s).width(this.params.handlerWidth).height(a).fill(this.params.handlerColor).opacity(this.params.handlerOpacity),this.$rightHandler.x(r+n-this.params.handlerWidth).y(s).height(a).width(this.params.handlerWidth).fill(this.params.handlerColor).opacity(this.params.handlerOpacity)}}},{key:"inArea",value:function(e,t,i,n,a,r){var s=(t||this.datum,this.$segment.getAbsolutePosition().x),o=this.$segment.getAbsolutePosition().y,l=s+this.$segment.width(),h=o+this.$segment.height(),u=Math.max(0,Math.min(a,l)-Math.max(i,s)),c=Math.max(0,Math.min(r,h)-Math.max(n,o)),d=u*c;return d>0}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],48:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/set")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("./base-shape"),u=l(h),c=e("konva"),d=l(c),f=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"_getClassName",value:function(){return"tick"}},{key:"_getAccessorList",value:function(){return{time:0,label:"",focused:!1}}},{key:"_getDefaults",value:function(){return{"default":{color:"steelblue",opacity:.3,width:1},focused:{color:"black",opacity:.8,width:2}}}},{key:"render",value:function(e){return this.$el=new o,this.$currentTicks=new o,this.$currentLabels=new o,this.$el}},{key:"update",value:function(e,t){var i=this;if(this.$el.size<2*t.length)for(;this.$el.size<2*t.length;){var n=new d["default"].Rect({listening:!1});n.addName("tick");var a=new d["default"].Text({listening:!1});a.addName("label"),this.$currentTicks.add(n),this.$currentLabels.add(a),this.$el.add(n),this.$el.add(a)}else if(this.$el.size>2*t.length)for(var r=this.$currentTicks.values(),s=this.$currentLabels.values();this.$el.size>2*t.length;){var o=r.next().value,l=s.next().value;this.$currentTicks["delete"](o),this.$currentLabels["delete"](l),this.$el["delete"](o),this.$el["delete"](l),o.destroy(),l.destroy()}var h=this,u=e.height,c=this.$currentTicks.values(),f=this.$currentLabels.values();t.forEach(function(t){var n=f.next().value,a=c.next().value,r=e.timeToPixel(i.time(t)),s=u,o=h.focused(t),l=h.label(t);a.x(r).height(s),o?a.width(h.params.focused.width).fill(h.params.focused.color).opacity(h.params.focused.opacity):a.width(h.params["default"].width).fill(h.params["default"].color).opacity(h.params["default"].opacity),n.x(r+5).y(5).text(h.label(t)).fontFamily("monospace").lineHeight("10px").fontSize("10px").fill("#676767").opacity(.9),l?n.visible(!0):n.visible(!1)})}}]),t}(u["default"]);i["default"]=f,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],49:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"getClassName",value:function(){return"trace-dots"}},{key:"_getAccessorList",value:function(){return{x:0,mean:0,range:0}}},{key:"_getDefaults",value:function(){return{meanRadius:3,rangeRadius:3,meanColor:"#232323",rangeColor:"steelblue"}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=[],this.$mean=new c["default"].Circle({}),this.$mean.shape=this,this.$max=new c["default"].Circle({}),this.$max.shape=this,this.$min=new c["default"].Circle({}),this.$min.shape=this,this.$el.push(this.$mean),this.$el.push(this.$max),this.$el.push(this.$min),this.$el)}},{key:"update",value:function(e,t){var i=this.mean(t),n=this.range(t),a=this.x(t),r=e.valueToPixel(i),s=n/2,o=e.valueToPixel(i+s),l=e.valueToPixel(i-s),h=e.timeToPixel(a);this.$mean.x(h).y(r).radius(this.params.meanRadius).stroke(this.params.rangeColor).fill("transparent").addName("mean"),this.$max.x(h).y(o).radius(this.params.meanRadius).stroke(this.params.rangeColor).fill("transparent").addName("max"),this.$min.x(h).y(l).radius(this.params.meanRadius).stroke(this.params.rangeColor).fill("transparent").addName("min")}},{key:"inArea",value:function(e,t,i,n,a,r){var s=e.timeToPixel(this.x(t)),o=e.valueToPixel(this.mean(t)),l=e.valueToPixel(this.range(t)),h=o-l/2,u=o+l/2;return s>i&&a>s&&(h>n||r>u)?!0:!1}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],50:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"getClassName",value:function(){return"trace-common"}},{key:"_getAccessorList",value:function(){return{x:0,mean:0,range:0}}},{key:"_getDefaults",value:function(){return{rangeColor:"steelblue",meanColor:"#232323",displayMean:!0}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=[],this.$range=new c["default"].Path({}),this.$range.shape=this,this.$mean=new c["default"].Path({}),this.$mean.shape=this,this.$el.push(this.$range),this.$el.push(this.$mean),this.$el)}},{key:"update",value:function(e,t){var i=this;t=t.slice(0),t.sort(function(e,t){return i.x(e)<i.x(t)?-1:1}),this.params.displayMean?this.$mean.visible(!0).data(this._buildMeanLine(e,t)).stroke(this.params.meanColor).fill("none"):this.$mean.visible(!1),this.$range.visible(!0).data(this._buildRangeZone(e,t)).stroke("none").fill(this.params.rangeColor).opacity(.4),t=null}},{key:"_buildMeanLine",value:function(e,t){var i=this,n=t.map(function(t,n){var a=e.timeToPixel(i.x(t)),r=e.valueToPixel(i.mean(t));return a+","+r});return"M"+n.join("L")}},{key:"_buildRangeZone",value:function(e,t){for(var i=t.length,n="",a="",r=0;i>r;r++){var s=t[r],o=this.mean(s),l=this.range(s)/2,h=e.timeToPixel(this.x(s)),u=e.valueToPixel(o+l),c=e.valueToPixel(o-l),d=h+","+u,f=h+","+c;n=""===n?d:n+"L"+d,a=""===a?f:f+"L"+a}var p="M"+n+"L"+a+"Z";return p}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],51:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-shape"),h=o(l),u=e("../utils/scales"),c=(o(u),e("konva")),d=o(c),f=function(e){function t(){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),r(t,[{key:"destroy",value:function(){this.$label.destroy(),this.$label=null,this.$header.destroy(),this.$header=null,this.$body.destroy(),this.$body=null,this.$leftHandler.destroy(),this.$leftHandler=null,this.$rightHandler.destroy(),this.$rightHandler=null,this.$waveform.destroy(),this.$waveform=null,n(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getClassName",value:function(){return"waveform"}},{key:"_getAccessorList",value:function(){return{data:[],x:0,width:1e4,bufferStart:0,bufferEnd:0,sampleRate:44100,color:"black",text:""}}},{key:"_getDefaults",value:function(){return{waveformQuality:2e3,squaringFactor:1,displayHandlers:!0,displayBody:!0,displayLabel:!0,displayHeader:!0,headerHeightRatio:.1,waveform:{color:"#000000",opacity:1},header:{color:"green",opacity:.4},body:{color:"yellow",opacity:.1},handler:{width:2,opacity:1,color:"orange"}}}},{key:"render",value:function(e){return this.$el?this.$el:(this.$el=[],this.$header=new d["default"].Rect({}),this.$header.addName("header"),this.$header.shape=this,this.$body=new d["default"].Rect({}),this.$body.addName("body"),this.$body.shape=this,this.$leftHandler=new d["default"].Rect({}),this.$leftHandler.addName("handler"),this.$leftHandler.addName("left"),this.$leftHandler.shape=this,this.$rightHandler=new d["default"].Rect({}),this.$rightHandler.addName("handler"),this.$rightHandler.addName("right"),this.$rightHandler.shape=this,this.$label=new d["default"].Text({listening:!1}),this.$label.shape=this,this.$waveform=new d["default"].Path({listening:!1}),this.$waveform.shape=this,this.$el.push(this.$body),this.$el.push(this.$waveform),this.$el.push(this.$header),this.$el.push(this.$label),this.$el.push(this.$leftHandler),this.$el.push(this.$rightHandler),this.$el)}},{key:"update",value:function(e,t){var i=t||this.datum;if(this.$header.visible(this.visible&&this.params.displayHeader),this.$label.visible(this.visible&&this.params.displayLabel),this.$body.visible(this.visible&&this.params.displayBody),this.$leftHandler.visible(this.visible&&this.params.displayHandlers),this.$rightHandler.visible(this.visible&&this.params.displayHandlers),this.$waveform.visible(this.visible),this.visible){var n=e.timeToPixel(this.x(i)),a=e.timeToPixel(this.width(i)),r=e.height;this.params.waveform.color;for(var s in this.$el)this.$el[s].x(n).y(0);this.$el.forEach(function(e){return e.x(n).y(0)}),this.$label.text(this.text(i)).x(n+10).y(5),this.$header.width(Math.max(a,0)).height(r*this.params.headerHeightRatio).fill(this.params.header.color).opacity(this.params.header.opacity),this.$body.width(Math.max(a,0)).height(r).fill(this.params.body.color).opacity(this.params.body.opacity),this.$leftHandler.width(this.params.handler.width).height(r).fill(this.params.handler.color),this.$rightHandler.x(n+a-this.params.handler.width).width(this.params.handler.width).height(r).fill(this.params.handler.color),this.$waveform.fill(this.params.waveform.color).opacity(this.params.waveform.opacity).y(0),this.$waveform.perfectDrawEnabled(!0);var o=this.data(i)instanceof Float32Array?"subarray":"slice",l=this.bufferEnd(i)-this.bufferStart(i),h=(l/this.sampleRate(i),l/a);if(h&&!(this.data(i).length<h)){for(var u=Math.max(-e.offsetX,e.timeToPixel(this.x(i))),c=Math.min(-e.offsetX+e.width,e.timeToPixel(this.x(i)+this.width(i))),d=e.timeToPixel.invert,f=this.sampleRate(i),p=[],v=u;c>v;v++){for(var m=d(v),g=m*f,b=this.data(i)[o](g,g+h),y=1/0,_=-(1/0),x=0,k=b.length;k>x;x++){var w=b[x];y>w&&(y=w),w>_&&(_=w)}y=isFinite(y)?y:0,_=isFinite(_)?_:0,(0!==y||0!==_)&&p.push([v,y,_])}if(p.length){var S=0,C=0,P=1,T=2,$=(e.valueToPixel(0),p.map(function(t,i){var n=t[C],a=Math.round(e.valueToPixel(t[P])),r=Math.round(e.valueToPixel(t[T]));return n+","+(a-S)+"L"+n+","+(r-S)}));"M"+$.join("L");this.$waveform.data("M"+("0,"+r/2+"L")+$.join("L")+("L"+p[p.length-1][0]+","+r/2)+"z")}}}}},{key:"inArea",value:function(e,t,i,n,a,r){var s=e.timeToPixel(this.x(t)),o=e.timeToPixel(this.x(t)+this.width(t)),l=e.valueToPixel(0),h=e.valueToPixel(e.height),u=Math.max(0,Math.min(a,o)-Math.max(i,s)),c=Math.max(0,Math.min(r,h)-Math.max(n,l)),d=u*c;return d>0}},{key:"linear_interpolation",value:function(e,t){var i=Math.floor(t),n=t-i,a=i+1<e.length?i+1:0;return e[i]*(1-n)+e[a]*n}}]),t}(h["default"]);i["default"]=f,t.exports=i["default"]},{"../utils/scales":66,"./base-shape":42,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],52:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(t){a(this,e),this.timeline=t}return n(e,[{key:"enter",value:function(){}},{key:"exit",value:function(){}},{key:"handleEvent",value:function(e,t){}},{key:"tracks",get:function(){return this.timeline.tracks}},{key:"layers",get:function(){return this.timeline.tracks.layers}}]),e}();i["default"]=r,t.exports=i["default"]},{"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81}],53:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-state"),h=o(l),u=function(e){function t(e,i){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.datumGenerator=i,this.currentEditedLayer=null,this.currentTarget=null}return a(t,e),r(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){}},{key:"handleEvent",value:function(e,t){switch(e.type){case"mousedown":this.onMouseDown(e,t);break;case"mousemove":this.onMouseMove(e,t);break;case"mouseup":this.onMouseUp(e,t)}}},{key:"onMouseDown",value:function(e,t){var i=this;this.mouseDown=!0,this.currentTarget=e.target;var n=null,a=t;a.forEach(function(t){t.unselect();var a=e.target;if(null===a||void 0===a||void 0===t.getDatumFromShape(a.shape)){var r=t.timeToPixel.invert(e.x)-i.timeline.offset,s=t.valueToPixel.invert(e.y),o=i.datumGenerator(r,s);t.add(o),n=t}else if(e.originalEvent.shiftKey){var o=t.getDatumFromShape(a.shape);t.remove(o),n=t}else{i.currentEditedLayer=t;var o=t.getDatumFromShape(a.shape);t.select([o])}t.selectedDatums.forEach(function(e){t.getShapeFromDatum(e).stopDrag()})}),n&&this.timeline.tracks.update(n)}},{key:"onMouseMove",value:function(e,t){if(this.mouseDown&&this.currentEditedLayer){var i=this.currentEditedLayer,n=i.selectedDatums;i.edit(n,e.dx,e.dy,this.currentTarget),i.updateShapes(n)}}},{key:"onMouseUp",value:function(e,t){t.forEach(function(e){e.selectedDatums.forEach(function(t){e.getShapeFromDatum(t).stopDrag()})}),this.currentEditedLayer=null,this.mouseDown=!1}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-state":52,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],54:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-state"),h=o(l),u=e("konva"),c=o(u),d=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return a(t,e),r(t,[{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e);break;case"keydown":this.onKeyDown(e)}}},{key:"onMouseDown",value:function(e){var t=this;this.brushes=[],this.startX=e.x,this.tracks.forEach(function(e){var i=e.$interactionsLayer,n=new c["default"].Rect({});n.height(e.height).y(0).fill("#787878").opacity(.2),n.track=e,i.add(n),t.brushes.push(n),i.batchDraw()})}},{key:"onMouseMove",value:function(e){var t=Math.abs(e.x-this.startX),i=Math.min(e.x,this.startX);this.brushes.forEach(function(e){e.x(i).width(t),e.track.$interactionsLayer.batchDraw()})}},{key:"onMouseUp",value:function(e){this.brushes.forEach(function(e){e.destroy(),e.track.$interactionsLayer.batchDraw(),e.track=null}),this.brushes.length=0;var t=this.startX,i=e.x;if(!(Math.abs(t-i)<1)){var n=Math.max(0,Math.min(t,i)),a=Math.max(t,i),r=this.timeline.timeToPixel.invert(n),s=this.timeline.timeToPixel.invert(a),o=s-r,l=this.timeline.visibleDuration/o;this.timeline.offset-=r,this.timeline.zoom*=l,this.tracks.update()}}},{key:"onKeyDown",value:function(e){32===e.originalEvent.keyCode&&(this.timeline.offset=0,this.timeline.zoom=1,this.tracks.update())}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"./base-state":52,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],55:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-state"),h=o(l),u=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.currentLayer=null,this.maxZoom=44100/this.timeline.timeContext.pixelsPerSecond,this.minZoom=1e4/3600/this.timeline.timeContext.pixelsPerSecond}return a(t,e),r(t,[{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e)}}},{key:"onMouseDown",value:function(e){}},{key:"onMouseMove",value:function(e){e.originalEvent.preventDefault();var t=this.timeline.timeContext,i=t.timeToPixel.invert(e.x),n=t.timeToPixel.invert(e.x),a=n-i;t.offset+=a+t.timeToPixel.invert(e.dx),t.offset=Math.min(t.offset,0),this.timeline.tracks.update()}},{key:"onMouseUp",value:function(e){}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-state":52,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],56:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-state"),h=o(l),u=e("../utils/scales"),c=o(u),d=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.currentLayer=null,this.maxZoom=44100/this.timeline.timeContext.pixelsPerSecond,this.minZoom=1e4/3600/this.timeline.timeContext.pixelsPerSecond}return a(t,e),r(t,[{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e)}}},{key:"onMouseDown",value:function(e){this.initialZoom=this.timeline.timeContext.zoom,this.initialY=e.y,this._pixelToExponent=c["default"].linear().domain([0,100]).range([0,1])}},{key:"onMouseMove",value:function(e){e.originalEvent.preventDefault();var t=this.timeline.timeContext,i=t.timeToPixel.invert(e.x),n=this._pixelToExponent(e.y-this.initialY),a=this.initialZoom*Math.pow(2,n);t.zoom=Math.min(Math.max(a,this.minZoom),this.maxZoom);var r=t.timeToPixel.invert(e.x),s=r-i;if(t.offset+=s+t.timeToPixel.invert(e.dx),t.stretchRatio<1){var o=t.timeToPixel.invert(0),l=t.timeToPixel.invert(view.width-t.timeToPixel(t.duration));t.offset=Math.max(t.offset,o),t.offset=Math.min(t.offset,l)}this.timeline.tracks.update()}},{key:"onMouseUp",value:function(e){}}]),t}(h["default"]);i["default"]=d,t.exports=i["default"]},{"../utils/scales":66,"./base-state":52,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],57:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-state"),h=o(l),u=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return a(t,e),r(t,[{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e)}}},{key:"onMouseDown",value:function(e){this.mouseDown=!0,this.currentTarget=e.target,this.currentLayer=this.currentTarget.shape?this.currentTarget.shape.layer:void 0}},{key:"onMouseMove",value:function(e){if(this.mouseDown&&this.currentLayer){var t=this.currentLayer,i=this.currentTarget;e.originalEvent.shiftKey?t.stretchContext(e.dx,e.dy,i):t.editContext(e.dx,e.dy,i),t.update()}}},{key:"onMouseUp",value:function(e){this.mouseDown=!1,this.currentTarget=null,this.currentLayer=null}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-state":52,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],58:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/map")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("./base-state"),u=l(h),c=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.targetLayer=new o}return a(t,e),r(t,[{key:"setTargetLayerForTrack",value:function(e,t){this.targetLayer.set(e,t)}},{key:"exit",value:function(){this.targetLayer.clear()}},{key:"handleEvent",value:function(e){switch(e.type){case"dragstart":this.onDragStart(e);break;case"dragend":this.onDragEnd(e);break;case"dragover":this.onDragOver(e);break;case"drop":this.onDrop(e);break;case"dragleave":this.onDragLeave(e)}}},{key:"onDragStart",value:function(e){}},{key:"onDragEnd",value:function(e){}},{key:"onDragOver",value:function(e){}},{key:"onDragLeave",value:function(e){}},{key:"onDrop",value:function(e){var t=-this.timeline.timeContext.offset,i=this.timeline.timeContext.timeToPixel.invert(e.x),n=t+i,a=this.timeline.getTrackFromDOMElement(e.currentTarget),r=this.targetLayer.get(a);if(r){var s=document.getElementById(e.originalEvent.dataTransfer.getData("Text")).getDatum();s.x=n,r.add(s),r.getShapeFromDatum(s).params.color=s.color,r.update()}e.originalEvent.dataTransfer.clearData()}}]),t}(u["default"]);i["default"]=c,t.exports=i["default"]},{"./base-state":52,"babel-runtime/core-js/map":69,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],59:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var l=e("./base-state"),h=o(l),u=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.currentEditedLayer=null,this.currentTarget=null}return a(t,e),r(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e)}}},{key:"onMouseDown",value:function(e){this.currentTarget=e.target}},{key:"onMouseMove",value:function(e){var t=this;this.layers.forEach(function(i){var n=i.selectedDatums;i.edit(n,e.dx,e.dy,t.currentTarget),i.update(n)})}},{key:"onMouseUp",value:function(e){this.currentEditedLayer=null,this.mouseDown=!1}}]),t}(h["default"]);i["default"]=u,t.exports=i["default"]},{"./base-state":52,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],60:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/map")["default"],l=e("babel-runtime/core-js/set")["default"],h=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var u=e("./base-state"),c=h(u),d=e("konva"),f=h(d),p=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this._layerSelectedItemsMap=new o,this.shiftKey=!1,this.wasMoving=!1}return a(t,e),r(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){var e=this.timeline.containers;for(var t in e)this._removeBrush(e[t])}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e);break;case"click":this.onClick(e);break;case"keydown":this.onKey(e);break;case"keyup":this.onKey(e)}}},{key:"_addBrush",value:function(e){if(!e.$brush){var t=new f["default"].Rect({});t.fill("#686868").opacity(.5),e.$interactionsLayer.add(t),e.$interactionsLayer.moveToTop(),e.$brush=t,e.$interactionsLayer.batchDraw()}}},{key:"_removeBrush",value:function(e){void 0!==e.$brush&&(this._resetBrush(e),e.$brush.destroy(),e.$interactionsLayer.batchDraw(),delete e.$brush)}},{key:"_resetBrush",value:function(e){var t=e.$brush;t.x(0).y(0).width(0).height(0),e.$interactionsLayer.batchDraw()}},{key:"_updateBrush",value:function(e,t){var i=t.$brush;i.x(e.area.left).y(0).width(e.area.width).height(t.height),t.$interactionsLayer.batchDraw()}},{key:"onKey",value:function(e){this.shiftKey=e.shiftKey}},{key:"onMouseDown",value:function(e){var t=this;this._currentTrack=this.timeline.getTrackFromDOMElement(e.currentTarget),this._currentTrack&&(this._addBrush(this._currentTrack),this._layerSelectedItemsMap=new o,this._currentTrack.layers.forEach(function(i){if(!e.originalEvent.shiftKey){var n=new l(i.selectedDatums);i.unselect(n),i.updateShapes(n)}t._layerSelectedItemsMap.set(i,new l(i.selectedDatums))}),this.mousedown=!0)}},{key:"onMouseMove",value:function(e){var t=this;if(this.mousedown){this.wasMoving=!0,e.area={left:e.area.left,width:e.area.width,top:0,height:this._currentTrack.height},this._updateBrush(e,this._currentTrack);this._currentTrack.layers.forEach(function(i){var n,a,r=i.selectedDatums,s=i.getDatumsInArea(e.area);e.originalEvent.shiftKey?!function(){n=new l,a=new l;var e=t._layerSelectedItemsMap.get(i);s.forEach(function(t){e.has(t)?a.add(t):n.add(t)}),r.forEach(function(t){s.has(t)||e.has(t)||a.add(t)}),e.forEach(function(e){s.has(e)||n.add(e)})}():(a=new l(r),n=new l(s)),i.unselect(a),i.select(n),i.updateShapes(r),i.updateShapes(s)})}}},{key:"onMouseUp",value:function(e){this._removeBrush(this._currentTrack),this.mousedown=!1,this.wasMoving=!1}},{key:"onClick",value:function(e){if(this._currentTrack){this._currentTrack.layers.forEach(function(t){var i=e.target.shape,n=t.getDatumFromShape(i),a=new l;e.originalEvent.shiftKey||(a=new l(t.selectedDatums),t.unselect(t.selectedDatums)),
n&&(a.add(n),t.toggleSelection([n])),t.updateShapes(a)})}}}]),t}(c["default"]);i["default"]=p,t.exports=i["default"]},{"./base-state":52,"babel-runtime/core-js/map":69,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],61:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/map")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("./base-state"),u=l(h),c=e("konva"),d=l(c),f=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.currentLayer=void 0,this.selectedDatums=void 0,this.mouseDown=!1,this.shiftKey=!1,this._layerSelectedItemsMap=new o}return a(t,e),r(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){var e=this.timeline.containers;for(var t in e)this._removeBrush(e[t])}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e);break;case"click":this.onClick(e);break;case"keydown":this.onKey(e);break;case"keyup":this.onKey(e)}}},{key:"_addBrush",value:function(e){if(!e.$brush){var t=new d["default"].Rect({});t.fill("#686868").opacity(.5),e.$interactionsLayer.add(t),e.$interactionsLayer.moveToTop(),e.$brush=t,e.$interactionsLayer.batchDraw()}}},{key:"_removeBrush",value:function(e){void 0!==e.$brush&&(this._resetBrush(e),e.$brush.destroy(),e.$interactionsLayer.batchDraw(),delete e.$brush)}},{key:"_resetBrush",value:function(e){var t=e.$brush;t.x(0).y(0).width(0).height(0),e.$interactionsLayer.batchDraw()}},{key:"_updateBrush",value:function(e,t){var i=t.$brush;i.x(e.area.left).y(e.area.top).width(e.area.width).height(e.area.height),t.$interactionsLayer.batchDraw()}},{key:"onKey",value:function(e){this.shiftKey=e.shiftKey}},{key:"onMouseDown",value:function(e){var t=this;this._currentTrack=this.timeline.getTrackFromDOMElement(e.currentTarget),this._currentTrack&&(this._addBrush(this._currentTrack),this._layerSelectedItemsMap=new o,this._currentTrack.layers.forEach(function(e){var i=[];e.selectedDatums.forEach(function(e){i.push(e)}),t._layerSelectedItemsMap.set(e,i.slice(0))}))}},{key:"onMouseMove",value:function(e){var t=this;console.log(e.area),this._updateBrush(e,this._currentTrack),this._currentTrack.layers.forEach(function(i){var n=i.selectedDatums,a=i.getDatumsInArea(e.area);e.originalEvent.shiftKey?!function(){var e=[],r=[],s=t._layerSelectedItemsMap.get(i);a.forEach(function(t){-1===s.indexOf(t)?e.push(t):r.push(t)}),n.forEach(function(e){-1===a.indexOf(e)&&-1===s.indexOf(e)&&r.push(e)}),i.unselect(r),i.select(e)}():(i.unselect(n),i.select(a))})}},{key:"onMouseUp",value:function(e){this._removeBrush(this._currentTrack)}},{key:"onClick",value:function(e){this._currentTrack&&this._currentTrack.layers.forEach(function(t){var i=e.target.shape,n=t.getDatumFromShape(i);e.originalEvent.shiftKey||t.unselect(),n&&t.toggleSelection([n])})}}]),t}(u["default"]);i["default"]=f,t.exports=i["default"]},{"./base-state":52,"babel-runtime/core-js/map":69,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],62:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/map")["default"],l=e("babel-runtime/core-js/set")["default"],h=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var u=e("./base-state"),c=h(u),d=e("konva"),f=h(d),p=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this._layerSelectedItemsMap=new o,this.shiftKey=!1,this.wasMoving=!1}return a(t,e),r(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){var e=this.timeline.containers;for(var t in e)this._removeBrush(e[t])}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e);break;case"click":this.onClick(e);break;case"keydown":this.onKey(e);break;case"keyup":this.onKey(e)}}},{key:"_addBrush",value:function(e){if(!e.$brush){var t=new f["default"].Rect({});t.fill("#686868").opacity(.5),e.$interactionsLayer.add(t),e.$interactionsLayer.moveToTop(),e.$brush=t,e.$interactionsLayer.batchDraw()}}},{key:"_removeBrush",value:function(e){void 0!==e.$brush&&(this._resetBrush(e),e.$brush.destroy(),e.$interactionsLayer.batchDraw(),delete e.$brush)}},{key:"_resetBrush",value:function(e){var t=e.$brush;t.x(0).y(0).width(0).height(0),e.$interactionsLayer.batchDraw()}},{key:"_updateBrush",value:function(e,t){var i=t.$brush;i.x(e.area.left).y(0).width(e.area.width).height(t.height),t.$interactionsLayer.batchDraw()}},{key:"onKey",value:function(e){this.shiftKey=e.shiftKey}},{key:"onMouseDown",value:function(e){var t=this;this._currentTrack=this.timeline.getTrackFromDOMElement(e.currentTarget),this._currentTrack&&(this._addBrush(this._currentTrack),this._layerSelectedItemsMap=new o,this._currentTrack.layers.forEach(function(i){if(!e.originalEvent.shiftKey){var n=new l(i.selectedDatums);i.unselect(n),i.updateShapes(n)}t._layerSelectedItemsMap.set(i,new l(i.selectedDatums))}))}},{key:"onMouseMove",value:function(e){var t=this;this.wasMoving=!0,e.area={left:e.area.left,width:e.area.width,top:0,height:this._currentTrack.height},this._updateBrush(e,this._currentTrack);this._currentTrack.layers.forEach(function(i){var n,a,r=i.selectedDatums,s=i.getDatumsInArea(e.area);e.originalEvent.shiftKey?!function(){n=new l,a=new l;var e=t._layerSelectedItemsMap.get(i);s.forEach(function(t){e.has(t)?a.add(t):n.add(t)}),r.forEach(function(t){s.has(t)||e.has(t)||a.add(t)}),e.forEach(function(e){s.has(e)||n.add(e)})}():(a=new l(r),n=new l(s)),i.unselect(a),i.select(n),i.updateShapes(r),i.updateShapes(s)})}},{key:"onMouseUp",value:function(e){this._removeBrush(this._currentTrack),this.wasMoving&&(this.wasMoving=!1)}},{key:"onClick",value:function(e){if(this._currentTrack){this._currentTrack.layers.forEach(function(t){var i=e.target.shape,n=t.getDatumFromShape(i),a=new l;e.originalEvent.shiftKey||(a=new l(t.selectedDatums),t.unselect(t.selectedDatums)),n&&(a.add(n),t.toggleSelection([n])),t.updateShapes(a)})}}},{key:"targetLayer",set:function(e){this._layer=e},get:function(){return this._layer}}]),t}(c["default"]);i["default"]=p,t.exports=i["default"]},{"./base-state":52,"babel-runtime/core-js/map":69,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84,konva:172}],63:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/get")["default"],a=e("babel-runtime/helpers/inherits")["default"],r=e("babel-runtime/helpers/create-class")["default"],s=e("babel-runtime/helpers/class-call-check")["default"],o=e("babel-runtime/core-js/set")["default"],l=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var h=e("./base-state"),u=l(h),c=function(e){function t(e){s(this,t),n(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.currentEditedLayer=null,this.currentTarget=null}return a(t,e),r(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){this.currentEditedLayer=null,this.currentTarget=null}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.onMouseDown(e);break;case"mousemove":this.onMouseMove(e);break;case"mouseup":this.onMouseUp(e)}}},{key:"onMouseDown",value:function(e){if(this.currentTarget=e.target,this.currentTarget.shape&&this.currentTarget.shape.isContextShape)return void(e.originalEvent.shiftKey||this.timeline.getTrackFromDOMElement(e.currentTarget).layers.forEach(function(e){var t=new o(e.selectedDatums);e.unselect(e.selectedDatums),e.updateShapes(t)}));if(!this.currentTarget.shape)return void(e.originalEvent.shiftKey||this.timeline.getTrackFromDOMElement(e.currentTarget).layers.forEach(function(e){var t=new o(e.selectedDatums);e.unselect(e.selectedDatums),e.updateShapes(t)}));var t=this.currentTarget.shape.layer,i=new o(t.selectedDatums),n=this;if(this.currentTarget.shape.layer){e.originalEvent.shiftKey||this.timeline.getTrackFromDOMElement(e.currentTarget).layers.forEach(function(e){return e.unselect(e.selectedDatums)}),this.currentEditedLayer=t;var a=t.getDatumFromShape(this.currentTarget.shape);void 0!==a&&(t.select([a]),i.add(a)),t.updateShapes(i),this.currentEditedLayer.selectedDatums.forEach(function(e){n.currentEditedLayer.getShapeFromDatum(e).startDrag()})}else e.originalEvent.shiftKey||(t.unselect(t.selectedDatums),t.updateShapes(i),this.currentEditedLayer.selectedDatums.forEach(function(e){n.currentEditedLayer.getShapeFromDatum(e).startDrag()}))}},{key:"onMouseMove",value:function(e){if(this.currentEditedLayer){var t=this.currentEditedLayer,i=t.selectedDatums;t.edit(i,e.dx,e.dy,this.currentTarget),t.updateShapes(i)}}},{key:"onMouseUp",value:function(e){var t=this.currentEditedLayer;t&&(t.updateShapes(t.selectedDatums),t.selectedDatums.forEach(function(e){t.getShapeFromDatum(e).stopDrag()}),this.currentEditedLayer=null)}}]),t}(u["default"]);i["default"]=c,t.exports=i["default"]},{"./base-state":52,"babel-runtime/core-js/set":77,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81,"babel-runtime/helpers/get":82,"babel-runtime/helpers/inherits":83,"babel-runtime/helpers/interop-require-default":84}],64:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={padLeft:function(e,t,i){for(e+="";e.length<i;)e=t+e;return e}},t.exports=i["default"]},{}],65:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],r=e("babel-runtime/core-js/object/keys")["default"];Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(){a(this,e),this._cols=null,this._rows=null}return n(e,[{key:"_checkConsistency",value:function(){var e=null;for(var t in this._cols){var i=this._cols[t],n=i.length;if(null!==e&&e!==n)throw new Error(this.prototype.constructor.name+": inconsistent data");null===e&&(e=n)}}},{key:"updateFromCols",value:function(){var e=this,t=r(this._cols);t.forEach(function(t,i){var n=e._cols[t];n.forEach(function(i,n){void 0===e._rows[n]&&(e._rows[n]={}),e._rows[n][t]=i})}),this._checkConsistency()}},{key:"updateFromRows",value:function(){var e=this;this._rows.forEach(function(t,i){for(var n in t)0===i&&(e._cols[n]=[]),e._cols[n].push(t[n])}),this._checkConsistency()}},{key:"cols",set:function(e){this._cols=e,this._rows=[],this.updateFromCols()},get:function(){return this._cols}},{key:"rows",set:function(e){this._rows=e,this._cols={},this.updateFromRows()},get:function(){return this._rows}}]),e}();i["default"]=s,t.exports=i["default"]},{"babel-runtime/core-js/object/keys":74,"babel-runtime/helpers/class-call-check":80,"babel-runtime/helpers/create-class":81}],66:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={linear:function(){function e(){a=(n[1]-n[0])/(i[1]-i[0]),r=n[0]-a*i[0]}function t(e){return a*e+r}var i=[0,1],n=[0,1],a=1,r=0;return t.invert=function(e){return(e-r)/a},t.domain=function(){var n=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return null===n?i:(i=n,e(),t)},t.range=function(){var i=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return null===i?n:(n=i,e(),t)},t}},t.exports=i["default"]},{}],67:[function(e,t,i){"use strict";var n=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(i,"__esModule",{value:!0});var a=e("./axis/axis-layer"),r=n(a),s=e("./axis/time-axis-generator"),o=n(s),l=e("./axis/grid-axis-generator"),h=n(l),u=e("./behaviors/base-behavior"),c=n(u),d=e("./behaviors/beat-grid-snap-segment-behavior"),f=n(d),p=e("./behaviors/breakpoint-behavior"),v=n(p),m=e("./behaviors/marker-behavior"),g=n(m),b=e("./behaviors/scroll-segment-behavior"),y=n(b),_=e("./behaviors/segment-behavior"),x=n(_),k=e("./behaviors/sibling-locked-segment-behavior"),w=n(k),S=e("./behaviors/simple-snap-segment-behavior"),C=n(S),P=e("./behaviors/time-context-behavior"),T=n(P),$=e("./behaviors/trace-behavior"),K=n($),M=e("./behaviors/waveform-behavior"),L=n(M),D=e("./behaviors/no-behavior"),F=n(D),O=e("./core/layer-time-context"),j=n(O),E=e("./core/layer"),A=n(E),R=e("./core/timeline-time-context"),G=n(R),N=e("./core/timeline"),I=n(N),B=e("./core/track-collection"),U=n(B),H=e("./core/track"),q=n(H),W=e("./helpers/annotated-marker-layer"),z=n(W),X=e("./helpers/annotated-segment-layer"),Y=n(X),V=e("./helpers/breakpoint-layer"),Z=n(V),J=e("./helpers/cursor-layer"),Q=n(J),ee=e("./helpers/grid-axis-layer"),te=n(ee),ie=e("./helpers/marker-layer"),ne=n(ie),ae=e("./helpers/segment-layer"),re=n(ae),se=e("./helpers/tick-layer"),oe=n(se),le=e("./helpers/time-axis-layer"),he=n(le),ue=e("./helpers/trace-layer"),ce=n(ue),de=e("./helpers/waveform-layer"),fe=n(de),pe=e("./helpers/beat-grid-layer"),ve=n(pe),me=e("./helpers/scroller"),ge=n(me),be=e("./interactions/event-source"),ye=n(be),_e=e("./interactions/keyboard"),xe=n(_e),ke=e("./interactions/konva-surface"),we=n(ke),Se=e("./interactions/konva-wave-event"),Ce=n(Se),Pe=e("./interactions/wave-event"),Te=n(Pe),$e=e("./shapes/annotated-segment"),Ke=n($e),Me=e("./shapes/base-shape"),Le=n(Me),De=e("./shapes/cursor"),Fe=n(De),Oe=e("./shapes/dot"),je=n(Oe),Ee=e("./shapes/line"),Ae=n(Ee),Re=e("./shapes/marker"),Ge=n(Re),Ne=e("./shapes/segment"),Ie=n(Ne),Be=e("./shapes/ticks"),Ue=n(Be),He=e("./shapes/trace-dots"),qe=n(He),We=e("./shapes/trace-path"),ze=n(We),Xe=e("./shapes/waveform"),Ye=n(Xe),Ve=e("./states/base-state"),Ze=n(Ve),Je=e("./states/breakpoint-state"),Qe=n(Je),et=e("./states/brush-zoom-state"),tt=n(et),it=e("./states/centered-zoom-state"),nt=n(it),at=e("./states/centered-scroll-state"),rt=n(at),st=e("./states/context-edition-state"),ot=n(st),lt=e("./states/drop-and-add-state"),ht=n(lt),ut=e("./states/edition-state"),ct=n(ut),dt=e("./states/horizontal-selection-state"),ft=n(dt),pt=e("./states/selection-state"),vt=n(pt),mt=e("./states/shape-insertion-state"),gt=n(mt),bt=e("./states/simple-edition-state"),yt=n(bt),_t=e("./utils/format"),xt=n(_t),kt=e("./utils/orthogonal-data"),wt=n(kt),St=e("./utils/scales"),Ct=n(St);i["default"]={axis:{AxisLayer:r["default"],timeAxisGenerator:o["default"],gridAxisGenerator:h["default"]},behaviors:{BaseBehavior:c["default"],BeatGridSnapSegmentBehavior:f["default"],BreakpointBehavior:v["default"],MarkerBehavior:g["default"],ScrollSegmentBehavior:y["default"],SegmentBehavior:x["default"],SiblingLockedSegmentBehavior:w["default"],SimpleSnapSegmentBehavior:C["default"],TimeContextBehavior:T["default"],TraceBehavior:K["default"],WaveformBehavior:L["default"],NoBehavior:F["default"]},core:{LayerTimeContext:j["default"],Layer:A["default"],TimelineTimeContext:G["default"],Timeline:I["default"],TrackCollection:U["default"],Track:q["default"]},helpers:{AnnotatedMarkerLayer:z["default"],AnnotatedSegmentLayer:Y["default"],BreakpointLayer:Z["default"],CursorLayer:Q["default"],GridAxisLayer:te["default"],MarkerLayer:ne["default"],SegmentLayer:re["default"],TickLayer:oe["default"],TimeAxisLayer:he["default"],TraceLayer:ce["default"],WaveformLayer:fe["default"],BeatGridLayer:ve["default"],Scroller:ge["default"]},interactions:{EventSource:ye["default"],Keyboard:xe["default"],Surface:we["default"],KonvaWaveEvent:Ce["default"],WaveEvent:Te["default"]},shapes:{AnnotatedSegment:Ke["default"],BaseShape:Le["default"],Cursor:Fe["default"],Dot:je["default"],Line:Ae["default"],Marker:Ge["default"],Segment:Ie["default"],Ticks:Ue["default"],TraceDots:qe["default"],TracePath:ze["default"],Waveform:Ye["default"]},states:{BaseState:Ze["default"],BreakpointState:Qe["default"],BrushZoomState:tt["default"],CenteredZoomState:nt["default"],CenteredScrollState:rt["default"],ContextEditionState:ot["default"],DropAndAddState:ht["default"],EditionState:ct["default"],SelectionState:vt["default"],HorizontalSelectionState:ft["default"],ShapeInsertionState:gt["default"],SimpleEditionState:yt["default"]},utils:{format:xt["default"],OrthogonalData:wt["default"],scales:Ct["default"]}},t.exports=i["default"]},{"./axis/axis-layer":1,"./axis/grid-axis-generator":2,"./axis/time-axis-generator":3,"./behaviors/base-behavior":4,"./behaviors/beat-grid-snap-segment-behavior":5,"./behaviors/breakpoint-behavior":6,"./behaviors/marker-behavior":7,"./behaviors/no-behavior":8,"./behaviors/scroll-segment-behavior":9,"./behaviors/segment-behavior":10,"./behaviors/sibling-locked-segment-behavior":11,"./behaviors/simple-snap-segment-behavior":12,"./behaviors/time-context-behavior":13,"./behaviors/trace-behavior":14,"./behaviors/waveform-behavior":15,"./core/layer":17,"./core/layer-time-context":16,"./core/timeline":19,"./core/timeline-time-context":18,"./core/track":21,"./core/track-collection":20,"./helpers/annotated-marker-layer":22,"./helpers/annotated-segment-layer":23,"./helpers/beat-grid-layer":24,"./helpers/breakpoint-layer":25,"./helpers/cursor-layer":26,"./helpers/grid-axis-layer":27,"./helpers/marker-layer":28,"./helpers/scroller":29,"./helpers/segment-layer":30,"./helpers/tick-layer":31,"./helpers/time-axis-layer":32,"./helpers/trace-layer":33,"./helpers/waveform-layer":34,"./interactions/event-source":35,"./interactions/keyboard":36,"./interactions/konva-surface":37,"./interactions/konva-wave-event":38,"./interactions/wave-event":39,"./shapes/annotated-segment":41,"./shapes/base-shape":42,"./shapes/cursor":43,"./shapes/dot":44,"./shapes/line":45,"./shapes/marker":46,"./shapes/segment":47,"./shapes/ticks":48,"./shapes/trace-dots":49,"./shapes/trace-path":50,"./shapes/waveform":51,"./states/base-state":52,"./states/breakpoint-state":53,"./states/brush-zoom-state":54,"./states/centered-scroll-state":55,"./states/centered-zoom-state":56,"./states/context-edition-state":57,"./states/drop-and-add-state":58,"./states/edition-state":59,"./states/horizontal-selection-state":60,"./states/selection-state":61,"./states/shape-insertion-state":62,"./states/simple-edition-state":63,"./utils/format":64,"./utils/orthogonal-data":65,"./utils/scales":66,"babel-runtime/helpers/interop-require-default":84}],68:[function(e,t,i){t.exports={"default":e("core-js/library/fn/get-iterator"),__esModule:!0}},{"core-js/library/fn/get-iterator":85}],69:[function(e,t,i){t.exports={"default":e("core-js/library/fn/map"),__esModule:!0}},{"core-js/library/fn/map":86}],70:[function(e,t,i){t.exports={"default":e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":87}],71:[function(e,t,i){t.exports={"default":e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":88}],72:[function(e,t,i){t.exports={"default":e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":89}],73:[function(e,t,i){t.exports={"default":e("core-js/library/fn/object/get-own-property-descriptor"),__esModule:!0}},{"core-js/library/fn/object/get-own-property-descriptor":90}],74:[function(e,t,i){t.exports={"default":e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":91}],75:[function(e,t,i){t.exports={"default":e("core-js/library/fn/object/set-prototype-of"),__esModule:!0}},{"core-js/library/fn/object/set-prototype-of":92}],76:[function(e,t,i){t.exports={"default":e("core-js/library/fn/promise"),__esModule:!0}},{"core-js/library/fn/promise":93}],77:[function(e,t,i){t.exports={"default":e("core-js/library/fn/set"),__esModule:!0}},{"core-js/library/fn/set":94}],78:[function(e,t,i){t.exports={"default":e("core-js/library/fn/symbol"),__esModule:!0}},{"core-js/library/fn/symbol":95}],79:[function(e,t,i){t.exports={"default":e("core-js/library/fn/symbol/iterator"),__esModule:!0}},{"core-js/library/fn/symbol/iterator":96}],80:[function(e,t,i){"use strict";i["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i.__esModule=!0},{}],81:[function(e,t,i){"use strict";var n=e("babel-runtime/core-js/object/define-property")["default"];i["default"]=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(e,a.key,a)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),i.__esModule=!0},{"babel-runtime/core-js/object/define-property":72}],82:[function(e,t,i){"use strict";var n=e("babel-runtime/core-js/object/get-own-property-descriptor")["default"];i["default"]=function(e,t,i){for(var a=!0;a;){var r=e,s=t,o=i;a=!1,null===r&&(r=Function.prototype);var l=n(r,s);if(void 0!==l){if("value"in l)return l.value;var h=l.get;return void 0===h?void 0:h.call(o)}var u=Object.getPrototypeOf(r);if(null===u)return void 0;e=u,t=s,i=o,a=!0,l=u=void 0}},i.__esModule=!0},{"babel-runtime/core-js/object/get-own-property-descriptor":73}],83:[function(e,t,i){"use strict";var n=e("babel-runtime/core-js/object/create")["default"],a=e("babel-runtime/core-js/object/set-prototype-of")["default"];i["default"]=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=n(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(a?a(e,t):e.__proto__=t)},i.__esModule=!0},{"babel-runtime/core-js/object/create":71,"babel-runtime/core-js/object/set-prototype-of":75}],84:[function(e,t,i){"use strict";i["default"]=function(e){return e&&e.__esModule?e:{"default":e}},i.__esModule=!0},{}],85:[function(e,t,i){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),t.exports=e("../modules/core.get-iterator")},{"../modules/core.get-iterator":155,"../modules/es6.string.iterator":165,"../modules/web.dom.iterable":169}],86:[function(e,t,i){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.map"),e("../modules/es7.map.to-json"),t.exports=e("../modules/$.core").Map},{"../modules/$.core":105,"../modules/es6.map":157,"../modules/es6.object.to-string":162,"../modules/es6.string.iterator":165,"../modules/es7.map.to-json":167,"../modules/web.dom.iterable":169}],87:[function(e,t,i){e("../../modules/es6.object.assign"),t.exports=e("../../modules/$.core").Object.assign},{"../../modules/$.core":105,"../../modules/es6.object.assign":158}],88:[function(e,t,i){var n=e("../../modules/$");t.exports=function(e,t){return n.create(e,t)}},{"../../modules/$":129}],89:[function(e,t,i){var n=e("../../modules/$");t.exports=function(e,t,i){return n.setDesc(e,t,i)}},{"../../modules/$":129}],90:[function(e,t,i){var n=e("../../modules/$");e("../../modules/es6.object.get-own-property-descriptor"),t.exports=function(e,t){return n.getDesc(e,t)}},{"../../modules/$":129,"../../modules/es6.object.get-own-property-descriptor":159}],91:[function(e,t,i){e("../../modules/es6.object.keys"),t.exports=e("../../modules/$.core").Object.keys},{"../../modules/$.core":105,"../../modules/es6.object.keys":160}],92:[function(e,t,i){e("../../modules/es6.object.set-prototype-of"),t.exports=e("../../modules/$.core").Object.setPrototypeOf},{"../../modules/$.core":105,"../../modules/es6.object.set-prototype-of":161}],93:[function(e,t,i){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.promise"),t.exports=e("../modules/$.core").Promise},{"../modules/$.core":105,"../modules/es6.object.to-string":162,"../modules/es6.promise":163,"../modules/es6.string.iterator":165,"../modules/web.dom.iterable":169}],94:[function(e,t,i){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.set"),e("../modules/es7.set.to-json"),t.exports=e("../modules/$.core").Set},{"../modules/$.core":105,"../modules/es6.object.to-string":162,"../modules/es6.set":164,"../modules/es6.string.iterator":165,"../modules/es7.set.to-json":168,"../modules/web.dom.iterable":169}],95:[function(e,t,i){e("../../modules/es6.symbol"),t.exports=e("../../modules/$.core").Symbol},{"../../modules/$.core":105,"../../modules/es6.symbol":166}],96:[function(e,t,i){e("../../modules/es6.string.iterator"),e("../../modules/web.dom.iterable"),t.exports=e("../../modules/$.wks")("iterator")},{"../../modules/$.wks":153,"../../modules/es6.string.iterator":165,"../../modules/web.dom.iterable":169}],97:[function(e,t,i){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],98:[function(e,t,i){var n=e("./$.is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":122}],99:[function(e,t,i){var n=e("./$"),a=e("./$.to-object"),r=e("./$.iobject");t.exports=e("./$.fails")(function(){var e=Object.assign,t={},i={},n=Symbol(),a="abcdefghijklmnopqrst";return t[n]=7,a.split("").forEach(function(e){i[e]=e}),7!=e({},t)[n]||Object.keys(e({},i)).join("")!=a})?function(e,t){for(var i=a(e),s=arguments,o=s.length,l=1,h=n.getKeys,u=n.getSymbols,c=n.isEnum;o>l;)for(var d,f=r(s[l++]),p=u?h(f).concat(u(f)):h(f),v=p.length,m=0;v>m;)c.call(f,d=p[m++])&&(i[d]=f[d]);return i}:Object.assign},{"./$":129,"./$.fails":111,"./$.iobject":119,"./$.to-object":150}],100:[function(e,t,i){var n=e("./$.cof"),a=e("./$.wks")("toStringTag"),r="Arguments"==n(function(){return arguments}());t.exports=function(e){var t,i,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=(t=Object(e))[a])?i:r?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},{"./$.cof":101,"./$.wks":153}],101:[function(e,t,i){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],102:[function(e,t,i){"use strict";var n=e("./$"),a=e("./$.hide"),r=e("./$.ctx"),s=e("./$.species"),o=e("./$.strict-new"),l=e("./$.defined"),h=e("./$.for-of"),u=e("./$.iter-step"),c=e("./$.uid")("id"),d=e("./$.has"),f=e("./$.is-object"),p=Object.isExtensible||f,v=e("./$.support-desc"),m=v?"_s":"size",g=0,b=function(e,t){if(!f(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!d(e,c)){if(!p(e))return"F";if(!t)return"E";a(e,c,++g)}return"O"+e[c]},y=function(e,t){var i,n=b(t);if("F"!==n)return e._i[n];for(i=e._f;i;i=i.n)if(i.k==t)return i};t.exports={getConstructor:function(t,i,a,s){var u=t(function(e,t){o(e,u,i),e._i=n.create(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=t&&h(t,a,e[s],e)});return e("./$.mix")(u.prototype,{clear:function(){for(var e=this,t=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete t[i.i];e._f=e._l=void 0,e[m]=0},"delete":function(e){var t=this,i=y(t,e);if(i){var n=i.n,a=i.p;delete t._i[i.i],i.r=!0,a&&(a.n=n),n&&(n.p=a),t._f==i&&(t._f=n),t._l==i&&(t._l=a),t[m]--}return!!i},forEach:function(e){for(var t,i=r(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(i(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!y(this,e)}}),v&&n.setDesc(u.prototype,"size",{get:function(){return l(this[m])}}),u},def:function(e,t,i){var n,a,r=y(e,t);return r?r.v=i:(e._l=r={i:a=b(t,!0),k:t,v:i,p:n=e._l,n:void 0,r:!1},e._f||(e._f=r),n&&(n.n=r),e[m]++,"F"!==a&&(e._i[a]=r)),e},getEntry:y,setStrong:function(t,i,n){e("./$.iter-define")(t,i,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,i=e._l;i&&i.r;)i=i.p;return e._t&&(e._l=i=i?i.n:e._t._f)?"keys"==t?u(0,i.k):"values"==t?u(0,i.v):u(0,[i.k,i.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),s(t),s(e("./$.core")[i])}}},{"./$":129,"./$.core":105,"./$.ctx":106,"./$.defined":108,"./$.for-of":112,"./$.has":115,"./$.hide":116,"./$.is-object":122,"./$.iter-define":125,"./$.iter-step":127,"./$.mix":133,"./$.species":141,"./$.strict-new":142,"./$.support-desc":144,"./$.uid":151}],103:[function(e,t,i){var n=e("./$.for-of"),a=e("./$.classof");t.exports=function(e){return function(){if(a(this)!=e)throw TypeError(e+"#toJSON isn't generic");var t=[];return n(this,!1,t.push,t),t}}},{"./$.classof":100,"./$.for-of":112}],104:[function(e,t,i){"use strict";var n=e("./$"),a=e("./$.def"),r=e("./$.hide"),s=e("./$.for-of"),o=e("./$.strict-new");t.exports=function(t,i,l,h,u,c){var d=e("./$.global")[t],f=d,p=u?"set":"add",v=f&&f.prototype,m={};return e("./$.support-desc")&&"function"==typeof f&&(c||v.forEach&&!e("./$.fails")(function(){(new f).entries().next()}))?(f=i(function(e,i){o(e,f,t),e._c=new d,void 0!=i&&s(i,u,e[p],e)}),n.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(e){var t="add"==e||"set"==e;e in v&&(!c||"clear"!=e)&&r(f.prototype,e,function(i,n){var a=this._c[e](0===i?0:i,n);return t?this:a})}),"size"in v&&n.setDesc(f.prototype,"size",{get:function(){return this._c.size}})):(f=h.getConstructor(i,t,u,p),e("./$.mix")(f.prototype,l)),e("./$.tag")(f,t),m[t]=f,a(a.G+a.W+a.F,m),c||h.setStrong(f,t,u),f}},{"./$":129,"./$.def":107,"./$.fails":111,"./$.for-of":112,"./$.global":114,"./$.hide":116,"./$.mix":133,"./$.strict-new":142,"./$.support-desc":144,"./$.tag":145}],105:[function(e,t,i){var n=t.exports={version:"1.2.3"};"number"==typeof __e&&(__e=n)},{}],106:[function(e,t,i){var n=e("./$.a-function");t.exports=function(e,t,i){if(n(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,a){return e.call(t,i,n,a)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":97}],107:[function(e,t,i){var n=e("./$.global"),a=e("./$.core"),r="prototype",s=function(e,t){return function(){return e.apply(t,arguments)}},o=function(e,t,i){var l,h,u,c,d=e&o.G,f=e&o.P,p=d?n:e&o.S?n[t]:(n[t]||{})[r],v=d?a:a[t]||(a[t]={});d&&(i=t);for(l in i)h=!(e&o.F)&&p&&l in p,h&&l in v||(u=h?p[l]:i[l],d&&"function"!=typeof p[l]?c=i[l]:e&o.B&&h?c=s(u,n):e&o.W&&p[l]==u?!function(e){c=function(t){return this instanceof e?new e(t):e(t)},c[r]=e[r]}(u):c=f&&"function"==typeof u?s(Function.call,u):u,v[l]=c,f&&((v[r]||(v[r]={}))[l]=u))};o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,t.exports=o},{"./$.core":105,"./$.global":114}],108:[function(e,t,i){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],109:[function(e,t,i){var n=e("./$.is-object"),a=e("./$.global").document,r=n(a)&&n(a.createElement);t.exports=function(e){return r?a.createElement(e):{}}},{"./$.global":114,"./$.is-object":122}],110:[function(e,t,i){var n=e("./$");t.exports=function(e){var t=n.getKeys(e),i=n.getSymbols;if(i)for(var a,r=i(e),s=n.isEnum,o=0;r.length>o;)s.call(e,a=r[o++])&&t.push(a);return t}},{"./$":129}],111:[function(e,t,i){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],112:[function(e,t,i){var n=e("./$.ctx"),a=e("./$.iter-call"),r=e("./$.is-array-iter"),s=e("./$.an-object"),o=e("./$.to-length"),l=e("./core.get-iterator-method");t.exports=function(e,t,i,h){var u,c,d,f=l(e),p=n(i,h,t?2:1),v=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(r(f))for(u=o(e.length);u>v;v++)t?p(s(c=e[v])[0],c[1]):p(e[v]);else for(d=f.call(e);!(c=d.next()).done;)a(d,p,c.value,t)}},{"./$.an-object":98,"./$.ctx":106,"./$.is-array-iter":120,"./$.iter-call":123,"./$.to-length":149,"./core.get-iterator-method":154}],113:[function(e,t,i){var n={}.toString,a=e("./$.to-iobject"),r=e("./$").getNames,s="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(e){
try{return r(e)}catch(t){return s.slice()}};t.exports.get=function(e){return s&&"[object Window]"==n.call(e)?o(e):r(a(e))}},{"./$":129,"./$.to-iobject":148}],114:[function(e,t,i){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],115:[function(e,t,i){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],116:[function(e,t,i){var n=e("./$"),a=e("./$.property-desc");t.exports=e("./$.support-desc")?function(e,t,i){return n.setDesc(e,t,a(1,i))}:function(e,t,i){return e[t]=i,e}},{"./$":129,"./$.property-desc":135,"./$.support-desc":144}],117:[function(e,t,i){t.exports=e("./$.global").document&&document.documentElement},{"./$.global":114}],118:[function(e,t,i){t.exports=function(e,t,i){var n=void 0===i;switch(t.length){case 0:return n?e():e.call(i);case 1:return n?e(t[0]):e.call(i,t[0]);case 2:return n?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},{}],119:[function(e,t,i){var n=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./$.cof":101}],120:[function(e,t,i){var n=e("./$.iterators"),a=e("./$.wks")("iterator");t.exports=function(e){return(n.Array||Array.prototype[a])===e}},{"./$.iterators":128,"./$.wks":153}],121:[function(e,t,i){var n=e("./$.cof");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"./$.cof":101}],122:[function(e,t,i){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],123:[function(e,t,i){var n=e("./$.an-object");t.exports=function(e,t,i,a){try{return a?t(n(i)[0],i[1]):t(i)}catch(r){var s=e["return"];throw void 0!==s&&n(s.call(e)),r}}},{"./$.an-object":98}],124:[function(e,t,i){"use strict";var n=e("./$"),a={};e("./$.hide")(a,e("./$.wks")("iterator"),function(){return this}),t.exports=function(t,i,r){t.prototype=n.create(a,{next:e("./$.property-desc")(1,r)}),e("./$.tag")(t,i+" Iterator")}},{"./$":129,"./$.hide":116,"./$.property-desc":135,"./$.tag":145,"./$.wks":153}],125:[function(e,t,i){"use strict";var n=e("./$.library"),a=e("./$.def"),r=e("./$.redef"),s=e("./$.hide"),o=e("./$.has"),l=e("./$.wks")("iterator"),h=e("./$.iterators"),u=!([].keys&&"next"in[].keys()),c="@@iterator",d="keys",f="values",p=function(){return this};t.exports=function(t,i,v,m,g,b,y){e("./$.iter-create")(v,i,m);var _,x,k=function(e){switch(e){case d:return function(){return new v(this,e)};case f:return function(){return new v(this,e)}}return function(){return new v(this,e)}},w=i+" Iterator",S=t.prototype,C=S[l]||S[c]||g&&S[g],P=C||k(g);if(C){var T=e("./$").getProto(P.call(new t));e("./$.tag")(T,w,!0),!n&&o(S,c)&&s(T,l,p)}if((!n||y)&&s(S,l,P),h[i]=P,h[w]=p,g)if(_={values:g==f?P:k(f),keys:b?P:k(d),entries:g!=f?P:k("entries")},y)for(x in _)x in S||r(S,x,_[x]);else a(a.P+a.F*u,i,_)}},{"./$":129,"./$.def":107,"./$.has":115,"./$.hide":116,"./$.iter-create":124,"./$.iterators":128,"./$.library":131,"./$.redef":136,"./$.tag":145,"./$.wks":153}],126:[function(e,t,i){var n=e("./$.wks")("iterator"),a=!1;try{var r=[7][n]();r["return"]=function(){a=!0},Array.from(r,function(){throw 2})}catch(s){}t.exports=function(e,t){if(!t&&!a)return!1;var i=!1;try{var r=[7],s=r[n]();s.next=function(){i=!0},r[n]=function(){return s},e(r)}catch(o){}return i}},{"./$.wks":153}],127:[function(e,t,i){t.exports=function(e,t){return{value:t,done:!!e}}},{}],128:[function(e,t,i){t.exports={}},{}],129:[function(e,t,i){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],130:[function(e,t,i){var n=e("./$"),a=e("./$.to-iobject");t.exports=function(e,t){for(var i,r=a(e),s=n.getKeys(r),o=s.length,l=0;o>l;)if(r[i=s[l++]]===t)return i}},{"./$":129,"./$.to-iobject":148}],131:[function(e,t,i){t.exports=!0},{}],132:[function(e,t,i){var n,a,r,s=e("./$.global"),o=e("./$.task").set,l=s.MutationObserver||s.WebKitMutationObserver,h=s.process,u="process"==e("./$.cof")(h),c=function(){var e,t;for(u&&(e=h.domain)&&(h.domain=null,e.exit());n;)t=n.domain,t&&t.enter(),n.fn.call(),t&&t.exit(),n=n.next;a=void 0,e&&e.enter()};if(u)r=function(){h.nextTick(c)};else if(l){var d=1,f=document.createTextNode("");new l(c).observe(f,{characterData:!0}),r=function(){f.data=d=-d}}else r=function(){o.call(s,c)};t.exports=function(e){var t={fn:e,next:void 0,domain:u&&h.domain};a&&(a.next=t),n||(n=t,r()),a=t}},{"./$.cof":101,"./$.global":114,"./$.task":146}],133:[function(e,t,i){var n=e("./$.redef");t.exports=function(e,t){for(var i in t)n(e,i,t[i]);return e}},{"./$.redef":136}],134:[function(e,t,i){t.exports=function(t,i){var n=e("./$.def"),a=(e("./$.core").Object||{})[t]||Object[t],r={};r[t]=i(a),n(n.S+n.F*e("./$.fails")(function(){a(1)}),"Object",r)}},{"./$.core":105,"./$.def":107,"./$.fails":111}],135:[function(e,t,i){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],136:[function(e,t,i){t.exports=e("./$.hide")},{"./$.hide":116}],137:[function(e,t,i){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},{}],138:[function(e,t,i){var n=e("./$").getDesc,a=e("./$.is-object"),r=e("./$.an-object"),s=function(e,t){if(r(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,i,a){try{a=e("./$.ctx")(Function.call,n(Object.prototype,"__proto__").set,2),a(t,[]),i=!(t instanceof Array)}catch(r){i=!0}return function(e,t){return s(e,t),i?e.__proto__=t:a(e,t),e}}({},!1):void 0),check:s}},{"./$":129,"./$.an-object":98,"./$.ctx":106,"./$.is-object":122}],139:[function(e,t,i){var n=e("./$.global"),a="__core-js_shared__",r=n[a]||(n[a]={});t.exports=function(e){return r[e]||(r[e]={})}},{"./$.global":114}],140:[function(e,t,i){var n=e("./$.an-object"),a=e("./$.a-function"),r=e("./$.wks")("species");t.exports=function(e,t){var i,s=n(e).constructor;return void 0===s||void 0==(i=n(s)[r])?t:a(i)}},{"./$.a-function":97,"./$.an-object":98,"./$.wks":153}],141:[function(e,t,i){"use strict";var n=e("./$"),a=e("./$.wks")("species");t.exports=function(t){!e("./$.support-desc")||a in t||n.setDesc(t,a,{configurable:!0,get:function(){return this}})}},{"./$":129,"./$.support-desc":144,"./$.wks":153}],142:[function(e,t,i){t.exports=function(e,t,i){if(!(e instanceof t))throw TypeError(i+": use the 'new' operator!");return e}},{}],143:[function(e,t,i){var n=e("./$.to-integer"),a=e("./$.defined");t.exports=function(e){return function(t,i){var r,s,o=String(a(t)),l=n(i),h=o.length;return 0>l||l>=h?e?"":void 0:(r=o.charCodeAt(l),55296>r||r>56319||l+1===h||(s=o.charCodeAt(l+1))<56320||s>57343?e?o.charAt(l):r:e?o.slice(l,l+2):(r-55296<<10)+(s-56320)+65536)}}},{"./$.defined":108,"./$.to-integer":147}],144:[function(e,t,i){t.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":111}],145:[function(e,t,i){var n=e("./$").setDesc,a=e("./$.has"),r=e("./$.wks")("toStringTag");t.exports=function(e,t,i){e&&!a(e=i?e:e.prototype,r)&&n(e,r,{configurable:!0,value:t})}},{"./$":129,"./$.has":115,"./$.wks":153}],146:[function(e,t,i){"use strict";var n,a,r,s=e("./$.ctx"),o=e("./$.invoke"),l=e("./$.html"),h=e("./$.dom-create"),u=e("./$.global"),c=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,v=0,m={},g="onreadystatechange",b=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},y=function(e){b.call(e.data)};d&&f||(d=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return m[++v]=function(){o("function"==typeof e?e:Function(e),t)},n(v),v},f=function(e){delete m[e]},"process"==e("./$.cof")(c)?n=function(e){c.nextTick(s(b,e,1))}:p?(a=new p,r=a.port2,a.port1.onmessage=y,n=s(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(n=function(e){u.postMessage(e+"","*")},u.addEventListener("message",y,!1)):n=g in h("script")?function(e){l.appendChild(h("script"))[g]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),t.exports={set:d,clear:f}},{"./$.cof":101,"./$.ctx":106,"./$.dom-create":109,"./$.global":114,"./$.html":117,"./$.invoke":118}],147:[function(e,t,i){var n=Math.ceil,a=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?a:n)(e)}},{}],148:[function(e,t,i){var n=e("./$.iobject"),a=e("./$.defined");t.exports=function(e){return n(a(e))}},{"./$.defined":108,"./$.iobject":119}],149:[function(e,t,i){var n=e("./$.to-integer"),a=Math.min;t.exports=function(e){return e>0?a(n(e),9007199254740991):0}},{"./$.to-integer":147}],150:[function(e,t,i){var n=e("./$.defined");t.exports=function(e){return Object(n(e))}},{"./$.defined":108}],151:[function(e,t,i){var n=0,a=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+a).toString(36))}},{}],152:[function(e,t,i){t.exports=function(){}},{}],153:[function(e,t,i){var n=e("./$.shared")("wks"),a=e("./$.global").Symbol;t.exports=function(t){return n[t]||(n[t]=a&&a[t]||(a||e("./$.uid"))("Symbol."+t))}},{"./$.global":114,"./$.shared":139,"./$.uid":151}],154:[function(e,t,i){var n=e("./$.classof"),a=e("./$.wks")("iterator"),r=e("./$.iterators");t.exports=e("./$.core").getIteratorMethod=function(e){return void 0!=e?e[a]||e["@@iterator"]||r[n(e)]:void 0}},{"./$.classof":100,"./$.core":105,"./$.iterators":128,"./$.wks":153}],155:[function(e,t,i){var n=e("./$.an-object"),a=e("./core.get-iterator-method");t.exports=e("./$.core").getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},{"./$.an-object":98,"./$.core":105,"./core.get-iterator-method":154}],156:[function(e,t,i){"use strict";var n=e("./$.unscope"),a=e("./$.iter-step"),r=e("./$.iterators"),s=e("./$.to-iobject");e("./$.iter-define")(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,i=this._i++;return!e||i>=e.length?(this._t=void 0,a(1)):"keys"==t?a(0,i):"values"==t?a(0,e[i]):a(0,[i,e[i]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},{"./$.iter-define":125,"./$.iter-step":127,"./$.iterators":128,"./$.to-iobject":148,"./$.unscope":152}],157:[function(e,t,i){"use strict";var n=e("./$.collection-strong");e("./$.collection")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(this,e);return t&&t.v},set:function(e,t){return n.def(this,0===e?0:e,t)}},n,!0)},{"./$.collection":104,"./$.collection-strong":102}],158:[function(e,t,i){var n=e("./$.def");n(n.S+n.F,"Object",{assign:e("./$.assign")})},{"./$.assign":99,"./$.def":107}],159:[function(e,t,i){var n=e("./$.to-iobject");e("./$.object-sap")("getOwnPropertyDescriptor",function(e){return function(t,i){return e(n(t),i)}})},{"./$.object-sap":134,"./$.to-iobject":148}],160:[function(e,t,i){var n=e("./$.to-object");e("./$.object-sap")("keys",function(e){return function(t){return e(n(t))}})},{"./$.object-sap":134,"./$.to-object":150}],161:[function(e,t,i){var n=e("./$.def");n(n.S,"Object",{setPrototypeOf:e("./$.set-proto").set})},{"./$.def":107,"./$.set-proto":138}],162:[function(e,t,i){},{}],163:[function(e,t,i){"use strict";var n,a=e("./$"),r=e("./$.library"),s=e("./$.global"),o=e("./$.ctx"),l=e("./$.classof"),h=e("./$.def"),u=e("./$.is-object"),c=e("./$.an-object"),d=e("./$.a-function"),f=e("./$.strict-new"),p=e("./$.for-of"),v=e("./$.set-proto").set,m=e("./$.same"),g=e("./$.species"),b=e("./$.wks")("species"),y=e("./$.species-constructor"),_=e("./$.uid")("record"),x=e("./$.microtask"),k="Promise",w=s.process,S="process"==l(w),C=s[k],P=function(e){var t=new C(function(){});return e&&(t.constructor=Object),C.resolve(t)===t},T=function(){function t(e){var i=new C(e);return v(i,t.prototype),i}var i=!1;try{if(i=C&&C.resolve&&P(),v(t,C),t.prototype=a.create(C.prototype,{constructor:{value:t}}),t.resolve(5).then(function(){})instanceof t||(i=!1),i&&e("./$.support-desc")){var n=!1;C.resolve(a.setDesc({},"then",{get:function(){n=!0}})),i=n}}catch(r){i=!1}return i}(),$=function(e){return u(e)&&(T?"Promise"==l(e):_ in e)},K=function(e,t){return r&&e===C&&t===n?!0:m(e,t)},M=function(e){var t=c(e)[b];return void 0!=t?t:e},L=function(e){var t;return u(e)&&"function"==typeof(t=e.then)?t:!1},D=function(e,t){if(!e.n){e.n=!0;var i=e.c;x(function(){for(var n=e.v,a=1==e.s,r=0,o=function(t){var i,r,s=a?t.ok:t.fail;try{s?(a||(e.h=!0),i=s===!0?n:s(n),i===t.P?t.rej(TypeError("Promise-chain cycle")):(r=L(i))?r.call(i,t.res,t.rej):t.res(i)):t.rej(n)}catch(o){t.rej(o)}};i.length>r;)o(i[r++]);i.length=0,e.n=!1,t&&setTimeout(function(){var t,i,a=e.p;F(a)&&(S?w.emit("unhandledRejection",n,a):(t=s.onunhandledrejection)?t({promise:a,reason:n}):(i=s.console)&&i.error&&i.error("Unhandled promise rejection",n)),e.a=void 0},1)})}},F=function(e){var t,i=e[_],n=i.a||i.c,a=0;if(i.h)return!1;for(;n.length>a;)if(t=n[a++],t.fail||!F(t.P))return!1;return!0},O=function(e){var t=this;t.d||(t.d=!0,t=t.r||t,t.v=e,t.s=2,t.a=t.c.slice(),D(t,!0))},j=function(e){var t,i=this;if(!i.d){i.d=!0,i=i.r||i;try{(t=L(e))?x(function(){var n={r:i,d:!1};try{t.call(e,o(j,n,1),o(O,n,1))}catch(a){O.call(n,a)}}):(i.v=e,i.s=1,D(i,!1))}catch(n){O.call({r:i,d:!1},n)}}};T||(C=function(e){d(e);var t={p:f(this,C,k),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};this[_]=t;try{e(o(j,t,1),o(O,t,1))}catch(i){O.call(t,i)}},e("./$.mix")(C.prototype,{then:function(e,t){var i={ok:"function"==typeof e?e:!0,fail:"function"==typeof t?t:!1},n=i.P=new(y(this,C))(function(e,t){i.res=e,i.rej=t});d(i.res),d(i.rej);var a=this[_];return a.c.push(i),a.a&&a.a.push(i),a.s&&D(a,!1),n},"catch":function(e){return this.then(void 0,e)}})),h(h.G+h.W+h.F*!T,{Promise:C}),e("./$.tag")(C,k),g(C),g(n=e("./$.core")[k]),h(h.S+h.F*!T,k,{reject:function(e){return new this(function(t,i){i(e)})}}),h(h.S+h.F*(!T||P(!0)),k,{resolve:function(e){return $(e)&&K(e.constructor,this)?e:new this(function(t){t(e)})}}),h(h.S+h.F*!(T&&e("./$.iter-detect")(function(e){C.all(e)["catch"](function(){})})),k,{all:function(e){var t=M(this),i=[];return new t(function(n,r){p(e,!1,i.push,i);var s=i.length,o=Array(s);s?a.each.call(i,function(e,i){t.resolve(e).then(function(e){o[i]=e,--s||n(o)},r)}):n(o)})},race:function(e){var t=M(this);return new t(function(i,n){p(e,!1,function(e){t.resolve(e).then(i,n)})})}})},{"./$":129,"./$.a-function":97,"./$.an-object":98,"./$.classof":100,"./$.core":105,"./$.ctx":106,"./$.def":107,"./$.for-of":112,"./$.global":114,"./$.is-object":122,"./$.iter-detect":126,"./$.library":131,"./$.microtask":132,"./$.mix":133,"./$.same":137,"./$.set-proto":138,"./$.species":141,"./$.species-constructor":140,"./$.strict-new":142,"./$.support-desc":144,"./$.tag":145,"./$.uid":151,"./$.wks":153}],164:[function(e,t,i){"use strict";var n=e("./$.collection-strong");e("./$.collection")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(this,e=0===e?0:e,e)}},n)},{"./$.collection":104,"./$.collection-strong":102}],165:[function(e,t,i){"use strict";var n=e("./$.string-at")(!0);e("./$.iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,i=this._i;return i>=t.length?{value:void 0,done:!0}:(e=n(t,i),this._i+=e.length,{value:e,done:!1})})},{"./$.iter-define":125,"./$.string-at":143}],166:[function(e,t,i){"use strict";var n=e("./$"),a=e("./$.global"),r=e("./$.has"),s=e("./$.support-desc"),o=e("./$.def"),l=e("./$.redef"),h=e("./$.fails"),u=e("./$.shared"),c=e("./$.tag"),d=e("./$.uid"),f=e("./$.wks"),p=e("./$.keyof"),v=e("./$.get-names"),m=e("./$.enum-keys"),g=e("./$.is-array"),b=e("./$.an-object"),y=e("./$.to-iobject"),_=e("./$.property-desc"),x=n.getDesc,k=n.setDesc,w=n.create,S=v.get,C=a.Symbol,P=a.JSON,T=P&&P.stringify,$=!1,K=f("_hidden"),M=n.isEnum,L=u("symbol-registry"),D=u("symbols"),F="function"==typeof C,O=Object.prototype,j=s&&h(function(){return 7!=w(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a})?function(e,t,i){var n=x(O,t);n&&delete O[t],k(e,t,i),n&&e!==O&&k(O,t,n)}:k,E=function(e){var t=D[e]=w(C.prototype);return t._k=e,s&&$&&j(O,e,{configurable:!0,set:function(t){r(this,K)&&r(this[K],e)&&(this[K][e]=!1),j(this,e,_(1,t))}}),t},A=function(e){return"symbol"==typeof e},R=function(e,t,i){return i&&r(D,t)?(i.enumerable?(r(e,K)&&e[K][t]&&(e[K][t]=!1),i=w(i,{enumerable:_(0,!1)})):(r(e,K)||k(e,K,_(1,{})),e[K][t]=!0),j(e,t,i)):k(e,t,i)},G=function(e,t){b(e);for(var i,n=m(t=y(t)),a=0,r=n.length;r>a;)R(e,i=n[a++],t[i]);return e},N=function(e,t){return void 0===t?w(e):G(w(e),t)},I=function(e){var t=M.call(this,e);return t||!r(this,e)||!r(D,e)||r(this,K)&&this[K][e]?t:!0},B=function(e,t){var i=x(e=y(e),t);return!i||!r(D,t)||r(e,K)&&e[K][t]||(i.enumerable=!0),i},U=function(e){for(var t,i=S(y(e)),n=[],a=0;i.length>a;)r(D,t=i[a++])||t==K||n.push(t);return n},H=function(e){for(var t,i=S(y(e)),n=[],a=0;i.length>a;)r(D,t=i[a++])&&n.push(D[t]);return n},q=function(e){for(var t,i,n=[e],a=1,r=arguments;r.length>a;)n.push(r[a++]);return t=n[1],"function"==typeof t&&(i=t),(i||!g(t))&&(t=function(e,t){return i&&(t=i.call(this,e,t)),A(t)?void 0:t}),n[1]=t,T.apply(P,n)},W=h(function(){var e=C();return"[null]"!=T([e])||"{}"!=T({a:e})||"{}"!=T(Object(e))});F||(C=function(){if(A(this))throw TypeError("Symbol is not a constructor");return E(d(arguments.length>0?arguments[0]:void 0))},l(C.prototype,"toString",function(){return this._k}),A=function(e){return e instanceof C},n.create=N,n.isEnum=I,n.getDesc=B,n.setDesc=R,n.setDescs=G,n.getNames=v.get=U,n.getSymbols=H,s&&!e("./$.library")&&l(O,"propertyIsEnumerable",I,!0));var z={"for":function(e){return r(L,e+="")?L[e]:L[e]=C(e)},keyFor:function(e){return p(L,e)},useSetter:function(){$=!0},useSimple:function(){$=!1}};n.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=f(e);z[e]=F?t:E(t)}),$=!0,o(o.G+o.W,{Symbol:C}),o(o.S,"Symbol",z),o(o.S+o.F*!F,"Object",{create:N,defineProperty:R,defineProperties:G,getOwnPropertyDescriptor:B,getOwnPropertyNames:U,getOwnPropertySymbols:H}),P&&o(o.S+o.F*(!F||W),"JSON",{stringify:q}),c(C,"Symbol"),c(Math,"Math",!0),c(a.JSON,"JSON",!0)},{"./$":129,"./$.an-object":98,"./$.def":107,"./$.enum-keys":110,"./$.fails":111,"./$.get-names":113,"./$.global":114,"./$.has":115,"./$.is-array":121,"./$.keyof":130,"./$.library":131,"./$.property-desc":135,"./$.redef":136,"./$.shared":139,"./$.support-desc":144,"./$.tag":145,"./$.to-iobject":148,"./$.uid":151,"./$.wks":153}],167:[function(e,t,i){var n=e("./$.def");n(n.P,"Map",{toJSON:e("./$.collection-to-json")("Map")})},{"./$.collection-to-json":103,"./$.def":107}],168:[function(e,t,i){var n=e("./$.def");n(n.P,"Set",{toJSON:e("./$.collection-to-json")("Set")})},{"./$.collection-to-json":103,"./$.def":107}],169:[function(e,t,i){e("./es6.array.iterator");var n=e("./$.iterators");n.NodeList=n.HTMLCollection=n.Array},{"./$.iterators":128,"./es6.array.iterator":156}],170:[function(e,t,i){(function(i){var n="object"==typeof i?i:"object"==typeof window?window:"object"==typeof self?self:this,a=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,r=a&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=e("./runtime"),a)n.regeneratorRuntime=r;else try{delete n.regeneratorRuntime}catch(s){n.regeneratorRuntime=void 0}t.exports={"default":t.exports,__esModule:!0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./runtime":171}],171:[function(e,t,i){(function(i,n){"use strict";var a=e("babel-runtime/core-js/symbol")["default"],r=e("babel-runtime/core-js/symbol/iterator")["default"],s=e("babel-runtime/core-js/object/create")["default"],o=e("babel-runtime/core-js/promise")["default"];!function(e){function n(e,t,i,n){var a=s((t||h).prototype);return a._invoke=v(e,i||null,new b(n||[])),a}function l(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(n){return{type:"throw",arg:n}}}function h(){}function u(){}function c(){}function d(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function f(e){this.arg=e}function p(e){function t(t,i){var n=e[t](i),a=n.value;return a instanceof f?o.resolve(a.arg).then(r,s):o.resolve(a).then(function(e){return n.value=e,n})}function n(e,i){var n=a?a.then(function(){return t(e,i)}):new o(function(n){n(t(e,i))});return a=n["catch"](function(e){}),n}"object"==typeof i&&i.domain&&(t=i.domain.bind(t));var a,r=t.bind(e,"next"),s=t.bind(e,"throw");t.bind(e,"return");this._invoke=n}function v(e,t,i){var n=P;return function(a,r){if(n===$)throw new Error("Generator is already running");if(n===K){if("throw"===a)throw r;return _()}for(;;){var s=i.delegate;if(s){if("return"===a||"throw"===a&&s.iterator[a]===x){i.delegate=null;var o=s.iterator["return"];if(o){var h=l(o,s.iterator,r);if("throw"===h.type){a="throw",r=h.arg;continue}}if("return"===a)continue}var h=l(s.iterator[a],s.iterator,r);if("throw"===h.type){i.delegate=null,a="throw",r=h.arg;continue}a="next",r=x;var u=h.arg;if(!u.done)return n=T,u;i[s.resultName]=u.value,i.next=s.nextLoc,i.delegate=null}if("next"===a)n===T?i.sent=r:i.sent=x;else if("throw"===a){if(n===P)throw n=K,r;i.dispatchException(r)&&(a="next",r=x)}else"return"===a&&i.abrupt("return",r);n=$;var h=l(e,t,i);if("normal"===h.type){n=i.done?K:T;var u={value:h.arg,done:i.done};if(h.arg!==M)return u;i.delegate&&"next"===a&&(r=x)}else"throw"===h.type&&(n=K,a="throw",r=h.arg)}}}function m(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function g(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(m,this),this.reset(!0)}function y(e){if(e){var t=e[w];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function a(){for(;++i<e.length;)if(k.call(e,i))return a.value=e[i],a.done=!1,a;return a.value=x,a.done=!0,a};return n.next=n}}return{next:_}}function _(){return{value:x,done:!0}}var x,k=Object.prototype.hasOwnProperty,w="function"==typeof a&&r||"@@iterator",S="object"==typeof t,C=e.regeneratorRuntime;if(C)return void(S&&(t.exports=C));C=e.regeneratorRuntime=S?t.exports:{},C.wrap=n;var P="suspendedStart",T="suspendedYield",$="executing",K="completed",M={},L=c.prototype=h.prototype;u.prototype=L.constructor=c,c.constructor=u,u.displayName="GeneratorFunction",C.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===u||"GeneratorFunction"===(t.displayName||t.name):!1},C.mark=function(e){return e.__proto__=c,e.prototype=s(L),e},C.awrap=function(e){return new f(e)},d(p.prototype),C.async=function(e,t,i,a){var r=new p(n(e,t,i,a));return C.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},d(L),L[w]=function(){return this},L.toString=function(){return"[object Generator]"},C.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},C.values=y,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=x,this.done=!1,this.delegate=null,this.tryEntries.forEach(g),!e)for(var t in this)"t"===t.charAt(0)&&k.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=x)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return r.type="throw",r.arg=e,i.next=t,!!n}if(this.done)throw e;for(var i=this,n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],r=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var s=k.call(a,"catchLoc"),o=k.call(a,"finallyLoc");if(s&&o){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return t(a.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&k.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=e,r.arg=t,a?this.next=a.finallyLoc:this.complete(r),M},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),g(i),M}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var a=n.arg;g(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:y(e),resultName:t,nextLoc:i},M}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:void 0)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:175,"babel-runtime/core-js/object/create":71,"babel-runtime/core-js/promise":76,"babel-runtime/core-js/symbol":78,"babel-runtime/core-js/symbol/iterator":79}],172:[function(t,i,n){!function(){"use strict";var a=Math.PI/180,r={version:"0.11.1",stages:[],idCounter:0,ids:{},names:{},shapes:{},listenClickTap:!1,inDblClickWindow:!1,enableTrace:!1,traceArrMax:100,dblClickWindow:400,pixelRatio:void 0,dragDistance:0,angleDeg:!0,showWarnings:!0,Filters:{},isDragging:function(){var e=r.DD;return e?e.isDragging:!1},isDragReady:function(){var e=r.DD;return e?!!e.node:!1},_addId:function(e,t){void 0!==t&&(this.ids[t]=e)},_removeId:function(e){void 0!==e&&delete this.ids[e]},_addName:function(e,t){t&&(this.names[t]||(this.names[t]=[]),this.names[t].push(e))},_removeName:function(e,t){if(e){var i=this.names[e];if(i){for(var n=0;n<i.length;n++){var a=i[n];a._id===t&&i.splice(n,1)}0===i.length&&delete this.names[e]}}},getAngle:function(e){return this.angleDeg?e*a:e},_parseUA:function(e){var t=e.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],n=!!e.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),a=!!e.match(/IEMobile/i);return{browser:i[1]||"",version:i[2]||"0",mobile:n,ieMobile:a}},UA:void 0},s="undefined"!=typeof window?window:"undefined"!=typeof s?s:"undefined"!=typeof WorkerGlobalScope?self:{};if(r.UA=r._parseUA(s.navigator&&s.navigator.userAgent||""),s.Konva&&console.error("Konva instance is already exist in current eviroment. Please use only one instance."),s.Konva=r,r.global=s,"object"==typeof n){if(s.window&&s.window.document)r.document=s.window.document,r.window=s.window;else{var o=t("canvas"),l=t("jsdom").jsdom;r.document=l("<!DOCTYPE html><html><head></head><body></body></html>"),r.window=r.document.parentWindow,r.window.Image=o.Image,r._nodeCanvas=o}return void(i.exports=r)}"function"==typeof e&&e.amd&&e(function(){return r}),r.document=document,r.window=window}(),function(){"use strict";Konva.Collection=function(){var e=[].slice.call(arguments),t=e.length,i=0;for(this.length=t;t>i;i++)this[i]=e[i];return this},Konva.Collection.prototype=[],Konva.Collection.prototype.each=function(e){for(var t=0;t<this.length;t++)e(this[t],t)},Konva.Collection.prototype.toArray=function(){var e,t=[],i=this.length;for(e=0;i>e;e++)t.push(this[e]);return t},Konva.Collection.toCollection=function(e){var t,i=new Konva.Collection,n=e.length;for(t=0;n>t;t++)i.push(e[t]);return i},Konva.Collection._mapMethod=function(e){Konva.Collection.prototype[e]=function(){var t,i=this.length,n=[].slice.call(arguments);for(t=0;i>t;t++)this[t][e].apply(this[t],n);return this}},Konva.Collection.mapMethods=function(e){var t=e.prototype;for(var i in t)Konva.Collection._mapMethod(i)},Konva.Transform=function(e){this.m=e&&e.slice()||[1,0,0,1,0,0]},Konva.Transform.prototype={copy:function(){return new Konva.Transform(this.m)},point:function(e){var t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}},translate:function(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this},scale:function(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.m[0]*t+this.m[2]*i,a=this.m[1]*t+this.m[3]*i,r=this.m[0]*-i+this.m[2]*t,s=this.m[1]*-i+this.m[3]*t;return this.m[0]=n,this.m[1]=a,this.m[2]=r,this.m[3]=s,this},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},skew:function(e,t){var i=this.m[0]+this.m[2]*t,n=this.m[1]+this.m[3]*t,a=this.m[2]+this.m[0]*e,r=this.m[3]+this.m[1]*e;return this.m[0]=i,this.m[1]=n,this.m[2]=a,this.m[3]=r,this},multiply:function(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],i=this.m[1]*e.m[0]+this.m[3]*e.m[1],n=this.m[0]*e.m[2]+this.m[2]*e.m[3],a=this.m[1]*e.m[2]+this.m[3]*e.m[3],r=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],s=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=i,this.m[2]=n,this.m[3]=a,this.m[4]=r,this.m[5]=s,this},invert:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,i=-this.m[1]*e,n=-this.m[2]*e,a=this.m[0]*e,r=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),s=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=i,this.m[2]=n,this.m[3]=a,this.m[4]=r,this.m[5]=s,this},getMatrix:function(){return this.m},setAbsolutePosition:function(e,t){var i=this.m[0],n=this.m[1],a=this.m[2],r=this.m[3],s=this.m[4],o=this.m[5],l=(i*(t-o)-n*(e-s))/(i*r-n*a),h=(e-s-a*l)/i;return this.translate(h,l)}};var e="2d",t="[object Array]",i="[object Number]",a="[object String]",r=Math.PI/180,s=180/Math.PI,o="#",l="",h="0",u="Konva warning: ",c="Konva error: ",d="rgb(",f={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],
lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},p=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;Konva.Util={_isElement:function(e){return!(!e||1!=e.nodeType)},_isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isObject:function(e){return!!e&&e.constructor===Object},_isArray:function(e){return Object.prototype.toString.call(e)===t},_isNumber:function(e){return Object.prototype.toString.call(e)===i},_isString:function(e){return Object.prototype.toString.call(e)===a},_throttle:function(e,t,i){var n,a,r,s=null,o=0,l=i||{},h=function(){o=l.leading===!1?0:(new Date).getTime(),s=null,r=e.apply(n,a),n=a=null};return function(){var i=(new Date).getTime();o||l.leading!==!1||(o=i);var u=t-(i-o);return n=this,a=arguments,0>=u?(clearTimeout(s),s=null,o=i,r=e.apply(n,a),n=a=null):s||l.trailing===!1||(s=setTimeout(h,u)),r}},_hasMethods:function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&this._isFunction(e[t])&&i.push(t);return i.length>0},isValidSelector:function(e){if("string"!=typeof e)return!1;var t=e[0];return"#"===t||"."===t||t===t.toUpperCase()},createCanvasElement:function(){var e=Konva.document.createElement("canvas");try{e.style=e.style||{}}catch(t){}return e},isBrowser:function(){return"object"!=typeof n},_isInDocument:function(e){for(;e=e.parentNode;)if(e==Konva.document)return!0;return!1},_simplifyArray:function(e){var t,i,n=[],a=e.length,r=Konva.Util;for(t=0;a>t;t++)i=e[t],r._isNumber(i)?i=Math.round(1e3*i)/1e3:r._isString(i)||(i=i.toString()),n.push(i);return n},_getImage:function(t,i){var n,a;if(t)if(this._isElement(t))i(t);else if(this._isString(t))n=new Konva.window.Image,n.onload=function(){i(n)},n.src=t;else if(t.data){a=Konva.Util.createCanvasElement(),a.width=t.width,a.height=t.height;var r=a.getContext(e);r.putImageData(t,0,0),this._getImage(a.toDataURL(),i)}else i(null);else i(null)},_getRGBAString:function(e){var t=e.red||0,i=e.green||0,n=e.blue||0,a=e.alpha||1;return["rgba(",t,",",i,",",n,",",a,")"].join(l)},_rgbToHex:function(e,t,i){return((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},_hexToRgb:function(e){e=e.replace(o,l);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},getRandomColor:function(){for(var e=(16777215*Math.random()<<0).toString(16);e.length<6;)e=h+e;return o+e},get:function(e,t){return void 0===e?t:e},getRGB:function(e){var t;return e in f?(t=f[e],{r:t[0],g:t[1],b:t[2]}):e[0]===o?this._hexToRgb(e.substring(1)):e.substr(0,4)===d?(t=p.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(e){return e=e||"black",Konva.Util._namedColorToRBA(e)||Konva.Util._hex3ColorToRGBA(e)||Konva.Util._hex6ColorToRGBA(e)||Konva.Util._rgbColorToRGBA(e)||Konva.Util._rgbaColorToRGBA(e)},_namedColorToRBA:function(e){var t=f[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA:function(e){if(0===e.indexOf("rgb(")){e=e.match(/rgb\(([^)]+)\)/)[1];var t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA:function(e){if(0===e.indexOf("rgba(")){e=e.match(/rgba\(([^)]+)\)/)[1];var t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex6ColorToRGBA:function(e){return"#"===e[0]&&7===e.length?{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}:void 0},_hex3ColorToRGBA:function(e){return"#"===e[0]&&4===e.length?{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}:void 0},_merge:function(e,t){var i=this._clone(t);for(var n in e)this._isObject(e[n])?i[n]=this._merge(e[n],i[n]):i[n]=e[n];return i},cloneObject:function(e){var t={};for(var i in e)this._isObject(e[i])?t[i]=this.cloneObject(e[i]):this._isArray(e[i])?t[i]=this.cloneArray(e[i]):t[i]=e[i];return t},cloneArray:function(e){return e.slice(0)},_degToRad:function(e){return e*r},_radToDeg:function(e){return e*s},_capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},"throw":function(e){throw new Error(c+e)},error:function(e){console.error(c+e)},warn:function(e){Konva.global.console&&console.warn&&Konva.showWarnings&&console.warn(u+e)},extend:function(e,t){function i(){this.constructor=e}i.prototype=t.prototype;var n=e.prototype;e.prototype=new i;for(var a in n)n.hasOwnProperty(a)&&(e.prototype[a]=n[a]);e.__super__=t.prototype,e["super"]=t},addMethods:function(e,t){var i;for(i in t)e.prototype[i]=t[i]},_getControlPoints:function(e,t,i,n,a,r,s){var o=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(a-i,2)+Math.pow(r-n,2)),h=s*o/(o+l),u=s*l/(o+l),c=i-h*(a-e),d=n-h*(r-t),f=i+u*(a-e),p=n+u*(r-t);return[c,d,f,p]},_expandPoints:function(e,t){var i,n,a=e.length,r=[];for(i=2;a-2>i;i+=2)n=Konva.Util._getControlPoints(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t),r.push(n[0]),r.push(n[1]),r.push(e[i]),r.push(e[i+1]),r.push(n[2]),r.push(n[3]);return r},_removeLastLetter:function(e){return e.substring(0,e.length-1)},each:function(e,t){for(var i in e)t(i,e[i])},_getProjectionToSegment:function(e,t,i,n,a,r){var s,o,l,h=(e-i)*(e-i)+(t-n)*(t-n);if(0==h)s=e,o=t,l=(a-i)*(a-i)+(r-n)*(r-n);else{var u=((a-e)*(i-e)+(r-t)*(n-t))/h;0>u?(s=e,o=t,l=(e-a)*(e-a)+(t-r)*(t-r)):u>1?(s=i,o=n,l=(i-a)*(i-a)+(n-r)*(n-r)):(s=e+u*(i-e),o=t+u*(n-t),l=(s-a)*(s-a)+(o-r)*(o-r))}return[s,o,l]},_getProjectionToLine:function(e,t,i){var n=Konva.Util.cloneObject(e),a=Number.MAX_VALUE;return t.forEach(function(r,s){if(i||s!==t.length-1){var o=t[(s+1)%t.length],l=Konva.Util._getProjectionToSegment(r.x,r.y,o.x,o.y,e.x,e.y),h=l[0],u=l[1],c=l[2];a>c&&(n.x=h,n.y=u,a=c)}}),n},_prepareArrayForTween:function(e,t,i){var n,a=[],r=[];if(e.length>t.length){var s=t;t=e,e=s}for(n=0;n<e.length;n+=2)a.push({x:e[n],y:e[n+1]});for(n=0;n<t.length;n+=2)r.push({x:t[n],y:t[n+1]});var o=[];return r.forEach(function(e){var t=Konva.Util._getProjectionToLine(e,a,i);o.push(t.x),o.push(t.y)}),o}}}(),function(){"use strict";var e=Konva.Util.createCanvasElement(),t=e.getContext("2d"),i=function(){var e=Konva.window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i}();Konva.Canvas=function(e){this.init(e)},Konva.Canvas.prototype={init:function(e){var t=e||{},n=t.pixelRatio||Konva.pixelRatio||i;this.pixelRatio=n,this._canvas=Konva.Util.createCanvasElement(),this._canvas.style.padding=0,this._canvas.style.margin=0,this._canvas.style.border=0,this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top=0,this._canvas.style.left=0},getContext:function(){return this.context},getPixelRatio:function(){return this.pixelRatio},setPixelRatio:function(e){var t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)},setWidth:function(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var t=this.pixelRatio,i=this.getContext()._context;i.scale(t,t)},setHeight:function(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var t=this.pixelRatio,i=this.getContext()._context;i.scale(t,t)},getWidth:function(){return this.width},getHeight:function(){return this.height},setSize:function(e,t){this.setWidth(e),this.setHeight(t)},toDataURL:function(e,t){try{return this._canvas.toDataURL(e,t)}catch(i){try{return this._canvas.toDataURL()}catch(n){return Konva.Util.warn("Unable to get data URL. "+n.message),""}}}},Konva.SceneCanvas=function(e){var t=e||{},i=t.width||0,n=t.height||0;Konva.Canvas.call(this,t),this.context=new Konva.SceneContext(this),this.setSize(i,n)},Konva.Util.extend(Konva.SceneCanvas,Konva.Canvas),Konva.HitCanvas=function(e){var t=e||{},i=t.width||0,n=t.height||0;Konva.Canvas.call(this,t),this.context=new Konva.HitContext(this),this.setSize(i,n),this.hitCanvas=!0},Konva.Util.extend(Konva.HitCanvas,Konva.Canvas)}(),function(){"use strict";var e=",",t="(",i=")",n="([",a="])",r=";",s="()",o="=",l=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],h=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation"];Konva.Context=function(e){this.init(e)},Konva.Context.prototype={init:function(e){this.canvas=e,this._context=e._canvas.getContext("2d"),Konva.enableTrace&&(this.traceArr=[],this._enableTrace())},fillShape:function(e){e.getFillEnabled()&&this._fill(e)},strokeShape:function(e){e.getStrokeEnabled()&&this._stroke(e)},fillStrokeShape:function(e){var t=e.getFillEnabled();t&&this._fill(e),e.getStrokeEnabled()&&this._stroke(e)},getTrace:function(l){var h,u,c,d,f=this.traceArr,p=f.length,v="";for(h=0;p>h;h++)u=f[h],c=u.method,c?(d=u.args,v+=c,v+=l?s:Konva.Util._isArray(d[0])?n+d.join(e)+a:t+d.join(e)+i):(v+=u.property,l||(v+=o+u.val)),v+=r;return v},clearTrace:function(){this.traceArr=[]},_trace:function(e){var t,i=this.traceArr;i.push(e),t=i.length,t>=Konva.traceArrMax&&i.shift()},reset:function(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)},getCanvas:function(){return this.canvas},clear:function(e){var t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)},_applyLineCap:function(e){var t=e.getLineCap();t&&this.setAttr("lineCap",t)},_applyOpacity:function(e){var t=e.getAbsoluteOpacity();1!==t&&this.setAttr("globalAlpha",t)},_applyLineJoin:function(e){var t=e.getLineJoin();t&&this.setAttr("lineJoin",t)},setAttr:function(e,t){this._context[e]=t},arc:function(){var e=arguments;this._context.arc(e[0],e[1],e[2],e[3],e[4],e[5])},beginPath:function(){this._context.beginPath()},bezierCurveTo:function(){var e=arguments;this._context.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])},clearRect:function(){var e=arguments;this._context.clearRect(e[0],e[1],e[2],e[3])},clip:function(){this._context.clip()},closePath:function(){this._context.closePath()},createImageData:function(){var e=arguments;return 2===e.length?this._context.createImageData(e[0],e[1]):1===e.length?this._context.createImageData(e[0]):void 0},createLinearGradient:function(){var e=arguments;return this._context.createLinearGradient(e[0],e[1],e[2],e[3])},createPattern:function(){var e=arguments;return this._context.createPattern(e[0],e[1])},createRadialGradient:function(){var e=arguments;return this._context.createRadialGradient(e[0],e[1],e[2],e[3],e[4],e[5])},drawImage:function(){var e=arguments,t=this._context;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},isPointInPath:function(e,t){return this._context.isPointInPath(e,t)},fill:function(){this._context.fill()},fillRect:function(e,t,i,n){this._context.fillRect(e,t,i,n)},strokeRect:function(e,t,i,n){this._context.strokeRect(e,t,i,n)},fillText:function(){var e=arguments;this._context.fillText(e[0],e[1],e[2])},measureText:function(e){return this._context.measureText(e)},getImageData:function(){var e=arguments;return this._context.getImageData(e[0],e[1],e[2],e[3])},lineTo:function(){var e=arguments;this._context.lineTo(e[0],e[1])},moveTo:function(){var e=arguments;this._context.moveTo(e[0],e[1])},rect:function(){var e=arguments;this._context.rect(e[0],e[1],e[2],e[3])},putImageData:function(){var e=arguments;this._context.putImageData(e[0],e[1],e[2])},quadraticCurveTo:function(){var e=arguments;this._context.quadraticCurveTo(e[0],e[1],e[2],e[3])},restore:function(){this._context.restore()},rotate:function(){var e=arguments;this._context.rotate(e[0])},save:function(){this._context.save()},scale:function(){var e=arguments;this._context.scale(e[0],e[1])},setLineDash:function(){var e=arguments,t=this._context;this._context.setLineDash?t.setLineDash(e[0]):"mozDash"in t?t.mozDash=e[0]:"webkitLineDash"in t&&(t.webkitLineDash=e[0])},getLineDash:function(){return this._context.getLineDash()},setTransform:function(){var e=arguments;this._context.setTransform(e[0],e[1],e[2],e[3],e[4],e[5])},stroke:function(){this._context.stroke()},strokeText:function(){var e=arguments;this._context.strokeText(e[0],e[1],e[2])},transform:function(){var e=arguments;this._context.transform(e[0],e[1],e[2],e[3],e[4],e[5])},translate:function(){var e=arguments;this._context.translate(e[0],e[1])},_enableTrace:function(){var e,t,i=this,n=l.length,a=Konva.Util._simplifyArray,r=this.setAttr,s=function(e){var n,r=i[e];i[e]=function(){return t=a(Array.prototype.slice.call(arguments,0)),n=r.apply(i,arguments),"clearRect"===e&&(t[2]=t[2]/i.canvas.getPixelRatio(),t[3]=t[3]/i.canvas.getPixelRatio()),i._trace({method:e,args:t}),n}};for(e=0;n>e;e++)s(l[e]);i.setAttr=function(){r.apply(i,arguments),i._trace({property:arguments[0],val:arguments[1]})}}},h.forEach(function(e){Object.defineProperty(Konva.Context.prototype,e,{get:function(){return this._context[e]},set:function(t){this._context[e]=t}})}),Konva.SceneContext=function(e){Konva.Context.call(this,e)},Konva.SceneContext.prototype={_fillColor:function(e){var t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)},_fillPattern:function(e){var t=e.getFillPatternX(),i=e.getFillPatternY(),n=e.getFillPatternScale(),a=Konva.getAngle(e.getFillPatternRotation()),r=e.getFillPatternOffset();(t||i)&&this.translate(t||0,i||0),a&&this.rotate(a),n&&this.scale(n.x,n.y),r&&this.translate(-1*r.x,-1*r.y),this.setAttr("fillStyle",this.createPattern(e.getFillPatternImage(),e.getFillPatternRepeat()||"repeat")),this.fill()},_fillLinearGradient:function(e){var t=e.getFillLinearGradientStartPoint(),i=e.getFillLinearGradientEndPoint(),n=e.getFillLinearGradientColorStops(),a=this.createLinearGradient(t.x,t.y,i.x,i.y);if(n){for(var r=0;r<n.length;r+=2)a.addColorStop(n[r],n[r+1]);this.setAttr("fillStyle",a),e._fillFunc(this)}},_fillRadialGradient:function(e){for(var t=e.getFillRadialGradientStartPoint(),i=e.getFillRadialGradientEndPoint(),n=e.getFillRadialGradientStartRadius(),a=e.getFillRadialGradientEndRadius(),r=e.getFillRadialGradientColorStops(),s=this.createRadialGradient(t.x,t.y,n,i.x,i.y,a),o=0;o<r.length;o+=2)s.addColorStop(r[o],r[o+1]);this.setAttr("fillStyle",s),this.fill()},_fill:function(e){var t=e.fill(),i=e.getFillPatternImage(),n=e.getFillLinearGradientColorStops(),a=e.getFillRadialGradientColorStops(),r=e.getFillPriority();t&&"color"===r?this._fillColor(e):i&&"pattern"===r?this._fillPattern(e):n&&"linear-gradient"===r?this._fillLinearGradient(e):a&&"radial-gradient"===r?this._fillRadialGradient(e):t?this._fillColor(e):i?this._fillPattern(e):n?this._fillLinearGradient(e):a&&this._fillRadialGradient(e)},_stroke:function(e){var t=e.dash(),i=e.getStrokeScaleEnabled()||e instanceof Konva.Text;e.hasStroke()&&(i||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(e),t&&e.dashEnabled()&&this.setLineDash(t),this.setAttr("lineWidth",e.strokeWidth()),this.setAttr("strokeStyle",e.stroke()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e._strokeFunc(this),i||this.restore())},_applyShadow:function(e){var t=Konva.Util,i=t.get(e.getShadowRGBA(),"black"),n=t.get(e.getShadowBlur(),5),a=t.get(e.getShadowOffset(),{x:0,y:0}),r=e.getAbsoluteTransform().m,s=r[0],o=r[3];this.setAttr("shadowColor",i),this.setAttr("shadowBlur",n),this.setAttr("shadowOffsetX",a.x*s),this.setAttr("shadowOffsetY",a.y*o)}},Konva.Util.extend(Konva.SceneContext,Konva.Context),Konva.HitContext=function(e){Konva.Context.call(this,e)},Konva.HitContext.prototype={_fill:function(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()},_stroke:function(e){if(e.hasStroke()&&e.strokeHitEnabled()){var t=e.getStrokeScaleEnabled()||e instanceof Konva.Text;t||(this.save(),this.setTransform(1,0,0,1,0,0)),this._applyLineCap(e),this.setAttr("lineWidth",e.strokeWidth()),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}},Konva.Util.extend(Konva.HitContext,Konva.Context)}(),function(){"use strict";var e="get",t="set";Konva.Factory={addGetterSetter:function(e,t,i,n,a){this.addGetter(e,t,i),this.addSetter(e,t,n,a),this.addOverloadedGetterSetter(e,t)},addGetter:function(t,i,n){var a=e+Konva.Util._capitalize(i);t.prototype[a]=function(){var e=this.attrs[i];return void 0===e?n:e}},addSetter:function(e,i,n,a){var r=t+Konva.Util._capitalize(i);e.prototype[r]=function(e){return n&&(e=n.call(this,e)),this._setAttr(i,e),a&&a.call(this),this}},addComponentsGetterSetter:function(i,n,a,r,s){var o,l,h=a.length,u=Konva.Util._capitalize,c=e+u(n),d=t+u(n);i.prototype[c]=function(){var e={};for(o=0;h>o;o++)l=a[o],e[l]=this.getAttr(n+u(l));return e},i.prototype[d]=function(e){var t,i=this.attrs[n];r&&(e=r.call(this,e));for(t in e)e.hasOwnProperty(t)&&this._setAttr(n+u(t),e[t]);return this._fireChangeEvent(n,i,e),s&&s.call(this),this},this.addOverloadedGetterSetter(i,n)},addOverloadedGetterSetter:function(i,n){var a=Konva.Util._capitalize(n),r=t+a,s=e+a;i.prototype[n]=function(){return arguments.length?(this[r](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter:function(t,i,n,a){var r=e+Konva.Util._capitalize(i),s=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[r]=function(){Konva.Util.error(s);var e=this.attrs[i];return void 0===e?n:e},this.addSetter(t,i,a,function(){Konva.Util.error(s)}),this.addOverloadedGetterSetter(t,i)},backCompat:function(e,t){Konva.Util.each(t,function(t,i){var n=e.prototype[i];e.prototype[t]=function(){n.apply(this,arguments),Konva.Util.error(t+" method is deprecated and will be removed soon. Use "+i+" instead")}})},afterSetFilter:function(){this._filterUpToDate=!1}},Konva.Validators={RGBComponent:function(e){return e>255?255:0>e?0:Math.round(e)},alphaComponent:function(e){return e>1?1:1e-4>e?1e-4:e}}}(),function(e){"use strict";var t="absoluteOpacity",i="absoluteTransform",n="Change",a="children",r=".",s="",o="get",l="id",h="konva",u="listening",c="mouseenter",d="mouseleave",f="name",p="set",v="Shape",m=" ",g="stage",b="transform",y="Stage",_="visible",x=["id"],k=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(m);e.Node=function(e){this._init(e)},e.Util.addMethods(e.Node,{_init:function(n){var a=this;this._id=e.idCounter++,this.eventListeners={},this.attrs={},this._cache={},this._filterUpToDate=!1,this.setAttrs(n),this.on(k,function(){this._clearCache(b),a._clearSelfAndDescendantCache(i)}),this.on("visibleChange.konva",function(){a._clearSelfAndDescendantCache(_)}),this.on("listeningChange.konva",function(){a._clearSelfAndDescendantCache(u)}),this.on("opacityChange.konva",function(){a._clearSelfAndDescendantCache(t)})},_clearCache:function(e){e?delete this._cache[e]:this._cache={}},_getCache:function(e,t){var i=this._cache[e];return void 0===i&&(this._cache[e]=t.call(this)),this._cache[e]},_clearSelfAndDescendantCache:function(e){this._clearCache(e),this.children&&this.getChildren().each(function(t){t._clearSelfAndDescendantCache(e)})},clearCache:function(){return delete this._cache.canvas,this._filterUpToDate=!1,this},cache:function(t){var i=t||{},n=this.getClientRect(!0),a=i.width||n.width,r=i.height||n.height,s=i.x||n.x,o=i.y||n.y,l=i.offset||0,h=i.drawBorder||!1;if(!a||!r)throw new Error("Width or height of caching configuration equals 0.");a+=2*l,r+=2*l,s-=l,o-=l;var u=new e.SceneCanvas({width:a,height:r}),c=new e.SceneCanvas({width:a,height:r}),d=new e.HitCanvas({pixelRatio:1,width:a,height:r}),f=u.getContext(),p=d.getContext();return d.isCache=!0,this.clearCache(),f.save(),p.save(),f.translate(-s,-o),p.translate(-s,-o),this.drawScene(u,this,!0),this.drawHit(d,this,!0),f.restore(),p.restore(),h&&(f.save(),f.beginPath(),f.rect(0,0,a,r),f.closePath(),f.setAttr("strokeStyle","red"),f.setAttr("lineWidth",5),f.stroke(),f.restore()),this._cache.canvas={scene:u,filter:c,hit:d,x:s,y:o},this},getClientRect:function(){throw new Error('abstract "getClientRect" method call')},_transformedRect:function(e){var t,i,n,a,r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],s=this.getTransform();return r.forEach(function(e){var r=s.point(e);void 0===t&&(t=n=r.x,i=a=r.y),t=Math.min(t,r.x),i=Math.min(i,r.y),n=Math.max(n,r.x),a=Math.max(a,r.y)}),{x:Math.round(t),y:Math.round(i),width:Math.round(n-t),height:Math.round(a-i)}},_drawCachedSceneCanvas:function(e){e.save(),e._applyOpacity(this),e.translate(this._cache.canvas.x,this._cache.canvas.y);var t=this._getCachedSceneCanvas(),i=t.pixelRatio;e.drawImage(t._canvas,0,0,t.width/i,t.height/i),e.restore()},_drawCachedHitCanvas:function(e){var t=this._cache.canvas,i=t.hit;e.save(),e.translate(this._cache.canvas.x,this._cache.canvas.y),e.drawImage(i._canvas,0,0),e.restore()},_getCachedSceneCanvas:function(){var t,i,n,a,r=this.filters(),s=this._cache.canvas,o=s.scene,l=s.filter,h=l.getContext();if(r){if(!this._filterUpToDate){var u=o.pixelRatio;try{for(t=r.length,h.clear(),h.drawImage(o._canvas,0,0,o.getWidth()/u,o.getHeight()/u),i=h.getImageData(0,0,l.getWidth(),l.getHeight()),n=0;t>n;n++)a=r[n],a.call(this,i),h.putImageData(i,0,0)}catch(c){e.Util.warn("Unable to apply filter. "+c.message)}this._filterUpToDate=!0}return l}return o},on:function(e,t){if(3===arguments.length)return this._delegate.apply(this,arguments);var i,n,a,o,l,h=e.split(m),u=h.length;for(i=0;u>i;i++)n=h[i],a=n.split(r),o=a[0],l=a[1]||s,this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:l,handler:t});return this},off:function(e){var t,i,n,a,s,o,l=(e||"").split(m),h=l.length;if(!e)for(i in this.eventListeners)this._off(i);for(t=0;h>t;t++)if(n=l[t],a=n.split(r),s=a[0],o=a[1],s)this.eventListeners[s]&&this._off(s,o);else for(i in this.eventListeners)this._off(i,o);return this},dispatchEvent:function(e){var t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this},addEventListener:function(e,t){return this.on(e,function(e){t.call(this,e.evt)}),this},removeEventListener:function(e){return this.off(e),this},_delegate:function(t,i,n){var a=this;this.on(t,function(t){for(var r=t.target.findAncestors(i,!0,a),s=0;s<r.length;s++)t=e.Util.cloneObject(t),t.currentTarget=r[s],n.call(r[s],t)})},remove:function(){var e=this.getParent();return e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),delete this.parent),this._clearSelfAndDescendantCache(g),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(_),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(t),this},destroy:function(){return e._removeId(this.getId()),e._removeName(this.getName(),this._id),this.remove(),this},getAttr:function(t){var i=o+e.Util._capitalize(t);return e.Util._isFunction(this[i])?this[i]():this.attrs[t]},getAncestors:function(){for(var t=this.getParent(),i=new e.Collection;t;)i.push(t),t=t.getParent();return i},getAttrs:function(){return this.attrs||{}},setAttrs:function(t){var i,n;if(!t)return this;for(i in t)i!==a&&(n=p+e.Util._capitalize(i),e.Util._isFunction(this[n])?this[n](t[i]):this._setAttr(i,t[i]));return this},isListening:function(){return this._getCache(u,this._isListening)},_isListening:function(){var e=this.getListening(),t=this.getParent();return"inherit"===e?t?t.isListening():!0:e},isVisible:function(){return this._getCache(_,this._isVisible)},_isVisible:function(){var e=this.getVisible(),t=this.getParent();return"inherit"===e?t?t.isVisible():!0:e},shouldDrawHit:function(e){var t=this.getLayer();return e&&e.isCache||t&&t.hitGraphEnabled()&&this.isListening()&&this.isVisible()},show:function(){return this.setVisible(!0),this},hide:function(){return this.setVisible(!1),this},getZIndex:function(){return this.index||0},getAbsoluteZIndex:function(){function e(l){for(t=[],i=l.length,n=0;i>n;n++)a=l[n],o++,a.nodeType!==v&&(t=t.concat(a.getChildren().toArray())),a._id===s._id&&(n=i);t.length>0&&t[0].getDepth()<=r&&e(t)}var t,i,n,a,r=this.getDepth(),s=this,o=0;return s.nodeType!==y&&e(s.getStage().getChildren()),o},getDepth:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},setPosition:function(e){return this.setX(e.x),this.setY(e.y),this},getPosition:function(){return{x:this.getX(),y:this.getY()}},getAbsolutePosition:function(t){var i=this.getAbsoluteTransform(t).getMatrix(),n=new e.Transform,a=this.offset();return n.m=i.slice(),n.translate(a.x,a.y),n.getTranslation()},setAbsolutePosition:function(e){var t,i=this._clearTransform();return this.attrs.x=i.x,this.attrs.y=i.y,delete i.x,delete i.y,t=this.getAbsoluteTransform(),t.invert(),t.translate(e.x,e.y),e={x:this.attrs.x+t.getTranslation().x,y:this.attrs.y+t.getTranslation().y},this.setPosition({x:e.x,y:e.y}),this._setTransform(i),this},_setTransform:function(e){var t;for(t in e)this.attrs[t]=e[t];this._clearCache(b),this._clearSelfAndDescendantCache(i)},_clearTransform:function(){var e={x:this.getX(),y:this.getY(),rotation:this.getRotation(),scaleX:this.getScaleX(),scaleY:this.getScaleY(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),skewX:this.getSkewX(),skewY:this.getSkewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(b),this._clearSelfAndDescendantCache(i),e},move:function(e){var t=e.x,i=e.y,n=this.getX(),a=this.getY();return void 0!==t&&(n+=t),void 0!==i&&(a+=i),this.setPosition({x:n,y:a}),this},_eachAncestorReverse:function(e,t){var i,n,a=[],r=this.getParent();if(t&&t._id===this._id)return e(this),!0;for(a.unshift(this);r&&(!t||r._id!==t._id);)a.unshift(r),r=r.parent;for(i=a.length,n=0;i>n;n++)e(a[n])},rotate:function(e){return this.setRotation(this.getRotation()+e),this},moveToTop:function(){if(!this.parent)return e.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},moveUp:function(){if(!this.parent)return e.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,i=this.parent.getChildren().length;return i-1>t?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1},moveDown:function(){if(!this.parent)return e.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1},moveToBottom:function(){if(!this.parent)return e.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1},setZIndex:function(t){if(!this.parent)return e.Util.warn("Node has no parent. zIndex parameter is ignored."),!1;var i=this.index;return this.parent.children.splice(i,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this},getAbsoluteOpacity:function(){return this._getCache(t,this._getAbsoluteOpacity)},_getAbsoluteOpacity:function(){var e=this.getOpacity();return this.getParent()&&(e*=this.getParent().getAbsoluteOpacity()),e},moveTo:function(e){return this.getParent()!==e&&(this.remove(),e.add(this)),this},toObject:function(){var t,i,n,a,r={},s=this.getAttrs();r.attrs={};for(t in s)i=s[t],e.Util._isFunction(i)||e.Util._isElement(i)||e.Util._isObject(i)||e.Util._hasMethods(i)||(n=this[t],delete s[t],a=n?n.call(this):null,s[t]=i,a!==i&&(r.attrs[t]=i));return r.className=this.getClassName(),r},toJSON:function(){return JSON.stringify(this.toObject())},getParent:function(){return this.parent},findAncestors:function(e,t,i){var n=[];t&&this._isMatch(e)&&n.push(this);for(var a=this.parent;a;){if(a===i)return n;a._isMatch(e)&&n.push(a),a=a.parent}return n},findAncestor:function(e,t,i){return this.findAncestors(e,t,i)[0]},_isMatch:function(t){if(!t)return!1;var i,n,a=t.replace(/ /g,"").split(","),r=a.length;for(i=0;r>i;i++)if(n=a[i],e.Util.isValidSelector(n)||(e.Util.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),e.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),e.Util.warn("Konva is awesome, right?")),"#"===n.charAt(0)){if(this.id()===n.slice(1))return!0}else if("."===n.charAt(0)){if(this.hasName(n.slice(1)))return!0}else if(0!==this._get(n).length)return!0;return!1},getLayer:function(){var e=this.getParent();return e?e.getLayer():null},getStage:function(){return this._getCache(g,this._getStage)},_getStage:function(){var e=this.getParent();return e?e.getStage():void 0},fire:function(e,t,i){return t=t||{},t.target=t.target||this,i?this._fireAndBubble(e,t):this._fire(e,t),this},getAbsoluteTransform:function(e){return e?this._getAbsoluteTransform(e):this._getCache(i,this._getAbsoluteTransform)},_getAbsoluteTransform:function(t){var i,n,a=new e.Transform;return this._eachAncestorReverse(function(e){i=e.transformsEnabled(),n=e.getTransform(),"all"===i?a.multiply(n):"position"===i&&a.translate(e.x(),e.y())},t),a},getTransform:function(){return this._getCache(b,this._getTransform)},_getTransform:function(){var t=new e.Transform,i=this.getX(),n=this.getY(),a=e.getAngle(this.getRotation()),r=this.getScaleX(),s=this.getScaleY(),o=this.getSkewX(),l=this.getSkewY(),h=this.getOffsetX(),u=this.getOffsetY();return(0!==i||0!==n)&&t.translate(i,n),0!==a&&t.rotate(a),(0!==o||0!==l)&&t.skew(o,l),(1!==r||1!==s)&&t.scale(r,s),(0!==h||0!==u)&&t.translate(-1*h,-1*u),t},clone:function(t){var i,n,a,r,s,o=e.Util.cloneObject(this.attrs);for(var l in x){var u=x[l];delete o[u]}for(i in t)o[i]=t[i];var c=new this.constructor(o);
for(i in this.eventListeners)for(n=this.eventListeners[i],a=n.length,r=0;a>r;r++)s=n[r],s.name.indexOf(h)<0&&(c.eventListeners[i]||(c.eventListeners[i]=[]),c.eventListeners[i].push(s));return c},toDataURL:function(t){t=t||{};var i=t.mimeType||null,n=t.quality||null,a=this.getStage(),r=t.x||0,s=t.y||0,o=t.pixelRatio||1,l=new e.SceneCanvas({width:t.width||this.getWidth()||(a?a.getWidth():0),height:t.height||this.getHeight()||(a?a.getHeight():0),pixelRatio:o}),h=l.getContext();return h.save(),(r||s)&&h.translate(-1*r,-1*s),this.drawScene(l),h.restore(),l.toDataURL(i,n)},toImage:function(t){if(!t||!t.callback)throw"callback required for toImage method config argument";e.Util._getImage(this.toDataURL(t),function(e){t.callback(e)})},setSize:function(e){return this.setWidth(e.width),this.setHeight(e.height),this},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return this.attrs.width||0},getHeight:function(){return this.attrs.height||0},getClassName:function(){return this.className||this.nodeType},getType:function(){return this.nodeType},getDragDistance:function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():e.dragDistance},_get:function(e){return this.className===e||this.nodeType===e?[this]:[]},_off:function(e,t){var i,n,a=this.eventListeners[e];for(i=0;i<a.length;i++)if(n=a[i].name,!("konva"===n&&"konva"!==t||t&&n!==t)){if(a.splice(i,1),0===a.length){delete this.eventListeners[e];break}i--}},_fireChangeEvent:function(e,t,i){this._fire(e+n,{oldVal:t,newVal:i})},setId:function(t){var i=this.getId();return e._removeId(i),e._addId(this,t),this._setAttr(l,t),this},setName:function(t){var i,n,a=(this.getName()||"").split(/\s/g),r=(t||"").split(/\s/g);for(n=0;n<a.length;n++)i=a[n],-1===r.indexOf(i)&&i&&e._removeName(i,this._id);for(n=0;n<r.length;n++)i=r[n],-1===a.indexOf(i)&&i&&e._addName(this,i);return this._setAttr(f,t),this},addName:function(e){if(!this.hasName(e)){var t=this.name(),i=t?t+" "+e:e;this.setName(i)}return this},hasName:function(e){var t=(this.name()||"").split(/\s/g);return-1!==t.indexOf(e)},removeName:function(e){var t=(this.name()||"").split(/\s/g),i=t.indexOf(e);return-1!==i&&(t.splice(i,1),this.setName(t.join(" "))),this},setAttr:function(t,i){var n=p+e.Util._capitalize(t),a=this[n];return e.Util._isFunction(a)?a.call(this,i):this._setAttr(t,i),this},_setAttr:function(e,t){var i;if(void 0!==t){if(i=this.attrs[e],i===t)return;this.attrs[e]=t,this._fireChangeEvent(e,i,t)}},_setComponentAttr:function(e,t,i){var n;void 0!==i&&(n=this.attrs[e],n||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=i,this._fireChangeEvent(e,n,i))},_fireAndBubble:function(e,t,i){var n=!0;if(t&&this.nodeType===v&&(t.target=this),e===c&&i&&(this._id===i._id||this.isAncestorOf&&this.isAncestorOf(i))?n=!1:e===d&&i&&(this._id===i._id||this.isAncestorOf&&this.isAncestorOf(i))&&(n=!1),n){this._fire(e,t);var a=(e===c||e===d)&&(i&&i.isAncestorOf&&i.isAncestorOf(this)||!(!i||!i.isAncestorOf));(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!a&&(i&&i.parent?this._fireAndBubble.call(this.parent,e,t,i.parent):this._fireAndBubble.call(this.parent,e,t))}},_fire:function(t,i){var n,a=this.eventListeners[t];if(i=e.Util.cloneObject(i||{}),i.currentTarget=this,i.type=t,a)for(n=0;n<a.length;n++)a[n].handler.call(this,i)},draw:function(){return this.drawScene(),this.drawHit(),this}}),e.Node.create=function(t,i){return e.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,i)},e.Node._createNode=function(t,i){var n,a,r,s=e.Node.prototype.getClassName.call(t),o=t.children;if(i&&(t.attrs.container=i),n=new e[s](t.attrs),o)for(a=o.length,r=0;a>r;r++)n.add(this._createNode(o[r]));return n},e.Factory.addOverloadedGetterSetter(e.Node,"position"),e.Factory.addGetterSetter(e.Node,"x",0),e.Factory.addGetterSetter(e.Node,"y",0),e.Factory.addGetterSetter(e.Node,"opacity",1),e.Factory.addGetter(e.Node,"name"),e.Factory.addOverloadedGetterSetter(e.Node,"name"),e.Factory.addGetter(e.Node,"id"),e.Factory.addOverloadedGetterSetter(e.Node,"id"),e.Factory.addGetterSetter(e.Node,"rotation",0),e.Factory.addComponentsGetterSetter(e.Node,"scale",["x","y"]),e.Factory.addGetterSetter(e.Node,"scaleX",1),e.Factory.addGetterSetter(e.Node,"scaleY",1),e.Factory.addComponentsGetterSetter(e.Node,"skew",["x","y"]),e.Factory.addGetterSetter(e.Node,"skewX",0),e.Factory.addGetterSetter(e.Node,"skewY",0),e.Factory.addComponentsGetterSetter(e.Node,"offset",["x","y"]),e.Factory.addGetterSetter(e.Node,"offsetX",0),e.Factory.addGetterSetter(e.Node,"offsetY",0),e.Factory.addSetter(e.Node,"dragDistance"),e.Factory.addOverloadedGetterSetter(e.Node,"dragDistance"),e.Factory.addSetter(e.Node,"width",0),e.Factory.addOverloadedGetterSetter(e.Node,"width"),e.Factory.addSetter(e.Node,"height",0),e.Factory.addOverloadedGetterSetter(e.Node,"height"),e.Factory.addGetterSetter(e.Node,"listening","inherit"),e.Factory.addGetterSetter(e.Node,"filters",void 0,function(e){return this._filterUpToDate=!1,e}),e.Factory.addGetterSetter(e.Node,"visible","inherit"),e.Factory.addGetterSetter(e.Node,"transformsEnabled","all"),e.Factory.addOverloadedGetterSetter(e.Node,"size"),e.Factory.backCompat(e.Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),e.Collection.mapMethods(e.Node)}(Konva),function(){"use strict";Konva.Filters.Grayscale=function(e){var t,i,n=e.data,a=n.length;for(t=0;a>t;t+=4)i=.34*n[t]+.5*n[t+1]+.16*n[t+2],n[t]=i,n[t+1]=i,n[t+2]=i}}(),function(){"use strict";Konva.Filters.Brighten=function(e){var t,i=255*this.brightness(),n=e.data,a=n.length;for(t=0;a>t;t+=4)n[t]+=i,n[t+1]+=i,n[t+2]+=i},Konva.Factory.addGetterSetter(Konva.Node,"brightness",0,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.Invert=function(e){var t,i=e.data,n=i.length;for(t=0;n>t;t+=4)i[t]=255-i[t],i[t+1]=255-i[t+1],i[t+2]=255-i[t+2]}}(),function(){"use strict";function e(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function t(t,a){var r,s,o,l,h,u,c,d,f,p,v,m,g,b,y,_,x,k,w,S,C,P,T,$,K=t.data,M=t.width,L=t.height,D=a+a+1,F=M-1,O=L-1,j=a+1,E=j*(j+1)/2,A=new e,R=null,G=A,N=null,I=null,B=i[a],U=n[a];for(o=1;D>o;o++)G=G.next=new e,o===j&&(R=G);for(G.next=A,c=u=0,s=0;L>s;s++){for(_=x=k=w=d=f=p=v=0,m=j*(S=K[u]),g=j*(C=K[u+1]),b=j*(P=K[u+2]),y=j*(T=K[u+3]),d+=E*S,f+=E*C,p+=E*P,v+=E*T,G=A,o=0;j>o;o++)G.r=S,G.g=C,G.b=P,G.a=T,G=G.next;for(o=1;j>o;o++)l=u+((o>F?F:o)<<2),d+=(G.r=S=K[l])*($=j-o),f+=(G.g=C=K[l+1])*$,p+=(G.b=P=K[l+2])*$,v+=(G.a=T=K[l+3])*$,_+=S,x+=C,k+=P,w+=T,G=G.next;for(N=A,I=R,r=0;M>r;r++)K[u+3]=T=v*B>>U,0!==T?(T=255/T,K[u]=(d*B>>U)*T,K[u+1]=(f*B>>U)*T,K[u+2]=(p*B>>U)*T):K[u]=K[u+1]=K[u+2]=0,d-=m,f-=g,p-=b,v-=y,m-=N.r,g-=N.g,b-=N.b,y-=N.a,l=c+((l=r+a+1)<F?l:F)<<2,_+=N.r=K[l],x+=N.g=K[l+1],k+=N.b=K[l+2],w+=N.a=K[l+3],d+=_,f+=x,p+=k,v+=w,N=N.next,m+=S=I.r,g+=C=I.g,b+=P=I.b,y+=T=I.a,_-=S,x-=C,k-=P,w-=T,I=I.next,u+=4;c+=M}for(r=0;M>r;r++){for(x=k=w=_=f=p=v=d=0,u=r<<2,m=j*(S=K[u]),g=j*(C=K[u+1]),b=j*(P=K[u+2]),y=j*(T=K[u+3]),d+=E*S,f+=E*C,p+=E*P,v+=E*T,G=A,o=0;j>o;o++)G.r=S,G.g=C,G.b=P,G.a=T,G=G.next;for(h=M,o=1;a>=o;o++)u=h+r<<2,d+=(G.r=S=K[u])*($=j-o),f+=(G.g=C=K[u+1])*$,p+=(G.b=P=K[u+2])*$,v+=(G.a=T=K[u+3])*$,_+=S,x+=C,k+=P,w+=T,G=G.next,O>o&&(h+=M);for(u=r,N=A,I=R,s=0;L>s;s++)l=u<<2,K[l+3]=T=v*B>>U,T>0?(T=255/T,K[l]=(d*B>>U)*T,K[l+1]=(f*B>>U)*T,K[l+2]=(p*B>>U)*T):K[l]=K[l+1]=K[l+2]=0,d-=m,f-=g,p-=b,v-=y,m-=N.r,g-=N.g,b-=N.b,y-=N.a,l=r+((l=s+j)<O?l:O)*M<<2,d+=_+=N.r=K[l],f+=x+=N.g=K[l+1],p+=k+=N.b=K[l+2],v+=w+=N.a=K[l+3],N=N.next,m+=S=I.r,g+=C=I.g,b+=P=I.b,y+=T=I.a,_-=S,x-=C,k-=P,w-=T,I=I.next,u+=M}}var i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],n=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];Konva.Filters.Blur=function(e){var i=Math.round(this.blurRadius());i>0&&t(e,i)},Konva.Factory.addGetterSetter(Konva.Node,"blurRadius",0,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";function e(e,t,i){var n=4*(i*e.width+t),a=[];return a.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),a}function t(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function i(e){for(var t=[0,0,0],i=0;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1],t[2]+=e[i][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function n(n,a){var r=e(n,0,0),s=e(n,n.width-1,0),o=e(n,0,n.height-1),l=e(n,n.width-1,n.height-1),h=a||10;if(t(r,s)<h&&t(s,l)<h&&t(l,o)<h&&t(o,r)<h){for(var u=i([s,r,l,o]),c=[],d=0;d<n.width*n.height;d++){var f=t(u,[n.data[4*d],n.data[4*d+1],n.data[4*d+2]]);c[d]=h>f?0:255}return c}}function a(e,t){for(var i=0;i<e.width*e.height;i++)e.data[4*i+3]=t[i]}function r(e,t,i){for(var n=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(n.length)),r=Math.floor(a/2),s=[],o=0;i>o;o++)for(var l=0;t>l;l++){for(var h=o*t+l,u=0,c=0;a>c;c++)for(var d=0;a>d;d++){var f=o+c-r,p=l+d-r;if(f>=0&&i>f&&p>=0&&t>p){var v=f*t+p,m=n[c*a+d];u+=e[v]*m}}s[h]=2040===u?255:0}return s}function s(e,t,i){for(var n=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(n.length)),r=Math.floor(a/2),s=[],o=0;i>o;o++)for(var l=0;t>l;l++){for(var h=o*t+l,u=0,c=0;a>c;c++)for(var d=0;a>d;d++){var f=o+c-r,p=l+d-r;if(f>=0&&i>f&&p>=0&&t>p){var v=f*t+p,m=n[c*a+d];u+=e[v]*m}}s[h]=u>=1020?255:0}return s}function o(e,t,i){for(var n=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],a=Math.round(Math.sqrt(n.length)),r=Math.floor(a/2),s=[],o=0;i>o;o++)for(var l=0;t>l;l++){for(var h=o*t+l,u=0,c=0;a>c;c++)for(var d=0;a>d;d++){var f=o+c-r,p=l+d-r;if(f>=0&&i>f&&p>=0&&t>p){var v=f*t+p,m=n[c*a+d];u+=e[v]*m}}s[h]=u}return s}Konva.Filters.Mask=function(e){var t=this.threshold(),i=n(e,t);return i&&(i=r(i,e.width,e.height),i=s(i,e.width,e.height),i=o(i,e.width,e.height),a(e,i)),e},Konva.Factory.addGetterSetter(Konva.Node,"threshold",0,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.RGB=function(e){var t,i,n=e.data,a=n.length,r=this.red(),s=this.green(),o=this.blue();for(t=0;a>t;t+=4)i=(.34*n[t]+.5*n[t+1]+.16*n[t+2])/255,n[t]=i*r,n[t+1]=i*s,n[t+2]=i*o,n[t+3]=n[t+3]},Konva.Factory.addGetterSetter(Konva.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:0>e?0:Math.round(e)}),Konva.Factory.addGetterSetter(Konva.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:0>e?0:Math.round(e)}),Konva.Factory.addGetterSetter(Konva.Node,"blue",0,Konva.Validators.RGBComponent,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.RGBA=function(e){var t,i,n=e.data,a=n.length,r=this.red(),s=this.green(),o=this.blue(),l=this.alpha();for(t=0;a>t;t+=4)i=1-l,n[t]=r*l+n[t]*i,n[t+1]=s*l+n[t+1]*i,n[t+2]=o*l+n[t+2]*i},Konva.Factory.addGetterSetter(Konva.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:0>e?0:Math.round(e)}),Konva.Factory.addGetterSetter(Konva.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:0>e?0:Math.round(e)}),Konva.Factory.addGetterSetter(Konva.Node,"blue",0,Konva.Validators.RGBComponent,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:0>e?0:e})}(),function(){"use strict";Konva.Filters.HSV=function(e){var t,i,n,a,r,s=e.data,o=s.length,l=Math.pow(2,this.value()),h=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,c=l*h*Math.cos(u*Math.PI/180),d=l*h*Math.sin(u*Math.PI/180),f=.299*l+.701*c+.167*d,p=.587*l-.587*c+.33*d,v=.114*l-.114*c-.497*d,m=.299*l-.299*c-.328*d,g=.587*l+.413*c+.035*d,b=.114*l-.114*c+.293*d,y=.299*l-.3*c+1.25*d,_=.587*l-.586*c-1.05*d,x=.114*l+.886*c-.2*d;for(t=0;o>t;t+=4)i=s[t+0],n=s[t+1],a=s[t+2],r=s[t+3],s[t+0]=f*i+p*n+v*a,s[t+1]=m*i+g*n+b*a,s[t+2]=y*i+_*n+x*a,s[t+3]=r},Konva.Factory.addGetterSetter(Konva.Node,"hue",0,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"saturation",0,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"value",0,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Factory.addGetterSetter(Konva.Node,"hue",0,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"saturation",0,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"luminance",0,null,Konva.Factory.afterSetFilter),Konva.Filters.HSL=function(e){var t,i,n,a,r,s=e.data,o=s.length,l=1,h=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,c=127*this.luminance(),d=l*h*Math.cos(u*Math.PI/180),f=l*h*Math.sin(u*Math.PI/180),p=.299*l+.701*d+.167*f,v=.587*l-.587*d+.33*f,m=.114*l-.114*d-.497*f,g=.299*l-.299*d-.328*f,b=.587*l+.413*d+.035*f,y=.114*l-.114*d+.293*f,_=.299*l-.3*d+1.25*f,x=.587*l-.586*d-1.05*f,k=.114*l+.886*d-.2*f;for(t=0;o>t;t+=4)i=s[t+0],n=s[t+1],a=s[t+2],r=s[t+3],s[t+0]=p*i+v*n+m*a+c,s[t+1]=g*i+b*n+y*a+c,s[t+2]=_*i+x*n+k*a+c,s[t+3]=r}}(),function(){"use strict";Konva.Filters.Emboss=function(e){var t=10*this.embossStrength(),i=255*this.embossWhiteLevel(),n=this.embossDirection(),a=this.embossBlend(),r=0,s=0,o=e.data,l=e.width,h=e.height,u=4*l,c=h;switch(n){case"top-left":r=-1,s=-1;break;case"top":r=-1,s=0;break;case"top-right":r=-1,s=1;break;case"right":r=0,s=1;break;case"bottom-right":r=1,s=1;break;case"bottom":r=1,s=0;break;case"bottom-left":r=1,s=-1;break;case"left":r=0,s=-1}do{var d=(c-1)*u,f=r;1>c+f&&(f=0),c+f>h&&(f=0);var p=(c-1+f)*l*4,v=l;do{var m=d+4*(v-1),g=s;1>v+g&&(g=0),v+g>l&&(g=0);var b=p+4*(v-1+g),y=o[m]-o[b],_=o[m+1]-o[b+1],x=o[m+2]-o[b+2],k=y,w=k>0?k:-k,S=_>0?_:-_,C=x>0?x:-x;if(S>w&&(k=_),C>w&&(k=x),k*=t,a){var P=o[m]+k,T=o[m+1]+k,$=o[m+2]+k;o[m]=P>255?255:0>P?0:P,o[m+1]=T>255?255:0>T?0:T,o[m+2]=$>255?255:0>$?0:$}else{var K=i-k;0>K?K=0:K>255&&(K=255),o[m]=o[m+1]=o[m+2]=K}}while(--v)}while(--c)},Konva.Factory.addGetterSetter(Konva.Node,"embossStrength",.5,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"embossWhiteLevel",.5,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"embossDirection","top-left",null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"embossBlend",!1,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";function e(e,t,i,n,a){var r,s=i-t,o=a-n;return 0===s?n+o/2:0===o?n:(r=(e-t)/s,r=o*r+n)}Konva.Filters.Enhance=function(t){var i,n,a,r,s=t.data,o=s.length,l=s[0],h=l,u=s[1],c=u,d=s[2],f=d,p=this.enhance();if(0!==p){for(r=0;o>r;r+=4)i=s[r+0],l>i?l=i:i>h&&(h=i),n=s[r+1],u>n?u=n:n>c&&(c=n),a=s[r+2],d>a?d=a:a>f&&(f=a);h===l&&(h=255,l=0),c===u&&(c=255,u=0),f===d&&(f=255,d=0);var v,m,g,b,y,_,x,k,w;for(p>0?(m=h+p*(255-h),g=l-p*(l-0),y=c+p*(255-c),_=u-p*(u-0),k=f+p*(255-f),w=d-p*(d-0)):(v=.5*(h+l),m=h+p*(h-v),g=l+p*(l-v),b=.5*(c+u),y=c+p*(c-b),_=u+p*(u-b),x=.5*(f+d),k=f+p*(f-x),w=d+p*(d-x)),r=0;o>r;r+=4)s[r+0]=e(s[r+0],l,h,g,m),s[r+1]=e(s[r+1],u,c,_,y),s[r+2]=e(s[r+2],d,f,w,k)}},Konva.Factory.addGetterSetter(Konva.Node,"enhance",0,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.Posterize=function(e){var t,i=Math.round(254*this.levels())+1,n=e.data,a=n.length,r=255/i;for(t=0;a>t;t+=1)n[t]=Math.floor(n[t]/r)*r},Konva.Factory.addGetterSetter(Konva.Node,"levels",.5,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.Noise=function(e){var t,i=255*this.noise(),n=e.data,a=n.length,r=i/2;for(t=0;a>t;t+=4)n[t+0]+=r-2*r*Math.random(),n[t+1]+=r-2*r*Math.random(),n[t+2]+=r-2*r*Math.random()},Konva.Factory.addGetterSetter(Konva.Node,"noise",.2,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.Pixelate=function(e){var t,i,n,a,r,s,o,l,h,u,c,d,f,p,v=Math.ceil(this.pixelSize()),m=e.width,g=e.height,b=Math.ceil(m/v),y=Math.ceil(g/v);for(e=e.data,d=0;b>d;d+=1)for(f=0;y>f;f+=1){for(a=0,r=0,s=0,o=0,l=d*v,h=l+v,u=f*v,c=u+v,p=0,t=l;h>t;t+=1)if(!(t>=m))for(i=u;c>i;i+=1)i>=g||(n=4*(m*i+t),a+=e[n+0],r+=e[n+1],s+=e[n+2],o+=e[n+3],p+=1);for(a/=p,r/=p,s/=p,t=l;h>t;t+=1)if(!(t>=m))for(i=u;c>i;i+=1)i>=g||(n=4*(m*i+t),e[n+0]=a,e[n+1]=r,e[n+2]=s,e[n+3]=o)}},Konva.Factory.addGetterSetter(Konva.Node,"pixelSize",8,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.Threshold=function(e){var t,i=255*this.threshold(),n=e.data,a=n.length;for(t=0;a>t;t+=1)n[t]=n[t]<i?0:255},Konva.Factory.addGetterSetter(Konva.Node,"threshold",.5,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Filters.Sepia=function(e){var t,i,n,a,r,s,o,l,h,u=e.data,c=e.width,d=e.height,f=4*c;do{t=(d-1)*f,i=c;do n=t+4*(i-1),a=u[n],r=u[n+1],s=u[n+2],o=.393*a+.769*r+.189*s,l=.349*a+.686*r+.168*s,h=.272*a+.534*r+.131*s,u[n]=o>255?255:o,u[n+1]=l>255?255:l,u[n+2]=h>255?255:h,u[n+3]=u[n+3];while(--i)}while(--d)}}(),function(){"use strict";Konva.Filters.Solarize=function(e){var t=e.data,i=e.width,n=e.height,a=4*i,r=n;do{var s=(r-1)*a,o=i;do{var l=s+4*(o-1),h=t[l],u=t[l+1],c=t[l+2];h>127&&(h=255-h),u>127&&(u=255-u),c>127&&(c=255-c),t[l]=h,t[l+1]=u,t[l+2]=c}while(--o)}while(--r)}}(),function(){"use strict";var e=function(e,t,i){var n,a,r,s,o=e.data,l=t.data,h=e.width,u=e.height,c=i.polarCenterX||h/2,d=i.polarCenterY||u/2,f=0,p=0,v=0,m=0,g=Math.sqrt(c*c+d*d);a=h-c,r=u-d,s=Math.sqrt(a*a+r*r),g=s>g?s:g;var b,y,_,x,k=u,w=h,S=360/w*Math.PI/180;for(y=0;w>y;y+=1)for(_=Math.sin(y*S),x=Math.cos(y*S),b=0;k>b;b+=1)a=Math.floor(c+g*b/k*x),r=Math.floor(d+g*b/k*_),n=4*(r*h+a),f=o[n+0],p=o[n+1],v=o[n+2],m=o[n+3],n=4*(y+b*h),l[n+0]=f,l[n+1]=p,l[n+2]=v,l[n+3]=m},t=function(e,t,i){var n,a,r,s,o,l,h=e.data,u=t.data,c=e.width,d=e.height,f=i.polarCenterX||c/2,p=i.polarCenterY||d/2,v=0,m=0,g=0,b=0,y=Math.sqrt(f*f+p*p);a=c-f,r=d-p,l=Math.sqrt(a*a+r*r),y=l>y?l:y;var _,x,k,w,S=d,C=c,P=i.polarRotation||0;for(a=0;c>a;a+=1)for(r=0;d>r;r+=1)s=a-f,o=r-p,_=Math.sqrt(s*s+o*o)*S/y,x=(180*Math.atan2(o,s)/Math.PI+360+P)%360,x=x*C/360,k=Math.floor(x),w=Math.floor(_),n=4*(w*c+k),v=h[n+0],m=h[n+1],g=h[n+2],b=h[n+3],n=4*(r*c+a),u[n+0]=v,u[n+1]=m,u[n+2]=g,u[n+3]=b},i=Konva.Util.createCanvasElement();Konva.Filters.Kaleidoscope=function(n){var a,r,s,o,l,h,u,c,d,f,p=n.width,v=n.height,m=Math.round(this.kaleidoscopePower()),g=Math.round(this.kaleidoscopeAngle()),b=Math.floor(p*(g%360)/360);if(!(1>m)){i.width=p,i.height=v;var y=i.getContext("2d").getImageData(0,0,p,v);e(n,y,{polarCenterX:p/2,polarCenterY:v/2});for(var _=p/Math.pow(2,m);8>=_;)_=2*_,m-=1;_=Math.ceil(_);var x=_,k=0,w=x,S=1;for(b+_>p&&(k=x,w=0,S=-1),r=0;v>r;r+=1)for(a=k;a!==w;a+=S)s=Math.round(a+b)%p,d=4*(p*r+s),l=y.data[d+0],h=y.data[d+1],u=y.data[d+2],c=y.data[d+3],f=4*(p*r+a),y.data[f+0]=l,y.data[f+1]=h,y.data[f+2]=u,y.data[f+3]=c;for(r=0;v>r;r+=1)for(x=Math.floor(_),o=0;m>o;o+=1){for(a=0;x+1>a;a+=1)d=4*(p*r+a),l=y.data[d+0],h=y.data[d+1],u=y.data[d+2],c=y.data[d+3],f=4*(p*r+2*x-a-1),y.data[f+0]=l,y.data[f+1]=h,y.data[f+2]=u,y.data[f+3]=c;x*=2}t(y,n,{polarRotation:0})}},Konva.Factory.addGetterSetter(Konva.Node,"kaleidoscopePower",2,null,Konva.Factory.afterSetFilter),Konva.Factory.addGetterSetter(Konva.Node,"kaleidoscopeAngle",0,null,Konva.Factory.afterSetFilter)}(),function(){"use strict";Konva.Container=function(e){this.__init(e)},Konva.Util.addMethods(Konva.Container,{__init:function(e){this.children=new Konva.Collection,Konva.Node.call(this,e)},getChildren:function(e){if(!e)return this.children;var t=new Konva.Collection;return this.children.each(function(i){e(i)&&t.push(i)}),t},hasChildren:function(){return this.getChildren().length>0},removeChildren:function(){for(var e,t=Konva.Collection.toCollection(this.children),i=0;i<t.length;i++)e=t[i],delete e.parent,e.index=0,e.hasChildren()&&e.removeChildren(),e.remove();return t=null,this.children=new Konva.Collection,this},destroyChildren:function(){for(var e,t=Konva.Collection.toCollection(this.children),i=0;i<t.length;i++)e=t[i],delete e.parent,e.index=0,e.destroy();return t=null,this.children=new Konva.Collection,this},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}if(e.getParent())return e.moveTo(this),this;var i=this.children;return this._validateAdd(e),e.index=i.length,e.parent=this,i.push(e),this._fire("add",{child:e}),Konva.DD&&e.isDragging()&&Konva.DD.anim.setLayers(e.getLayer()),this},destroy:function(){return this.hasChildren()&&this.destroyChildren(),Konva.Node.prototype.destroy.call(this),this},find:function(e){var t,i,n,a,r,s,o,l=[],h=e.replace(/ /g,"").split(","),u=h.length;for(t=0;u>t;t++)if(n=h[t],Konva.Util.isValidSelector(n)||(Konva.Util.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Konva.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Konva.Util.warn("Konva is awesome, right?")),"#"===n.charAt(0))r=this._getNodeById(n.slice(1)),r&&l.push(r);else if("."===n.charAt(0))a=this._getNodesByName(n.slice(1)),l=l.concat(a);else for(s=this.getChildren(),o=s.length,i=0;o>i;i++)l=l.concat(s[i]._get(n));return Konva.Collection.toCollection(l)},findOne:function(e){return this.find(e)[0]},_getNodeById:function(e){var t=Konva.ids[e];return void 0!==t&&this.isAncestorOf(t)?t:null},_getNodesByName:function(e){var t=Konva.names[e]||[];return this._getDescendants(t)},_get:function(e){for(var t=Konva.Node.prototype._get.call(this,e),i=this.getChildren(),n=i.length,a=0;n>a;a++)t=t.concat(i[a]._get(e));return t},toObject:function(){var e=Konva.Node.prototype.toObject.call(this);e.children=[];for(var t=this.getChildren(),i=t.length,n=0;i>n;n++){var a=t[n];e.children.push(a.toObject())}return e},_getDescendants:function(e){for(var t=[],i=e.length,n=0;i>n;n++){var a=e[n];this.isAncestorOf(a)&&t.push(a)}return t},isAncestorOf:function(e){for(var t=e.getParent();t;){if(t._id===this._id)return!0;t=t.getParent()}return!1},clone:function(e){var t=Konva.Node.prototype.clone.call(this,e);return this.getChildren().each(function(e){t.add(e.clone())}),t},getAllIntersections:function(e){var t=[];return this.find("Shape").each(function(i){i.isVisible()&&i.intersects(e)&&t.push(i)}),t},_setChildrenIndices:function(){this.children.each(function(e,t){e.index=t})},drawScene:function(e,t,i){var n=this.getLayer(),a=e||n&&n.getCanvas(),r=a&&a.getContext(),s=this._cache.canvas,o=s&&s.scene;return this.isVisible()&&(!i&&o?(r.save(),n._applyTransform(this,r,t),this._drawCachedSceneCanvas(r),r.restore()):this._drawChildren(a,"drawScene",t,!1,i)),this},drawHit:function(e,t,i){var n=this.getLayer(),a=e||n&&n.hitCanvas,r=a&&a.getContext(),s=this._cache.canvas,o=s&&s.hit;return this.shouldDrawHit(a)&&(n&&n.clearHitCache(),!i&&o?(r.save(),n._applyTransform(this,r,t),this._drawCachedHitCanvas(r),r.restore()):this._drawChildren(a,"drawHit",t)),this},_drawChildren:function(e,t,i,n,a){var r,s,o=this.getLayer(),l=e&&e.getContext(),h=this.getClipWidth(),u=this.getClipHeight(),c=h&&u;c&&o&&(r=this.getClipX(),s=this.getClipY(),l.save(),o._applyTransform(this,l),l.beginPath(),l.rect(r,s,h,u),l.clip(),l.reset()),this.children.each(function(r){r[t](e,i,n,a)}),c&&l.restore()},shouldDrawHit:function(e){var t=this.getLayer(),i=Konva.DD,n=i&&Konva.isDragging()&&-1!==Konva.DD.anim.getLayers().indexOf(t);return e&&e.isCache||t&&t.hitGraphEnabled()&&this.isVisible()&&!n},getClientRect:function(e){var t,i,n,a,r={x:0,y:0,width:0,height:0};return this.children.each(function(e){var r=e.getClientRect();void 0===t?(t=r.x,i=r.y,n=r.x+r.width,a=r.y+r.height):(t=Math.min(t,r.x),i=Math.min(i,r.y),n=Math.max(n,r.x+r.width),a=Math.max(a,r.y+r.height))}),0!==this.children.length&&(r={x:t,y:i,width:n-t,height:a-i}),e?r:this._transformedRect(r)}}),Konva.Util.extend(Konva.Container,Konva.Node),Konva.Container.prototype.get=Konva.Container.prototype.find,Konva.Factory.addComponentsGetterSetter(Konva.Container,"clip",["x","y","width","height"]),Konva.Factory.addGetterSetter(Konva.Container,"clipX"),Konva.Factory.addGetterSetter(Konva.Container,"clipY"),Konva.Factory.addGetterSetter(Konva.Container,"clipWidth"),Konva.Factory.addGetterSetter(Konva.Container,"clipHeight"),Konva.Collection.mapMethods(Konva.Container)}(),function(e){"use strict";function t(e){e.fill()}function i(e){e.stroke()}function n(e){e.fill()}function a(e){e.stroke()}function r(){this._clearCache(o)}function s(){this._clearCache(l)}var o="hasShadow",l="shadowRGBA";e.Shape=function(e){this.__init(e)},e.Util.addMethods(e.Shape,{__init:function(o){this.nodeType="Shape",this._fillFunc=t,this._strokeFunc=i,this._fillFuncHit=n,this._strokeFuncHit=a;for(var l,h=e.shapes;;)if(l=e.Util.getRandomColor(),l&&!(l in h))break;this.colorKey=l,h[l]=this,e.Node.call(this,o),this.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",r),this.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",s)},hasChildren:function(){return!1},getChildren:function(){return[]},getContext:function(){return this.getLayer().getContext()},getCanvas:function(){return this.getLayer().getCanvas()},hasShadow:function(){return this._getCache(o,this._hasShadow)},_hasShadow:function(){return this.getShadowEnabled()&&0!==this.getShadowOpacity()&&!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffsetX()||this.getShadowOffsetY())},getShadowRGBA:function(){return this._getCache(l,this._getShadowRGBA)},_getShadowRGBA:function(){if(this.hasShadow()){var t=e.Util.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.getShadowOpacity()||1)+")"}},hasFill:function(){return!!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientColorStops()||this.getFillRadialGradientColorStops())},hasStroke:function(){return!!this.stroke()},intersects:function(e){var t,i=this.getStage(),n=i.bufferHitCanvas;return n.getContext().clear(),this.drawScene(n),t=n.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data,t[3]>0},destroy:function(){return e.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],this},_useBufferCanvas:function(e){return!e&&this.perfectDrawEnabled()&&1!==this.getAbsoluteOpacity()&&this.hasFill()&&this.hasStroke()&&this.getStage()||this.perfectDrawEnabled()&&this.hasShadow()&&1!==this.getAbsoluteOpacity()&&this.hasFill()&&this.hasStroke()&&this.getStage()},getSelfRect:function(){var e=this.getSize();return{x:this._centroid?Math.round(-e.width/2):0,y:this._centroid?Math.round(-e.height/2):0,width:e.width,height:e.height}},getClientRect:function(e){var t=this.getSelfRect(),i=this.hasStroke()&&this.strokeWidth()||0,n=t.width+i,a=t.height+i,r=this.shadowOffsetX(),s=this.shadowOffsetY(),o=n+Math.abs(r),l=a+Math.abs(s),h=this.hasShadow()&&this.shadowBlur()||0,u=o+2*h,c=l+2*h,d=0;Math.round(i/2)!==i/2&&(d=1);var f={width:u+d,height:c+d,x:-Math.round(i/2+h)+Math.min(r,0)+t.x,y:-Math.round(i/2+h)+Math.min(s,0)+t.y};return e?f:this._transformedRect(f)},drawScene:function(e,t,i,n){var a,r,s,o=this.getLayer(),l=e||o.getCanvas(),h=l.getContext(),u=this._cache.canvas,c=this.sceneFunc(),d=this.hasShadow(),f=this.hasStroke();if(!this.isVisible())return this;if(u)return h.save(),o._applyTransform(this,h,t),this._drawCachedSceneCanvas(h),h.restore(),this;if(!c)return this;if(h.save(),this._useBufferCanvas(i)&&!n){if(a=this.getStage(),r=a.bufferCanvas,s=r.getContext(),s.clear(),s.save(),s._applyLineJoin(this),!i)if(o)o._applyTransform(this,s,t);else{var p=this.getAbsoluteTransform(t).getMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5])}c.call(this,s),s.restore(),d&&!l.hitCanvas?(h.save(),h._applyShadow(this),h._applyOpacity(this),h.drawImage(r._canvas,0,0),h.restore()):(h._applyOpacity(this),h.drawImage(r._canvas,0,0))}else{if(h._applyLineJoin(this),!i)if(o)o._applyTransform(this,h,t);else{var v=this.getAbsoluteTransform(t).getMatrix();h.transform(v[0],v[1],v[2],v[3],v[4],v[5])}d&&f&&!l.hitCanvas?(h.save(),i||h._applyOpacity(this),h._applyShadow(this),c.call(this,h),h.restore(),this.hasFill()&&this.getShadowForStrokeEnabled()&&c.call(this,h)):d&&!l.hitCanvas?(h.save(),i||h._applyOpacity(this),h._applyShadow(this),c.call(this,h),h.restore()):(i||h._applyOpacity(this),c.call(this,h))}return h.restore(),this},drawHit:function(e,t,i){var n=this.getLayer(),a=e||n.hitCanvas,r=a.getContext(),s=this.hitFunc()||this.sceneFunc(),o=this._cache.canvas,l=o&&o.hit;if(!this.shouldDrawHit(a))return this;if(n&&n.clearHitCache(),l)return r.save(),n._applyTransform(this,r,t),this._drawCachedHitCanvas(r),r.restore(),this;if(!s)return this;if(r.save(),r._applyLineJoin(this),!i)if(n)n._applyTransform(this,r,t);else{var h=this.getAbsoluteTransform(t).getMatrix();r.transform(h[0],h[1],h[2],h[3],h[4],h[5])}return s.call(this,r),r.restore(),this},drawHitFromCache:function(t){var i,n,a,r,s,o,l=t||0,h=this._cache.canvas,u=this._getCachedSceneCanvas(),c=h.hit,d=c.getContext(),f=c.getWidth(),p=c.getHeight();d.clear(),d.drawImage(u._canvas,0,0,f,p);try{for(i=d.getImageData(0,0,f,p),n=i.data,a=n.length,r=e.Util._hexToRgb(this.colorKey),s=0;a>s;s+=4)o=n[s+3],o>l?(n[s]=r.r,n[s+1]=r.g,n[s+2]=r.b,n[s+3]=255):n[s+3]=0;d.putImageData(i,0,0)}catch(v){e.Util.error("Unable to draw hit graph from cached scene canvas. "+v.message)}return this}}),e.Util.extend(e.Shape,e.Node),e.Factory.addGetterSetter(e.Shape,"stroke"),e.Factory.addDeprecatedGetterSetter(e.Shape,"strokeRed",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"strokeGreen",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"strokeBlue",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"strokeAlpha",1,e.Validators.alphaComponent),e.Factory.addGetterSetter(e.Shape,"strokeWidth",2),e.Factory.addGetterSetter(e.Shape,"strokeHitEnabled",!0),e.Factory.addGetterSetter(e.Shape,"perfectDrawEnabled",!0),e.Factory.addGetterSetter(e.Shape,"shadowForStrokeEnabled",!0),e.Factory.addGetterSetter(e.Shape,"lineJoin"),e.Factory.addGetterSetter(e.Shape,"lineCap"),e.Factory.addGetterSetter(e.Shape,"sceneFunc"),e.Factory.addGetterSetter(e.Shape,"hitFunc"),e.Factory.addGetterSetter(e.Shape,"dash"),e.Factory.addGetterSetter(e.Shape,"shadowColor"),e.Factory.addDeprecatedGetterSetter(e.Shape,"shadowRed",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"shadowGreen",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"shadowBlue",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"shadowAlpha",1,e.Validators.alphaComponent),e.Factory.addGetterSetter(e.Shape,"shadowBlur"),e.Factory.addGetterSetter(e.Shape,"shadowOpacity"),e.Factory.addComponentsGetterSetter(e.Shape,"shadowOffset",["x","y"]),
e.Factory.addGetterSetter(e.Shape,"shadowOffsetX",0),e.Factory.addGetterSetter(e.Shape,"shadowOffsetY",0),e.Factory.addGetterSetter(e.Shape,"fillPatternImage"),e.Factory.addGetterSetter(e.Shape,"fill"),e.Factory.addDeprecatedGetterSetter(e.Shape,"fillRed",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"fillGreen",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"fillBlue",0,e.Validators.RGBComponent),e.Factory.addDeprecatedGetterSetter(e.Shape,"fillAlpha",1,e.Validators.alphaComponent),e.Factory.addGetterSetter(e.Shape,"fillPatternX",0),e.Factory.addGetterSetter(e.Shape,"fillPatternY",0),e.Factory.addGetterSetter(e.Shape,"fillLinearGradientColorStops"),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientStartRadius",0),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientEndRadius",0),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientColorStops"),e.Factory.addGetterSetter(e.Shape,"fillPatternRepeat","repeat"),e.Factory.addGetterSetter(e.Shape,"fillEnabled",!0),e.Factory.addGetterSetter(e.Shape,"strokeEnabled",!0),e.Factory.addGetterSetter(e.Shape,"shadowEnabled",!0),e.Factory.addGetterSetter(e.Shape,"dashEnabled",!0),e.Factory.addGetterSetter(e.Shape,"strokeScaleEnabled",!0),e.Factory.addGetterSetter(e.Shape,"fillPriority","color"),e.Factory.addComponentsGetterSetter(e.Shape,"fillPatternOffset",["x","y"]),e.Factory.addGetterSetter(e.Shape,"fillPatternOffsetX",0),e.Factory.addGetterSetter(e.Shape,"fillPatternOffsetY",0),e.Factory.addComponentsGetterSetter(e.Shape,"fillPatternScale",["x","y"]),e.Factory.addGetterSetter(e.Shape,"fillPatternScaleX",1),e.Factory.addGetterSetter(e.Shape,"fillPatternScaleY",1),e.Factory.addComponentsGetterSetter(e.Shape,"fillLinearGradientStartPoint",["x","y"]),e.Factory.addGetterSetter(e.Shape,"fillLinearGradientStartPointX",0),e.Factory.addGetterSetter(e.Shape,"fillLinearGradientStartPointY",0),e.Factory.addComponentsGetterSetter(e.Shape,"fillLinearGradientEndPoint",["x","y"]),e.Factory.addGetterSetter(e.Shape,"fillLinearGradientEndPointX",0),e.Factory.addGetterSetter(e.Shape,"fillLinearGradientEndPointY",0),e.Factory.addComponentsGetterSetter(e.Shape,"fillRadialGradientStartPoint",["x","y"]),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientStartPointX",0),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientStartPointY",0),e.Factory.addComponentsGetterSetter(e.Shape,"fillRadialGradientEndPoint",["x","y"]),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientEndPointX",0),e.Factory.addGetterSetter(e.Shape,"fillRadialGradientEndPointY",0),e.Factory.addGetterSetter(e.Shape,"fillPatternRotation",0),e.Factory.backCompat(e.Shape,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),e.Collection.mapMethods(e.Shape)}(Konva),function(){"use strict";function e(e,t){e.content.addEventListener(t,function(i){e[A+t](i)},!1)}var t="Stage",i="string",n="px",a="mouseout",r="mouseleave",s="mouseover",o="mouseenter",l="mousemove",h="mousedown",u="mouseup",c="click",d="dblclick",f="touchstart",p="touchend",v="tap",m="dbltap",g="touchmove",b="DOMMouseScroll",y="mousewheel",_="wheel",x="contentMouseout",k="contentMouseover",w="contentMousemove",S="contentMousedown",C="contentMouseup",P="contentClick",T="contentDblclick",$="contentTouchstart",K="contentTouchend",M="contentDbltap",L="contentTap",D="contentTouchmove",F="div",O="relative",j="konvajs-content",E=" ",A="_",R="container",G="",N=[h,l,u,a,f,g,p,s,b,y,_],I=N.length;Konva.Stage=function(e){this.___init(e)},Konva.Util.addMethods(Konva.Stage,{___init:function(e){this.nodeType=t,Konva.Container.call(this,e),this._id=Konva.idCounter++,this._buildDOM(),this._bindContentEvents(),this._enableNestedTransforms=!1,Konva.stages.push(this)},_validateAdd:function(e){"Layer"!==e.getType()&&Konva.Util["throw"]("You may only add layers to the stage.")},setContainer:function(e){if(typeof e===i){var t=e;if(e=Konva.document.getElementById(e),!e)throw"Can not find container in document with id "+t}return this._setAttr(R,e),this},shouldDrawHit:function(){return!0},draw:function(){return Konva.Node.prototype.draw.call(this),this},setHeight:function(e){return Konva.Node.prototype.setHeight.call(this,e),this._resizeDOM(),this},setWidth:function(e){return Konva.Node.prototype.setWidth.call(this,e),this._resizeDOM(),this},clear:function(){var e,t=this.children,i=t.length;for(e=0;i>e;e++)t[e].clear();return this},clone:function(e){return e||(e={}),e.container=Konva.document.createElement(F),Konva.Container.prototype.clone.call(this,e)},destroy:function(){var e=this.content;Konva.Container.prototype.destroy.call(this),e&&Konva.Util._isInDocument(e)&&this.getContainer().removeChild(e);var t=Konva.stages.indexOf(this);return t>-1&&Konva.stages.splice(t,1),this},getPointerPosition:function(){return this.pointerPos},getStage:function(){return this},getContent:function(){return this.content},toDataURL:function(e){e=e||{};var t=e.mimeType||null,i=e.quality||null,n=e.x||0,a=e.y||0,r=new Konva.SceneCanvas({width:e.width||this.getWidth(),height:e.height||this.getHeight(),pixelRatio:e.pixelRatio}),s=r.getContext()._context,o=this.children;(n||a)&&s.translate(-1*n,-1*a),o.each(function(e){var t=e.getCanvas().getWidth(),i=e.getCanvas().getHeight(),n=e.getCanvas().getPixelRatio();s.drawImage(e.getCanvas()._canvas,0,0,t/n,i/n)});var l=r.toDataURL(t,i);return e.callback&&e.callback(l),l},toImage:function(e){var t=e.callback;e.callback=function(e){Konva.Util._getImage(e,function(e){t(e)})},this.toDataURL(e)},getIntersection:function(e,t){var i,n,a=this.getChildren(),r=a.length,s=r-1;for(i=s;i>=0;i--)if(n=a[i].getIntersection(e,t))return n;return null},_resizeDOM:function(){if(this.content){var e,t,i=this.getWidth(),a=this.getHeight(),r=this.getChildren(),s=r.length;for(this.content.style.width=i+n,this.content.style.height=a+n,this.bufferCanvas.setSize(i,a),this.bufferHitCanvas.setSize(i,a),e=0;s>e;e++)t=r[e],t.setSize(i,a),t.draw()}},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return Konva.Container.prototype.add.call(this,e),e._setCanvasSize(this.width(),this.height()),e.draw(),this.content.appendChild(e.canvas._canvas),this},getParent:function(){return null},getLayer:function(){return null},getLayers:function(){return this.getChildren()},_bindContentEvents:function(){for(var t=0;I>t;t++)e(this,N[t])},_mouseover:function(e){Konva.UA.mobile||(this._setPointerPosition(e),this._fire(k,{evt:e}))},_mouseout:function(e){if(!Konva.UA.mobile){this._setPointerPosition(e);var t=this.targetShape;t&&!Konva.isDragging()&&(t._fireAndBubble(a,{evt:e}),t._fireAndBubble(r,{evt:e}),this.targetShape=null),this.pointerPos=void 0,this._fire(x,{evt:e})}},_mousemove:function(e){if(Konva.UA.ieMobile)return this._touchmove(e);if(("undefined"!=typeof e.movementX||"undefined"!=typeof e.movementY)&&0===e.movementY&&0===e.movementX)return null;if(Konva.UA.mobile)return null;this._setPointerPosition(e);var t;Konva.isDragging()||(t=this.getIntersection(this.getPointerPosition()),t&&t.isListening()?Konva.isDragging()||this.targetShape&&this.targetShape._id===t._id?t._fireAndBubble(l,{evt:e}):(this.targetShape&&(this.targetShape._fireAndBubble(a,{evt:e},t),this.targetShape._fireAndBubble(r,{evt:e},t)),t._fireAndBubble(s,{evt:e},this.targetShape),t._fireAndBubble(o,{evt:e},this.targetShape),this.targetShape=t):this.targetShape&&!Konva.isDragging()&&(this.targetShape._fireAndBubble(a,{evt:e}),this.targetShape._fireAndBubble(r,{evt:e}),this.targetShape=null),this._fire(w,{evt:e})),e.preventDefault&&e.preventDefault()},_mousedown:function(e){if(Konva.UA.ieMobile)return this._touchstart(e);if(!Konva.UA.mobile){this._setPointerPosition(e);var t=this.getIntersection(this.getPointerPosition());Konva.listenClickTap=!0,t&&t.isListening()&&(this.clickStartShape=t,t._fireAndBubble(h,{evt:e})),this._fire(S,{evt:e})}e.preventDefault&&e.preventDefault()},_mouseup:function(e){if(Konva.UA.ieMobile)return this._touchend(e);if(!Konva.UA.mobile){this._setPointerPosition(e);var t=this.getIntersection(this.getPointerPosition()),i=this.clickStartShape,n=!1,a=Konva.DD;Konva.inDblClickWindow?(n=!0,Konva.inDblClickWindow=!1):a&&a.justDragged?a&&(a.justDragged=!1):Konva.inDblClickWindow=!0,setTimeout(function(){Konva.inDblClickWindow=!1},Konva.dblClickWindow),t&&t.isListening()&&(t._fireAndBubble(u,{evt:e}),Konva.listenClickTap&&i&&i._id===t._id&&(t._fireAndBubble(c,{evt:e}),n&&t._fireAndBubble(d,{evt:e}))),this._fire(C,{evt:e}),Konva.listenClickTap&&(this._fire(P,{evt:e}),n&&this._fire(T,{evt:e})),Konva.listenClickTap=!1}e.preventDefault&&e.preventDefault()},_touchstart:function(e){this._setPointerPosition(e);var t=this.getIntersection(this.getPointerPosition());Konva.listenClickTap=!0,t&&t.isListening()&&(this.tapStartShape=t,t._fireAndBubble(f,{evt:e}),t.isListening()&&e.preventDefault&&e.preventDefault()),this._fire($,{evt:e})},_touchend:function(e){this._setPointerPosition(e);var t=this.getIntersection(this.getPointerPosition()),i=!1;Konva.inDblClickWindow?(i=!0,Konva.inDblClickWindow=!1):Konva.inDblClickWindow=!0,setTimeout(function(){Konva.inDblClickWindow=!1},Konva.dblClickWindow),t&&t.isListening()&&(t._fireAndBubble(p,{evt:e}),Konva.listenClickTap&&t._id===this.tapStartShape._id&&(t._fireAndBubble(v,{evt:e}),i&&t._fireAndBubble(m,{evt:e})),t.isListening()&&e.preventDefault&&e.preventDefault()),this._fire(K,{evt:e}),Konva.listenClickTap&&(this._fire(L,{evt:e}),i&&this._fire(M,{evt:e})),Konva.listenClickTap=!1},_touchmove:function(e){this._setPointerPosition(e);var t,i=Konva.DD;Konva.isDragging()||(t=this.getIntersection(this.getPointerPosition()),t&&t.isListening()&&(t._fireAndBubble(g,{evt:e}),t.isListening()&&e.preventDefault&&e.preventDefault()),this._fire(D,{evt:e})),i&&Konva.isDragging()&&e.preventDefault()},_DOMMouseScroll:function(e){this._mousewheel(e)},_mousewheel:function(e){this._setPointerPosition(e);var t=this.getIntersection(this.getPointerPosition());t&&t.isListening()&&t._fireAndBubble(y,{evt:e})},_wheel:function(e){this._mousewheel(e)},_setPointerPosition:function(e){var t=this._getContentPosition(),i=null,n=null;if(e=e?e:window.event,void 0!==e.touches){if(e.touches.length>0){var a=e.touches[0];i=a.clientX-t.left,n=a.clientY-t.top}}else i=e.clientX-t.left,n=e.clientY-t.top;null!==i&&null!==n&&(this.pointerPos={x:i,y:n})},_getContentPosition:function(){var e=this.content.getBoundingClientRect?this.content.getBoundingClientRect():{top:0,left:0};return{top:e.top,left:e.left}},_buildDOM:function(){var e=this.getContainer();if(!e){if(Konva.Util.isBrowser())throw"Stage has no container. A container is required.";e=Konva.document.createElement(F)}e.innerHTML=G,this.content=Konva.document.createElement(F),this.content.style.position=O,this.content.className=j,this.content.setAttribute("role","presentation"),e.appendChild(this.content),this.bufferCanvas=new Konva.SceneCanvas({pixelRatio:1}),this.bufferHitCanvas=new Konva.HitCanvas,this._resizeDOM()},_onContent:function(e,t){var i,n,a=e.split(E),r=a.length;for(i=0;r>i;i++)n=a[i],this.content.addEventListener(n,t,!1)},cache:function(){Konva.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.")},clearCache:function(){}}),Konva.Util.extend(Konva.Stage,Konva.Container),Konva.Factory.addGetter(Konva.Stage,"container"),Konva.Factory.addOverloadedGetterSetter(Konva.Stage,"container")}(),function(){"use strict";Konva.BaseLayer=function(e){this.___init(e)},Konva.Util.addMethods(Konva.BaseLayer,{___init:function(e){this.nodeType="Layer",Konva.Container.call(this,e)},createPNGStream:function(){return this.canvas._canvas.createPNGStream()},getCanvas:function(){return this.canvas},getHitCanvas:function(){return this.hitCanvas},getContext:function(){return this.getCanvas().getContext()},clear:function(e){return this.getContext().clear(e),this},clearHitCache:function(){this._hitImageData=void 0},setZIndex:function(e){Konva.Node.prototype.setZIndex.call(this,e);var t=this.getStage();return t&&(t.content.removeChild(this.getCanvas()._canvas),e<t.getChildren().length-1?t.content.insertBefore(this.getCanvas()._canvas,t.getChildren()[e+1].getCanvas()._canvas):t.content.appendChild(this.getCanvas()._canvas)),this},moveToTop:function(){Konva.Node.prototype.moveToTop.call(this);var e=this.getStage();return e&&(e.content.removeChild(this.getCanvas()._canvas),e.content.appendChild(this.getCanvas()._canvas)),this},moveUp:function(){var e=Konva.Node.prototype.moveUp.call(this);if(!e)return this;var t=this.getStage();return t?(t.content.removeChild(this.getCanvas()._canvas),this.index<t.getChildren().length-1?t.content.insertBefore(this.getCanvas()._canvas,t.getChildren()[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getCanvas()._canvas),this):this},moveDown:function(){if(Konva.Node.prototype.moveDown.call(this)){var e=this.getStage();if(e){var t=e.getChildren();e.content.removeChild(this.getCanvas()._canvas),e.content.insertBefore(this.getCanvas()._canvas,t[this.index+1].getCanvas()._canvas)}}return this},moveToBottom:function(){if(Konva.Node.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var t=e.getChildren();e.content.removeChild(this.getCanvas()._canvas),e.content.insertBefore(this.getCanvas()._canvas,t[1].getCanvas()._canvas)}}return this},getLayer:function(){return this},remove:function(){var e=this.getCanvas()._canvas;return Konva.Node.prototype.remove.call(this),e&&e.parentNode&&Konva.Util._isInDocument(e)&&e.parentNode.removeChild(e),this},getStage:function(){return this.parent},setSize:function(e,t){return this.canvas.setSize(e,t),this},getWidth:function(){return this.parent?this.parent.getWidth():void 0},setWidth:function(){Konva.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')},getHeight:function(){return this.parent?this.parent.getHeight():void 0},setHeight:function(){Konva.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')},_applyTransform:function(e,t,i){var n=e.getAbsoluteTransform(i).getMatrix();t.transform(n[0],n[1],n[2],n[3],n[4],n[5])}}),Konva.Util.extend(Konva.BaseLayer,Konva.Container),Konva.Factory.addGetterSetter(Konva.BaseLayer,"clearBeforeDraw",!0),Konva.Collection.mapMethods(Konva.BaseLayer)}(),function(){"use strict";var e="#",t="beforeDraw",i="draw",n=[{x:0,y:0},{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}],a=n.length;Konva.Layer=function(e){this.____init(e)},Konva.Util.addMethods(Konva.Layer,{____init:function(e){this.nodeType="Layer",this.canvas=new Konva.SceneCanvas,this.hitCanvas=new Konva.HitCanvas({pixelRatio:1}),Konva.BaseLayer.call(this,e)},_setCanvasSize:function(e,t){this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t)},_validateAdd:function(e){var t=e.getType();"Group"!==t&&"Shape"!==t&&Konva.Util["throw"]("You may only add groups and shapes to a layer.")},getIntersection:function(e,t){var i,r,s,o;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(var l=1,h=!1;;){for(r=0;a>r;r++){if(s=n[r],i=this._getIntersection({x:e.x+s.x*l,y:e.y+s.y*l}),o=i.shape,o&&t)return o.findAncestor(t,!0);if(o)return o;if(h=!!i.antialiased,!i.antialiased)break}if(!h)return null;l+=1}},_getImageData:function(e,t){var i=this.hitCanvas.width||1,n=this.hitCanvas.height||1,a=Math.round(t)*i+Math.round(e);return this._hitImageData||(this._hitImageData=this.hitCanvas.context.getImageData(0,0,i,n)),[this._hitImageData.data[4*a+0],this._hitImageData.data[4*a+1],this._hitImageData.data[4*a+2],this._hitImageData.data[4*a+3]]},_getIntersection:function(t){var i,n,a=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(t.x*a),Math.round(t.y*a),1,1).data,s=r[3];return 255===s?(i=Konva.Util._rgbToHex(r[0],r[1],r[2]),n=Konva.shapes[e+i],n?{shape:n}:{antialiased:!0}):s>0?{antialiased:!0}:{}},drawScene:function(e,n){var a=this.getLayer(),r=e||a&&a.getCanvas();return this._fire(t,{node:this}),this.getClearBeforeDraw()&&r.getContext().clear(),Konva.Container.prototype.drawScene.call(this,r,n),this._fire(i,{node:this}),this},drawHit:function(e,t){var i=this.getLayer(),n=e||i&&i.hitCanvas;return i&&i.getClearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Konva.Container.prototype.drawHit.call(this,n,t),this.imageData=null,this},clear:function(e){return Konva.BaseLayer.prototype.clear.call(this,e),this.getHitCanvas().getContext().clear(e),this.imageData=null,this},setVisible:function(e){return Konva.Node.prototype.setVisible.call(this,e),e?(this.getCanvas()._canvas.style.display="block",this.hitCanvas._canvas.style.display="block"):(this.getCanvas()._canvas.style.display="none",this.hitCanvas._canvas.style.display="none"),this},enableHitGraph:function(){return this.setHitGraphEnabled(!0),this},disableHitGraph:function(){return this.setHitGraphEnabled(!1),this},setSize:function(e,t){return Konva.BaseLayer.prototype.setSize.call(this,e,t),this.hitCanvas.setSize(e,t),this}}),Konva.Util.extend(Konva.Layer,Konva.BaseLayer),Konva.Factory.addGetterSetter(Konva.Layer,"hitGraphEnabled",!0),Konva.Collection.mapMethods(Konva.Layer)}(),function(){"use strict";Konva.FastLayer=function(e){this.____init(e)},Konva.Util.addMethods(Konva.FastLayer,{____init:function(e){this.nodeType="Layer",this.canvas=new Konva.SceneCanvas,Konva.BaseLayer.call(this,e)},_validateAdd:function(e){var t=e.getType();"Shape"!==t&&Konva.Util["throw"]("You may only add shapes to a fast layer.")},_setCanvasSize:function(e,t){this.canvas.setSize(e,t)},hitGraphEnabled:function(){return!1},getIntersection:function(){return null},drawScene:function(e){var t=this.getLayer(),i=e||t&&t.getCanvas();return this.getClearBeforeDraw()&&i.getContext().clear(),Konva.Container.prototype.drawScene.call(this,i),this},draw:function(){return this.drawScene(),this},setVisible:function(e){return Konva.Node.prototype.setVisible.call(this,e),e?this.getCanvas()._canvas.style.display="block":this.getCanvas()._canvas.style.display="none",this}}),Konva.Util.extend(Konva.FastLayer,Konva.BaseLayer),Konva.Collection.mapMethods(Konva.FastLayer)}(),function(){"use strict";Konva.Group=function(e){this.___init(e)},Konva.Util.addMethods(Konva.Group,{___init:function(e){this.nodeType="Group",Konva.Container.call(this,e)},_validateAdd:function(e){var t=e.getType();"Group"!==t&&"Shape"!==t&&Konva.Util["throw"]("You may only add groups and shapes to groups.")}}),Konva.Util.extend(Konva.Group,Konva.Container),Konva.Collection.mapMethods(Konva.Group)}(),function(e){"use strict";function t(e){setTimeout(e,1e3/60)}function i(){return r.apply(e.global,arguments)}var n=500,a=function(){return e.global.performance&&e.global.performance.now?function(){return e.global.performance.now()}:function(){return(new Date).getTime()}}(),r=function(){return e.global.requestAnimationFrame||e.global.webkitRequestAnimationFrame||e.global.mozRequestAnimationFrame||e.global.oRequestAnimationFrame||e.global.msRequestAnimationFrame||t}();e.Animation=function(t,i){var n=e.Animation;this.func=t,this.setLayers(i),this.id=n.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:a()}},e.Animation.prototype={setLayers:function(e){var t=[];return t=e?e.length>0?e:[e]:[],this.layers=t,this},getLayers:function(){return this.layers},addLayer:function(e){var t,i=this.layers,n=i.length;for(t=0;n>t;t++)if(i[t]._id===e._id)return!1;return this.layers.push(e),!0},isRunning:function(){var t,i=e.Animation,n=i.animations,a=n.length;for(t=0;a>t;t++)if(n[t].id===this.id)return!0;return!1},start:function(){var t=e.Animation;return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=a(),t._addAnimation(this),this},stop:function(){return e.Animation._removeAnimation(this),this},_updateFrameObject:function(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}},e.Animation.animations=[],e.Animation.animIdCounter=0,e.Animation.animRunning=!1,e.Animation._addAnimation=function(e){this.animations.push(e),this._handleAnimation()},e.Animation._removeAnimation=function(e){var t,i=e.id,n=this.animations,a=n.length;for(t=0;a>t;t++)if(n[t].id===i){this.animations.splice(t,1);break}},e.Animation._runFrames=function(){var e,t,i,n,r,s,o,l,h,u={},c=this.animations;for(n=0;n<c.length;n++)if(e=c[n],t=e.layers,i=e.func,e._updateFrameObject(a()),s=t.length,h=i?i.call(e,e.frame)!==!1:!0)for(r=0;s>r;r++)o=t[r],void 0!==o._id&&(u[o._id]=o);for(l in u)u.hasOwnProperty(l)&&u[l].draw()},e.Animation._animationLoop=function(){var t=e.Animation;t.animations.length?(i(t._animationLoop),t._runFrames()):t.animRunning=!1},e.Animation._handleAnimation=function(){this.animRunning||(this.animRunning=!0,this._animationLoop())},e.BaseLayer.prototype.batchDraw=function(){var t=this,i=e.Animation;return this.batchAnim||(this.batchAnim=new i(function(){t.lastBatchDrawTime&&a()-t.lastBatchDrawTime>n&&t.batchAnim.stop()},this)),this.lastBatchDrawTime=a(),this.batchAnim.isRunning()||(this.draw(),this.batchAnim.start()),this},e.Stage.prototype.batchDraw=function(){return this.getChildren().each(function(e){e.batchDraw()}),this}}(Konva),function(){"use strict";var e={node:1,duration:1,easing:1,onFinish:1,yoyo:1},t=1,i=2,n=3,a=0,r=["fill","stroke","shadowColor"],s=function(e,t,i,n,a,r,s){this.prop=e,this.propFunc=t,this.begin=n,this._pos=n,this.duration=r,this._change=0,this.prevPos=0,this.yoyo=s,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=a-this.begin,this.pause()};s.prototype={fire:function(e){var t=this[e];t&&t()},setTime:function(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():0>e?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())},getTime:function(){return this._time},setPosition:function(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e},getPosition:function(e){return void 0===e&&(e=this._time),this.func(e,this.begin,this._change,this.duration)},play:function(){this.state=i,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},reverse:function(){this.state=n,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},seek:function(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")},reset:function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},finish:function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},update:function(){this.setPosition(this.getPosition(this._time))},onEnterFrame:function(){var e=this.getTimer()-this._startTime;this.state===i?this.setTime(e):this.state===n&&this.setTime(this.duration-e)},pause:function(){this.state=t,this.fire("onPause")},getTimer:function(){return(new Date).getTime()}},Konva.Tween=function(t){var i,n,r=this,o=t.node,l=o._id,h=t.easing||Konva.Easings.Linear,u=!!t.yoyo;i="undefined"==typeof t.duration?1:0===t.duration?.001:t.duration,this.node=o,this._id=a++,this.anim=new Konva.Animation(function(){r.tween.onEnterFrame()},o.getLayer()||(o instanceof Konva.Stage?o.getLayers():null)),this.tween=new s(n,function(e){r._tweenFunc(e)},h,0,1,1e3*i,u),this._addListeners(),Konva.Tween.attrs[l]||(Konva.Tween.attrs[l]={}),Konva.Tween.attrs[l][this._id]||(Konva.Tween.attrs[l][this._id]={}),Konva.Tween.tweens[l]||(Konva.Tween.tweens[l]={});for(n in t)void 0===e[n]&&this._addAttr(n,t[n]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset},Konva.Tween.attrs={},Konva.Tween.tweens={},Konva.Tween.prototype={_addAttr:function(e,t){var i,n,a,s,o,l,h,u=this.node,c=u._id;if(a=Konva.Tween.tweens[c][e],a&&delete Konva.Tween.attrs[c][a][e],i=u.getAttr(e),Konva.Util._isArray(t))for(n=[],o=Math.max(t.length,i.length),"points"===e&&t.length!==i.length&&(t.length>i.length?(h=i,i=Konva.Util._prepareArrayForTween(i,t,u.closed())):(l=t,t=Konva.Util._prepareArrayForTween(t,i,u.closed()))),s=0;o>s;s++)n.push(t[s]-i[s]);else if(-1!==r.indexOf(e)){i=Konva.Util.colorToRGBA(i);var d=Konva.Util.colorToRGBA(t);n={r:d.r-i.r,g:d.g-i.g,b:d.b-i.b,a:d.a-i.a}}else n=t-i;Konva.Tween.attrs[c][this._id][e]={start:i,diff:n,end:t,trueEnd:l,trueStart:h},Konva.Tween.tweens[c][e]=this._id},_tweenFunc:function(e){var t,i,n,a,s,o,l,h,u=this.node,c=Konva.Tween.attrs[u._id][this._id];for(t in c){if(i=c[t],n=i.start,a=i.diff,h=i.end,Konva.Util._isArray(n))for(s=[],l=Math.max(n.length,h.length),o=0;l>o;o++)s.push((n[o]||0)+a[o]*e);else s=-1!==r.indexOf(t)?"rgba("+Math.round(n.r+a.r*e)+","+Math.round(n.g+a.g*e)+","+Math.round(n.b+a.b*e)+","+(n.a+a.a*e)+")":n+a*e;u.setAttr(t,s)}},_addListeners:function(){var e=this;this.tween.onPlay=function(){e.anim.start()},this.tween.onReverse=function(){e.anim.start()},this.tween.onPause=function(){e.anim.stop()},this.tween.onFinish=function(){var t=e.node,i=Konva.Tween.attrs[t._id][e._id];i.points&&i.points.trueEnd&&t.points(i.points.trueEnd),e.onFinish&&e.onFinish.call(e)},this.tween.onReset=function(){var t=e.node,i=Konva.Tween.attrs[t._id][e._id];i.points&&i.points.trueStart&&t.points(i.points.trueStart),e.onReset&&e.onReset()}},play:function(){return this.tween.play(),this},reverse:function(){return this.tween.reverse(),this},reset:function(){return this.tween.reset(),this},seek:function(e){return this.tween.seek(1e3*e),this},pause:function(){return this.tween.pause(),this},finish:function(){return this.tween.finish(),this},destroy:function(){var e,t=this.node._id,i=this._id,n=Konva.Tween.tweens[t];this.pause();for(e in n)delete Konva.Tween.tweens[t][e];delete Konva.Tween.attrs[t][i]}},Konva.Node.prototype.to=function(e){var t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()};var i=new Konva.Tween(e);i.play()},Konva.Easings={BackEaseIn:function(e,t,i,n){var a=1.70158;return i*(e/=n)*e*((a+1)*e-a)+t},BackEaseOut:function(e,t,i,n){var a=1.70158;return i*((e=e/n-1)*e*((a+1)*e+a)+1)+t},BackEaseInOut:function(e,t,i,n){var a=1.70158;return(e/=n/2)<1?i/2*(e*e*(((a*=1.525)+1)*e-a))+t:i/2*((e-=2)*e*(((a*=1.525)+1)*e+a)+2)+t},ElasticEaseIn:function(e,t,i,n,a,r){var s=0;return 0===e?t:1===(e/=n)?t+i:(r||(r=.3*n),!a||a<Math.abs(i)?(a=i,s=r/4):s=r/(2*Math.PI)*Math.asin(i/a),-(a*Math.pow(2,10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/r))+t)},ElasticEaseOut:function(e,t,i,n,a,r){var s=0;return 0===e?t:1===(e/=n)?t+i:(r||(r=.3*n),!a||a<Math.abs(i)?(a=i,s=r/4):s=r/(2*Math.PI)*Math.asin(i/a),a*Math.pow(2,-10*e)*Math.sin((e*n-s)*(2*Math.PI)/r)+i+t)},ElasticEaseInOut:function(e,t,i,n,a,r){var s=0;return 0===e?t:2===(e/=n/2)?t+i:(r||(r=n*(.3*1.5)),!a||a<Math.abs(i)?(a=i,s=r/4):s=r/(2*Math.PI)*Math.asin(i/a),1>e?-.5*(a*Math.pow(2,10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/r))+t:a*Math.pow(2,-10*(e-=1))*Math.sin((e*n-s)*(2*Math.PI)/r)*.5+i+t)},BounceEaseOut:function(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},BounceEaseIn:function(e,t,i,n){return i-Konva.Easings.BounceEaseOut(n-e,0,i,n)+t},BounceEaseInOut:function(e,t,i,n){return n/2>e?.5*Konva.Easings.BounceEaseIn(2*e,0,i,n)+t:.5*Konva.Easings.BounceEaseOut(2*e-n,0,i,n)+.5*i+t},EaseIn:function(e,t,i,n){return i*(e/=n)*e+t},EaseOut:function(e,t,i,n){return-i*(e/=n)*(e-2)+t},EaseInOut:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},StrongEaseIn:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},StrongEaseOut:function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},StrongEaseInOut:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},Linear:function(e,t,i,n){return i*e/n+t}}}(),function(){"use strict";Konva.DD={anim:new Konva.Animation(function(){var e=this.dirty;return this.dirty=!1,e}),isDragging:!1,justDragged:!1,offset:{x:0,y:0},node:null,_drag:function(e){var t=Konva.DD,i=t.node;if(i){if(!t.isDragging){var n=i.getStage().getPointerPosition(),a=i.dragDistance(),r=Math.max(Math.abs(n.x-t.startPointerPos.x),Math.abs(n.y-t.startPointerPos.y));if(a>r)return}i.getStage()._setPointerPosition(e),i._setDragPosition(e),t.isDragging||(t.isDragging=!0,i.fire("dragstart",{type:"dragstart",target:i,evt:e},!0)),i.fire("dragmove",{type:"dragmove",target:i,evt:e},!0)}},_endDragBefore:function(e){var t,i=Konva.DD,n=i.node;n&&(t=n.getLayer(),i.anim.stop(),i.isDragging&&(i.isDragging=!1,i.justDragged=!0,Konva.listenClickTap=!1,e&&(e.dragEndNode=n)),delete i.node,(t||n).draw())},_endDragAfter:function(e){e=e||{};var t=e.dragEndNode;e&&t&&t.fire("dragend",{type:"dragend",target:t,evt:e},!0)}},Konva.Node.prototype.startDrag=function(){var e=Konva.DD,t=this.getStage(),i=this.getLayer(),n=t.getPointerPosition(),a=this.getAbsolutePosition();n&&(e.node&&e.node.stopDrag(),e.node=this,e.startPointerPos=n,e.offset.x=n.x-a.x,e.offset.y=n.y-a.y,e.anim.setLayers(i||this.getLayers()),e.anim.start(),this._setDragPosition())},Konva.Node.prototype._setDragPosition=function(e){var t=Konva.DD,i=this.getStage().getPointerPosition(),n=this.getDragBoundFunc();if(i){var a={x:i.x-t.offset.x,y:i.y-t.offset.y};void 0!==n&&(a=n.call(this,a,e)),this.setAbsolutePosition(a),this._lastPos&&this._lastPos.x===a.x&&this._lastPos.y===a.y||(t.anim.dirty=!0),this._lastPos=a}},Konva.Node.prototype.stopDrag=function(){var e=Konva.DD,t={};e._endDragBefore(t),e._endDragAfter(t)},Konva.Node.prototype.setDraggable=function(e){this._setAttr("draggable",e),this._dragChange()};var e=Konva.Node.prototype.destroy;Konva.Node.prototype.destroy=function(){var t=Konva.DD;t.node&&t.node._id===this._id&&this.stopDrag(),e.call(this)},Konva.Node.prototype.isDragging=function(){var e=Konva.DD;return!(!e.node||e.node._id!==this._id||!e.isDragging)},Konva.Node.prototype._listenDrag=function(){var e=this;this._dragCleanup(),"Stage"===this.getClassName()?this.on("contentMousedown.konva contentTouchstart.konva",function(t){Konva.DD.node||e.startDrag(t)}):this.on("mousedown.konva touchstart.konva",function(t){1!==t.evt.button&&2!==t.evt.button&&(Konva.DD.node||e.startDrag(t))})},Konva.Node.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage(),t=Konva.DD;e&&t.node&&t.node._id===this._id&&t.node.stopDrag()}},Konva.Node.prototype._dragCleanup=function(){"Stage"===this.getClassName()?(this.off("contentMousedown.konva"),this.off("contentTouchstart.konva")):(this.off("mousedown.konva"),this.off("touchstart.konva"))},Konva.Factory.addGetterSetter(Konva.Node,"dragBoundFunc"),Konva.Factory.addGetter(Konva.Node,"draggable",!1),Konva.Factory.addOverloadedGetterSetter(Konva.Node,"draggable");var t=Konva.document.documentElement;t.addEventListener("mouseup",Konva.DD._endDragBefore,!0),t.addEventListener("touchend",Konva.DD._endDragBefore,!0),t.addEventListener("mousemove",Konva.DD._drag),t.addEventListener("touchmove",Konva.DD._drag),t.addEventListener("mouseup",Konva.DD._endDragAfter,!1),t.addEventListener("touchend",Konva.DD._endDragAfter,!1)}(),function(){"use strict";Konva.Rect=function(e){this.___init(e)},Konva.Rect.prototype={___init:function(e){Konva.Shape.call(this,e),this.className="Rect",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t=this.getCornerRadius(),i=this.getWidth(),n=this.getHeight();e.beginPath(),t?(t=Math.min(t,i/2,n/2),e.moveTo(t,0),e.lineTo(i-t,0),e.arc(i-t,t,t,3*Math.PI/2,0,!1),e.lineTo(i,n-t),e.arc(i-t,n-t,t,0,Math.PI/2,!1),e.lineTo(t,n),e.arc(t,n-t,t,Math.PI/2,Math.PI,!1),e.lineTo(0,t),e.arc(t,t,t,Math.PI,3*Math.PI/2,!1)):e.rect(0,0,i,n),e.closePath(),e.fillStrokeShape(this)}},Konva.Util.extend(Konva.Rect,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Rect,"cornerRadius",0),Konva.Collection.mapMethods(Konva.Rect)}(),function(){"use strict";var e=2*Math.PI-1e-4,t="Circle";Konva.Circle=function(e){this.___init(e)},Konva.Circle.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className=t,this.sceneFunc(this._sceneFunc);
},_sceneFunc:function(t){t.beginPath(),t.arc(0,0,this.getRadius(),0,e,!1),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.radius()!==e/2&&this.setRadius(e/2)},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.radius()!==e/2&&this.setRadius(e/2)}},Konva.Util.extend(Konva.Circle,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Circle,"radius",0),Konva.Factory.addOverloadedGetterSetter(Konva.Circle,"radius"),Konva.Collection.mapMethods(Konva.Circle)}(),function(){"use strict";var e=2*Math.PI-1e-4,t="Ellipse";Konva.Ellipse=function(e){this.___init(e)},Konva.Ellipse.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className=t,this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){var i=this.getRadiusX(),n=this.getRadiusY();t.beginPath(),t.save(),i!==n&&t.scale(1,n/i),t.arc(0,0,i,0,e,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadiusX()},getHeight:function(){return 2*this.getRadiusY()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.setRadius({x:e/2})},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.setRadius({y:e/2})}},Konva.Util.extend(Konva.Ellipse,Konva.Shape),Konva.Factory.addComponentsGetterSetter(Konva.Ellipse,"radius",["x","y"]),Konva.Factory.addGetterSetter(Konva.Ellipse,"radiusX",0),Konva.Factory.addGetterSetter(Konva.Ellipse,"radiusY",0),Konva.Collection.mapMethods(Konva.Ellipse)}(),function(){"use strict";var e=2*Math.PI-1e-4;Konva.Ring=function(e){this.___init(e)},Konva.Ring.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className="Ring",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(t){t.beginPath(),t.arc(0,0,this.getInnerRadius(),0,e,!1),t.moveTo(this.getOuterRadius(),0),t.arc(0,0,this.getOuterRadius(),e,0,!0),t.closePath(),t.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.outerRadius()!==e/2&&this.setOuterRadius(e/2)},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.outerRadius()!==e/2&&this.setOuterRadius(e/2)},setOuterRadius:function(e){this._setAttr("outerRadius",e),this.setWidth(2*e),this.setHeight(2*e)}},Konva.Util.extend(Konva.Ring,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Ring,"innerRadius",0),Konva.Factory.addGetter(Konva.Ring,"outerRadius",0),Konva.Factory.addOverloadedGetterSetter(Konva.Ring,"outerRadius"),Konva.Collection.mapMethods(Konva.Ring)}(),function(){"use strict";Konva.Wedge=function(e){this.___init(e)},Konva.Wedge.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className="Wedge",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){e.beginPath(),e.arc(0,0,this.getRadius(),0,Konva.getAngle(this.getAngle()),this.getClockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.radius()!==e/2&&this.setRadius(e/2)},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.radius()!==e/2&&this.setRadius(e/2)}},Konva.Util.extend(Konva.Wedge,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Wedge,"radius",0),Konva.Factory.addGetterSetter(Konva.Wedge,"angle",0),Konva.Factory.addGetterSetter(Konva.Wedge,"clockwise",!1),Konva.Factory.backCompat(Konva.Wedge,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Konva.Collection.mapMethods(Konva.Wedge)}(),function(){"use strict";Konva.Arc=function(e){this.___init(e)},Konva.Arc.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className="Arc",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t=Konva.getAngle(this.angle()),i=this.clockwise();e.beginPath(),e.arc(0,0,this.getOuterRadius(),0,t,i),e.arc(0,0,this.getInnerRadius(),t,0,!i),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.getOuterRadius()!==e/2&&this.setOuterRadius(e/2)},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.getOuterRadius()!==e/2&&this.setOuterRadius(e/2)}},Konva.Util.extend(Konva.Arc,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Arc,"innerRadius",0),Konva.Factory.addGetterSetter(Konva.Arc,"outerRadius",0),Konva.Factory.addGetterSetter(Konva.Arc,"angle",0),Konva.Factory.addGetterSetter(Konva.Arc,"clockwise",!1),Konva.Collection.mapMethods(Konva.Arc)}(),function(){"use strict";var e="Image";Konva.Image=function(e){this.___init(e)},Konva.Image.prototype={___init:function(t){Konva.Shape.call(this,t),this.className=e,this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()&&this.getStage()},_sceneFunc:function(e){var t,i,n,a=this.getWidth(),r=this.getHeight(),s=this.getImage();s&&(t=this.getCropWidth(),i=this.getCropHeight(),n=t&&i?[s,this.getCropX(),this.getCropY(),t,i,0,0,a,r]:[s,0,0,a,r]),(this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,a,r),e.closePath(),e.fillStrokeShape(this)),s&&e.drawImage.apply(e,n)},_hitFunc:function(e){var t=this.getWidth(),i=this.getHeight();e.beginPath(),e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)},getWidth:function(){var e=this.getImage();return this.attrs.width||(e?e.width:0)},getHeight:function(){var e=this.getImage();return this.attrs.height||(e?e.height:0)}},Konva.Util.extend(Konva.Image,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Image,"image"),Konva.Factory.addComponentsGetterSetter(Konva.Image,"crop",["x","y","width","height"]),Konva.Factory.addGetterSetter(Konva.Image,"cropX",0),Konva.Factory.addGetterSetter(Konva.Image,"cropY",0),Konva.Factory.addGetterSetter(Konva.Image,"cropWidth",0),Konva.Factory.addGetterSetter(Konva.Image,"cropHeight",0),Konva.Collection.mapMethods(Konva.Image),Konva.Image.fromURL=function(e,t){var i=new Image;i.onload=function(){var e=new Konva.Image({image:i});t(e)},i.src=e}}(),function(){"use strict";function e(e){e.fillText(this.partialText,0,0)}function t(e){e.strokeText(this.partialText,0,0)}var i="auto",n="center",a="Change.konva",r="2d",s="-",o="",l="left",h="text",u="Text",c="middle",d="normal",f="px ",p=" ",v="right",m="word",g="char",b="none",y=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","lineHeight","text","width","height","wrap"],_=y.length,x=Konva.Util.createCanvasElement().getContext(r);Konva.Text=function(e){this.___init(e)},Konva.Text.prototype={___init:function(n){n=n||{},n.fillLinearGradientColorStops||n.fillRadialGradientColorStops||(n.fill=n.fill||"black"),void 0===n.width&&(n.width=i),void 0===n.height&&(n.height=i),Konva.Shape.call(this,n),this._fillFunc=e,this._strokeFunc=t,this.className=u;for(var r=0;_>r;r++)this.on(y[r]+a,this._setTextData);this._setTextData(),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(e){var t,i=this.getPadding(),a=this.getTextHeight(),r=this.getLineHeight()*a,s=this.textArr,o=s.length,h=this.getWidth();for(e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",c),e.setAttr("textAlign",l),e.save(),i?(e.translate(i,0),e.translate(0,i+a/2)):e.translate(0,a/2),t=0;o>t;t++){var u=s[t],d=u.text,f=u.width;e.save(),this.getAlign()===v?e.translate(h-f-2*i,0):this.getAlign()===n&&e.translate((h-f-2*i)/2,0),this.partialText=d,e.fillStrokeShape(this),e.restore(),e.translate(0,r)}e.restore()},_hitFunc:function(e){var t=this.getWidth(),i=this.getHeight();e.beginPath(),e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)},setText:function(e){var t=Konva.Util._isString(e)?e:e.toString();return this._setAttr(h,t),this},getWidth:function(){return this.attrs.width===i?this.getTextWidth()+2*this.getPadding():this.attrs.width},getHeight:function(){return this.attrs.height===i?this.getTextHeight()*this.textArr.length*this.getLineHeight()+2*this.getPadding():this.attrs.height},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},_getTextSize:function(e){var t,i=x,n=this.getFontSize();return i.save(),i.font=this._getContextFont(),t=i.measureText(e),i.restore(),{width:t.width,height:parseInt(n,10)}},_getContextFont:function(){return this.getFontStyle()+p+this.getFontVariant()+p+this.getFontSize()+f+this.getFontFamily()},_addTextLine:function(e,t){return this.textArr.push({text:e,width:t})},_getTextWidth:function(e){return x.measureText(e).width},_setTextData:function(){var e=this.getText().split("\n"),t=+this.getFontSize(),n=0,a=this.getLineHeight()*t,r=this.attrs.width,o=this.attrs.height,l=r!==i,h=o!==i,u=this.getPadding(),c=r-2*u,d=o-2*u,f=0,v=this.getWrap(),m=v!==b,y=v!==g&&m;this.textArr=[],x.save(),x.font=this._getContextFont();for(var _=0,k=e.length;k>_;++_){var w=e[_],S=this._getTextWidth(w);if(l&&S>c)for(;w.length>0;){for(var C=0,P=w.length,T="",$=0;P>C;){var K=C+P>>>1,M=w.slice(0,K+1),L=this._getTextWidth(M);c>=L?(C=K+1,T=M,$=L):P=K}if(!T)break;if(y){var D=Math.max(T.lastIndexOf(p),T.lastIndexOf(s))+1;D>0&&(C=D,T=T.slice(0,C),$=this._getTextWidth(T))}if(this._addTextLine(T,$),n=Math.max(n,$),f+=a,!m||h&&f+a>d)break;if(w=w.slice(C),w.length>0&&(S=this._getTextWidth(w),c>=S)){this._addTextLine(w,S),f+=a,n=Math.max(n,S);break}}else this._addTextLine(w,S),f+=a,n=Math.max(n,S);if(h&&f+a>d)break}x.restore(),this.textHeight=t,this.textWidth=n}},Konva.Util.extend(Konva.Text,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Text,"fontFamily","Arial"),Konva.Factory.addGetterSetter(Konva.Text,"fontSize",12),Konva.Factory.addGetterSetter(Konva.Text,"fontStyle",d),Konva.Factory.addGetterSetter(Konva.Text,"fontVariant",d),Konva.Factory.addGetterSetter(Konva.Text,"padding",0),Konva.Factory.addGetterSetter(Konva.Text,"align",l),Konva.Factory.addGetterSetter(Konva.Text,"lineHeight",1),Konva.Factory.addGetterSetter(Konva.Text,"wrap",m),Konva.Factory.addGetter(Konva.Text,"text",o),Konva.Factory.addOverloadedGetterSetter(Konva.Text,"text"),Konva.Collection.mapMethods(Konva.Text)}(),function(){"use strict";Konva.Line=function(e){this.___init(e)},Konva.Line.prototype={___init:function(e){Konva.Shape.call(this,e),this.className="Line",this.on("pointsChange.konva tensionChange.konva closedChange.konva",function(){this._clearCache("tensionPoints")}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t,i,n,a=this.getPoints(),r=a.length,s=this.getTension(),o=this.getClosed();if(r){if(e.beginPath(),e.moveTo(a[0],a[1]),0!==s&&r>4){for(t=this.getTensionPoints(),i=t.length,n=o?0:4,o||e.quadraticCurveTo(t[0],t[1],t[2],t[3]);i-2>n;)e.bezierCurveTo(t[n++],t[n++],t[n++],t[n++],t[n++],t[n++]);o||e.quadraticCurveTo(t[i-2],t[i-1],a[r-2],a[r-1])}else for(n=2;r>n;n+=2)e.lineTo(a[n],a[n+1]);o?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}},getTensionPoints:function(){return this._getCache("tensionPoints",this._getTensionPoints)},_getTensionPoints:function(){return this.getClosed()?this._getTensionPointsClosed():Konva.Util._expandPoints(this.getPoints(),this.getTension())},_getTensionPointsClosed:function(){var e=this.getPoints(),t=e.length,i=this.getTension(),n=Konva.Util,a=n._getControlPoints(e[t-2],e[t-1],e[0],e[1],e[2],e[3],i),r=n._getControlPoints(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],i),s=Konva.Util._expandPoints(e,i),o=[a[2],a[3]].concat(s).concat([r[0],r[1],e[t-2],e[t-1],r[2],r[3],a[0],a[1],e[0],e[1]]);return o},getWidth:function(){return this.getSelfRect().width},getHeight:function(){return this.getSelfRect().height},getSelfRect:function(){var e;e=0!==this.getTension()?this._getTensionPoints():this.getPoints();for(var t,i,n=e[0],a=e[0],r=e[1],s=e[1],o=0;o<e.length/2;o++)t=e[2*o],i=e[2*o+1],n=Math.min(n,t),a=Math.max(a,t),r=Math.min(r,i),s=Math.max(s,i);return{x:Math.round(n),y:Math.round(r),width:Math.round(a-n),height:Math.round(s-r)}}},Konva.Util.extend(Konva.Line,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Line,"closed",!1),Konva.Factory.addGetterSetter(Konva.Line,"tension",0),Konva.Factory.addGetterSetter(Konva.Line,"points",[]),Konva.Collection.mapMethods(Konva.Line)}(),function(){"use strict";Konva.Sprite=function(e){this.___init(e)},Konva.Sprite.prototype={___init:function(e){Konva.Shape.call(this,e),this.className="Sprite",this._updated=!0;var t=this;this.anim=new Konva.Animation(function(){var e=t._updated;return t._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}),this.sceneFunc(this._sceneFunc),this.hitFunc(this._hitFunc)},_sceneFunc:function(e){var t=this.getAnimation(),i=this.frameIndex(),n=4*i,a=this.getAnimations()[t],r=this.frameOffsets(),s=a[n+0],o=a[n+1],l=a[n+2],h=a[n+3],u=this.getImage();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,l,h),e.closePath(),e.fillStrokeShape(this)),u)if(r){var c=r[t],d=2*i;e.drawImage(u,s,o,l,h,c[d+0],c[d+1],l,h)}else e.drawImage(u,s,o,l,h,0,0,l,h)},_hitFunc:function(e){var t=this.getAnimation(),i=this.frameIndex(),n=4*i,a=this.getAnimations()[t],r=this.frameOffsets(),s=a[n+2],o=a[n+3];if(e.beginPath(),r){var l=r[t],h=2*i;e.rect(l[h+0],l[h+1],s,o)}else e.rect(0,0,s,o);e.closePath(),e.fillShape(this)},_useBufferCanvas:function(){return(this.hasShadow()||1!==this.getAbsoluteOpacity())&&this.hasStroke()},_setInterval:function(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.getFrameRate())},start:function(){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()},stop:function(){this.anim.stop(),clearInterval(this.interval)},isRunning:function(){return this.anim.isRunning()},_updateIndex:function(){var e=this.frameIndex(),t=this.getAnimation(),i=this.getAnimations(),n=i[t],a=n.length/4;a-1>e?this.frameIndex(e+1):this.frameIndex(0)}},Konva.Util.extend(Konva.Sprite,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Sprite,"animation"),Konva.Factory.addGetterSetter(Konva.Sprite,"animations"),Konva.Factory.addGetterSetter(Konva.Sprite,"frameOffsets"),Konva.Factory.addGetterSetter(Konva.Sprite,"image"),Konva.Factory.addGetterSetter(Konva.Sprite,"frameIndex",0),Konva.Factory.addGetterSetter(Konva.Sprite,"frameRate",17),Konva.Factory.backCompat(Konva.Sprite,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Konva.Collection.mapMethods(Konva.Sprite)}(),function(){"use strict";Konva.Path=function(e){this.___init(e)},Konva.Path.prototype={___init:function(e){this.dataArray=[];var t=this;Konva.Shape.call(this,e),this.className="Path",this.dataArray=Konva.Path.parsePathData(this.getData()),this.on("dataChange.konva",function(){t.dataArray=Konva.Path.parsePathData(this.getData())}),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t=this.dataArray,i=!1;e.beginPath();for(var n=0;n<t.length;n++){var a=t[n].command,r=t[n].points;switch(a){case"L":e.lineTo(r[0],r[1]);break;case"M":e.moveTo(r[0],r[1]);break;case"C":e.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"Q":e.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"A":var s=r[0],o=r[1],l=r[2],h=r[3],u=r[4],c=r[5],d=r[6],f=r[7],p=l>h?l:h,v=l>h?1:l/h,m=l>h?h/l:1;e.translate(s,o),e.rotate(d),e.scale(v,m),e.arc(0,0,p,u,u+c,1-f),e.scale(1/v,1/m),e.rotate(-d),e.translate(-s,-o);break;case"z":e.closePath(),i=!0}}i?e.fillStrokeShape(this):e.strokeShape(this)},getSelfRect:function(){var e=[];this.dataArray.forEach(function(t){e=e.concat(t.points)});for(var t,i,n=e[0],a=e[0],r=e[0],s=e[0],o=0;o<e.length/2;o++)t=e[2*o],i=e[2*o+1],n=Math.min(n,t),a=Math.max(a,t),r=Math.min(r,i),s=Math.max(s,i);return{x:Math.round(n),y:Math.round(r),width:Math.round(a-n),height:Math.round(s-r)}}},Konva.Util.extend(Konva.Path,Konva.Shape),Konva.Path.getLineLength=function(e,t,i,n){return Math.sqrt((i-e)*(i-e)+(n-t)*(n-t))},Konva.Path.getPointOnLine=function(e,t,i,n,a,r,s){void 0===r&&(r=t),void 0===s&&(s=i);var o=(a-i)/(n-t+1e-8),l=Math.sqrt(e*e/(1+o*o));t>n&&(l*=-1);var h,u=o*l;if(n===t)h={x:r,y:s+u};else if((s-i)/(r-t+1e-8)===o)h={x:r+l,y:s+u};else{var c,d,f=this.getLineLength(t,i,n,a);if(1e-8>f)return void 0;var p=(r-t)*(n-t)+(s-i)*(a-i);p/=f*f,c=t+p*(n-t),d=i+p*(a-i);var v=this.getLineLength(r,s,c,d),m=Math.sqrt(e*e-v*v);l=Math.sqrt(m*m/(1+o*o)),t>n&&(l*=-1),u=o*l,h={x:c+l,y:d+u}}return h},Konva.Path.getPointOnCubicBezier=function(e,t,i,n,a,r,s,o,l){function h(e){return e*e*e}function u(e){return 3*e*e*(1-e)}function c(e){return 3*e*(1-e)*(1-e)}function d(e){return(1-e)*(1-e)*(1-e)}var f=o*h(e)+r*u(e)+n*c(e)+t*d(e),p=l*h(e)+s*u(e)+a*c(e)+i*d(e);return{x:f,y:p}},Konva.Path.getPointOnQuadraticBezier=function(e,t,i,n,a,r,s){function o(e){return e*e}function l(e){return 2*e*(1-e)}function h(e){return(1-e)*(1-e)}var u=r*o(e)+n*l(e)+t*h(e),c=s*o(e)+a*l(e)+i*h(e);return{x:u,y:c}},Konva.Path.getPointOnEllipticalArc=function(e,t,i,n,a,r){var s=Math.cos(r),o=Math.sin(r),l={x:i*Math.cos(a),y:n*Math.sin(a)};return{x:e+(l.x*s-l.y*o),y:t+(l.x*o+l.y*s)}},Konva.Path.parsePathData=function(e){if(!e)return[];var t=e,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)t=t.replace(new RegExp(i[n],"g"),"|"+i[n]);var a=t.split("|"),r=[],s=0,o=0;for(n=1;n<a.length;n++){var l=a[n],h=l.charAt(0);l=l.slice(1),l=l.replace(new RegExp(",-","g"),"-"),l=l.replace(new RegExp("-","g"),",-"),l=l.replace(new RegExp("e,-","g"),"e-");var u=l.split(",");u.length>0&&""===u[0]&&u.shift();for(var c=0;c<u.length;c++)u[c]=parseFloat(u[c]);for(;u.length>0&&!isNaN(u[0]);){var d,f,p,v,m,g,b,y,_,x,k=null,w=[],S=s,C=o;switch(h){case"l":s+=u.shift(),o+=u.shift(),k="L",w.push(s,o);break;case"L":s=u.shift(),o=u.shift(),w.push(s,o);break;case"m":var P=u.shift(),T=u.shift();if(s+=P,o+=T,k="M",r.length>2&&"z"===r[r.length-1].command)for(var $=r.length-2;$>=0;$--)if("M"===r[$].command){s=r[$].points[0]+P,o=r[$].points[1]+T;break}w.push(s,o),h="l";break;case"M":s=u.shift(),o=u.shift(),k="M",w.push(s,o),h="L";break;case"h":s+=u.shift(),k="L",w.push(s,o);break;case"H":s=u.shift(),k="L",w.push(s,o);break;case"v":o+=u.shift(),k="L",w.push(s,o);break;case"V":o=u.shift(),k="L",w.push(s,o);break;case"C":w.push(u.shift(),u.shift(),u.shift(),u.shift()),s=u.shift(),o=u.shift(),w.push(s,o);break;case"c":w.push(s+u.shift(),o+u.shift(),s+u.shift(),o+u.shift()),s+=u.shift(),o+=u.shift(),k="C",w.push(s,o);break;case"S":f=s,p=o,d=r[r.length-1],"C"===d.command&&(f=s+(s-d.points[2]),p=o+(o-d.points[3])),w.push(f,p,u.shift(),u.shift()),s=u.shift(),o=u.shift(),k="C",w.push(s,o);break;case"s":f=s,p=o,d=r[r.length-1],"C"===d.command&&(f=s+(s-d.points[2]),p=o+(o-d.points[3])),w.push(f,p,s+u.shift(),o+u.shift()),s+=u.shift(),o+=u.shift(),k="C",w.push(s,o);break;case"Q":w.push(u.shift(),u.shift()),s=u.shift(),o=u.shift(),w.push(s,o);break;case"q":w.push(s+u.shift(),o+u.shift()),s+=u.shift(),o+=u.shift(),k="Q",w.push(s,o);break;case"T":f=s,p=o,d=r[r.length-1],"Q"===d.command&&(f=s+(s-d.points[0]),p=o+(o-d.points[1])),s=u.shift(),o=u.shift(),k="Q",w.push(f,p,s,o);break;case"t":f=s,p=o,d=r[r.length-1],"Q"===d.command&&(f=s+(s-d.points[0]),p=o+(o-d.points[1])),s+=u.shift(),o+=u.shift(),k="Q",w.push(f,p,s,o);break;case"A":v=u.shift(),m=u.shift(),g=u.shift(),b=u.shift(),y=u.shift(),_=s,x=o,s=u.shift(),o=u.shift(),k="A",w=this.convertEndpointToCenterParameterization(_,x,s,o,b,y,v,m,g);break;case"a":v=u.shift(),m=u.shift(),g=u.shift(),b=u.shift(),y=u.shift(),_=s,x=o,s+=u.shift(),o+=u.shift(),k="A",w=this.convertEndpointToCenterParameterization(_,x,s,o,b,y,v,m,g)}r.push({command:k||h,points:w,start:{x:S,y:C},pathLength:this.calcLength(S,C,k||h,w)})}("z"===h||"Z"===h)&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r},Konva.Path.calcLength=function(e,t,i,n){var a,r,s,o,l=Konva.Path;switch(i){case"L":return l.getLineLength(e,t,n[0],n[1]);case"C":for(a=0,r=l.getPointOnCubicBezier(0,e,t,n[0],n[1],n[2],n[3],n[4],n[5]),o=.01;1>=o;o+=.01)s=l.getPointOnCubicBezier(o,e,t,n[0],n[1],n[2],n[3],n[4],n[5]),a+=l.getLineLength(r.x,r.y,s.x,s.y),r=s;return a;case"Q":for(a=0,r=l.getPointOnQuadraticBezier(0,e,t,n[0],n[1],n[2],n[3]),o=.01;1>=o;o+=.01)s=l.getPointOnQuadraticBezier(o,e,t,n[0],n[1],n[2],n[3]),a+=l.getLineLength(r.x,r.y,s.x,s.y),r=s;return a;case"A":a=0;var h=n[4],u=n[5],c=n[4]+u,d=Math.PI/180;if(Math.abs(h-c)<d&&(d=Math.abs(h-c)),r=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),0>u)for(o=h-d;o>c;o-=d)s=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),a+=l.getLineLength(r.x,r.y,s.x,s.y),r=s;else for(o=h+d;c>o;o+=d)s=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),a+=l.getLineLength(r.x,r.y,s.x,s.y),r=s;return s=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],c,0),a+=l.getLineLength(r.x,r.y,s.x,s.y)}return 0},Konva.Path.convertEndpointToCenterParameterization=function(e,t,i,n,a,r,s,o,l){var h=l*(Math.PI/180),u=Math.cos(h)*(e-i)/2+Math.sin(h)*(t-n)/2,c=-1*Math.sin(h)*(e-i)/2+Math.cos(h)*(t-n)/2,d=u*u/(s*s)+c*c/(o*o);d>1&&(s*=Math.sqrt(d),o*=Math.sqrt(d));var f=Math.sqrt((s*s*(o*o)-s*s*(c*c)-o*o*(u*u))/(s*s*(c*c)+o*o*(u*u)));a===r&&(f*=-1),isNaN(f)&&(f=0);var p=f*s*c/o,v=f*-o*u/s,m=(e+i)/2+Math.cos(h)*p-Math.sin(h)*v,g=(t+n)/2+Math.sin(h)*p+Math.cos(h)*v,b=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},y=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(b(e)*b(t))},_=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(y(e,t))},x=_([1,0],[(u-p)/s,(c-v)/o]),k=[(u-p)/s,(c-v)/o],w=[(-1*u-p)/s,(-1*c-v)/o],S=_(k,w);return y(k,w)<=-1&&(S=Math.PI),y(k,w)>=1&&(S=0),0===r&&S>0&&(S-=2*Math.PI),1===r&&0>S&&(S+=2*Math.PI),[m,g,s,o,x,S,h,r]},Konva.Factory.addGetterSetter(Konva.Path,"data"),Konva.Collection.mapMethods(Konva.Path)}(),function(){"use strict";function e(e){e.fillText(this.partialText,0,0)}function t(e){e.strokeText(this.partialText,0,0)}var i="",n="normal";Konva.TextPath=function(e){this.___init(e)},Konva.TextPath.prototype={___init:function(i){var n=this;this.dummyCanvas=Konva.Util.createCanvasElement(),this.dataArray=[],Konva.Shape.call(this,i),this._fillFunc=e,this._strokeFunc=t,this._fillFuncHit=e,this._strokeFuncHit=t,this.className="TextPath",this.dataArray=Konva.Path.parsePathData(this.attrs.data),this.on("dataChange.konva",function(){n.dataArray=Konva.Path.parsePathData(this.attrs.data)}),this.on("textChange.konva textStroke.konva textStrokeWidth.konva",n._setTextData),n._setTextData(),this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline","middle"),e.setAttr("textAlign","left"),e.save();for(var t=this.glyphInfo,i=0;i<t.length;i++){e.save();var n=t[i].p0;e.translate(n.x,n.y),e.rotate(t[i].rotation),this.partialText=t[i].text,e.fillStrokeShape(this),e.restore()}e.restore()},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},setText:function(e){Konva.Text.prototype.setText.call(this,e)},_getTextSize:function(e){var t=this.dummyCanvas,i=t.getContext("2d");i.save(),i.font=this._getContextFont();var n=i.measureText(e);return i.restore(),{width:n.width,height:parseInt(this.attrs.fontSize,10)}},_setTextData:function(){var e=this,t=this._getTextSize(this.attrs.text);this.textWidth=t.width,this.textHeight=t.height,this.glyphInfo=[];for(var i,n,a,r=this.attrs.text.split(""),s=-1,o=0,l=function(){o=0;for(var t=e.dataArray,n=s+1;n<t.length;n++){if(t[n].pathLength>0)return s=n,t[n];"M"===t[n].command&&(i={x:t[n].points[0],y:t[n].points[1]})}return{}},h=function(t){var r=e._getTextSize(t).width,s=0,h=0;for(n=void 0;Math.abs(r-s)/r>.01&&25>h;){h++;for(var u=s;void 0===a;)a=l(),a&&u+a.pathLength<r&&(u+=a.pathLength,a=void 0);if(a==={}||void 0===i)return void 0;var c=!1;switch(a.command){case"L":Konva.Path.getLineLength(i.x,i.y,a.points[0],a.points[1])>r?n=Konva.Path.getPointOnLine(r,i.x,i.y,a.points[0],a.points[1],i.x,i.y):a=void 0;break;case"A":var d=a.points[4],f=a.points[5],p=a.points[4]+f;0===o?o=d+1e-8:r>s?o+=Math.PI/180*f/Math.abs(f):o-=Math.PI/360*f/Math.abs(f),(0>f&&p>o||f>=0&&o>p)&&(o=p,c=!0),n=Konva.Path.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],o,a.points[6]);break;case"C":0===o?o=r>a.pathLength?1e-8:r/a.pathLength:r>s?o+=(r-s)/a.pathLength:o-=(s-r)/a.pathLength,o>1&&(o=1,c=!0),n=Konva.Path.getPointOnCubicBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case"Q":0===o?o=r/a.pathLength:r>s?o+=(r-s)/a.pathLength:o-=(s-r)/a.pathLength,o>1&&(o=1,c=!0),n=Konva.Path.getPointOnQuadraticBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}void 0!==n&&(s=Konva.Path.getLineLength(i.x,i.y,n.x,n.y)),c&&(c=!1,a=void 0)}},u=0;u<r.length&&(h(r[u]),void 0!==i&&void 0!==n);u++){var c=Konva.Path.getLineLength(i.x,i.y,n.x,n.y),d=0,f=Konva.Path.getPointOnLine(d+c/2,i.x,i.y,n.x,n.y),p=Math.atan2(n.y-i.y,n.x-i.x);this.glyphInfo.push({transposeX:f.x,transposeY:f.y,text:r[u],rotation:p,p0:i,p1:n}),i=n}},getSelfRect:function(){var e=[],t=this.fontSize();this.glyphInfo.forEach(function(t){e.push(t.p0.x),e.push(t.p0.y),e.push(t.p1.x),e.push(t.p1.y)});for(var i,n,a=e[0],r=e[0],s=e[0],o=e[0],l=0;l<e.length/2;l++)i=e[2*l],n=e[2*l+1],a=Math.min(a,i),r=Math.max(r,i),s=Math.min(s,n),o=Math.max(o,n);return{x:Math.round(a)-t,y:Math.round(s)-t,width:Math.round(r-a)+2*t,height:Math.round(o-s)+2*t}}},Konva.TextPath.prototype._getContextFont=Konva.Text.prototype._getContextFont,Konva.Util.extend(Konva.TextPath,Konva.Shape),Konva.Factory.addGetterSetter(Konva.TextPath,"fontFamily","Arial"),Konva.Factory.addGetterSetter(Konva.TextPath,"fontSize",12),Konva.Factory.addGetterSetter(Konva.TextPath,"fontStyle",n),Konva.Factory.addGetterSetter(Konva.TextPath,"fontVariant",n),Konva.Factory.addGetter(Konva.TextPath,"text",i),Konva.Collection.mapMethods(Konva.TextPath)}(),function(){"use strict";Konva.RegularPolygon=function(e){this.___init(e)},Konva.RegularPolygon.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className="RegularPolygon",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t,i,n,a=this.attrs.sides,r=this.attrs.radius;for(e.beginPath(),e.moveTo(0,0-r),t=1;a>t;t++)i=r*Math.sin(2*t*Math.PI/a),n=-1*r*Math.cos(2*t*Math.PI/a),e.lineTo(i,n);e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.radius()!==e/2&&this.setRadius(e/2)},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.radius()!==e/2&&this.setRadius(e/2)}},Konva.Util.extend(Konva.RegularPolygon,Konva.Shape),Konva.Factory.addGetterSetter(Konva.RegularPolygon,"radius",0),Konva.Factory.addGetterSetter(Konva.RegularPolygon,"sides",0),Konva.Collection.mapMethods(Konva.RegularPolygon)}(),function(){"use strict";Konva.Star=function(e){this.___init(e)},Konva.Star.prototype={_centroid:!0,___init:function(e){Konva.Shape.call(this,e),this.className="Star",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();e.beginPath(),e.moveTo(0,0-i);for(var a=1;2*n>a;a++){var r=a%2===0?i:t,s=r*Math.sin(a*Math.PI/n),o=-1*r*Math.cos(a*Math.PI/n);e.lineTo(s,o)}e.closePath(),e.fillStrokeShape(this)},getWidth:function(){return 2*this.getOuterRadius()},getHeight:function(){return 2*this.getOuterRadius()},setWidth:function(e){Konva.Node.prototype.setWidth.call(this,e),this.outerRadius()!==e/2&&this.setOuterRadius(e/2)},setHeight:function(e){Konva.Node.prototype.setHeight.call(this,e),this.outerRadius()!==e/2&&this.setOuterRadius(e/2)}},Konva.Util.extend(Konva.Star,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Star,"numPoints",5),Konva.Factory.addGetterSetter(Konva.Star,"innerRadius",0),Konva.Factory.addGetterSetter(Konva.Star,"outerRadius",0),Konva.Collection.mapMethods(Konva.Star)}(),function(){"use strict";var e=["fontFamily","fontSize","fontStyle","padding","lineHeight","text"],t="Change.konva",i="none",n="up",a="right",r="down",s="left",o="Label",l=e.length;Konva.Label=function(e){this.____init(e)},Konva.Label.prototype={____init:function(e){var t=this;Konva.Group.call(this,e),this.className=o,this.on("add.konva",function(e){t._addListeners(e.child),t._sync()})},getText:function(){return this.find("Text")[0]},getTag:function(){return this.find("Tag")[0]},_addListeners:function(i){var n,a=this,r=function(){a._sync()};for(n=0;l>n;n++)i.on(e[n]+t,r)},getWidth:function(){return this.getText().getWidth()},getHeight:function(){return this.getText().getHeight()},_sync:function(){var e,t,i,o,l,h,u,c=this.getText(),d=this.getTag();if(c&&d){switch(e=c.getWidth(),t=c.getHeight(),i=d.getPointerDirection(),o=d.getPointerWidth(),u=d.getPointerHeight(),l=0,h=0,i){case n:l=e/2,h=-1*u;break;case a:l=e+o,h=t/2;break;case r:l=e/2,h=t+u;break;case s:l=-1*o,h=t/2}d.setAttrs({x:-1*l,y:-1*h,width:e,height:t}),c.setAttrs({x:-1*l,y:-1*h})}}},Konva.Util.extend(Konva.Label,Konva.Group),Konva.Collection.mapMethods(Konva.Label),Konva.Tag=function(e){this.___init(e)},Konva.Tag.prototype={___init:function(e){Konva.Shape.call(this,e),this.className="Tag",this.sceneFunc(this._sceneFunc)},_sceneFunc:function(e){var t=this.getWidth(),i=this.getHeight(),o=this.getPointerDirection(),l=this.getPointerWidth(),h=this.getPointerHeight(),u=Math.min(this.getCornerRadius(),t/2,i/2);e.beginPath(),u?e.moveTo(u,0):e.moveTo(0,0),o===n&&(e.lineTo((t-l)/2,0),e.lineTo(t/2,-1*h),e.lineTo((t+l)/2,0)),u?(e.lineTo(t-u,0),e.arc(t-u,u,u,3*Math.PI/2,0,!1)):e.lineTo(t,0),o===a&&(e.lineTo(t,(i-h)/2),e.lineTo(t+l,i/2),e.lineTo(t,(i+h)/2)),u?(e.lineTo(t,i-u),e.arc(t-u,i-u,u,0,Math.PI/2,!1)):e.lineTo(t,i),o===r&&(e.lineTo((t+l)/2,i),e.lineTo(t/2,i+h),e.lineTo((t-l)/2,i)),u?(e.lineTo(u,i),e.arc(u,i-u,u,Math.PI/2,Math.PI,!1)):e.lineTo(0,i),o===s&&(e.lineTo(0,(i+h)/2),e.lineTo(-1*l,i/2),e.lineTo(0,(i-h)/2)),u&&(e.lineTo(0,u),e.arc(u,u,u,Math.PI,3*Math.PI/2,!1)),e.closePath(),e.fillStrokeShape(this)},getSelfRect:function(){var e=0,t=0,i=this.getPointerWidth(),o=this.getPointerHeight(),l=this.pointerDirection(),h=this.getWidth(),u=this.getHeight();return l===n?(t-=o,u+=o):l===r?u+=o:l===s?(e-=1.5*i,h+=i):l===a&&(h+=1.5*i),{x:e,y:t,width:h,height:u}}},Konva.Util.extend(Konva.Tag,Konva.Shape),Konva.Factory.addGetterSetter(Konva.Tag,"pointerDirection",i),Konva.Factory.addGetterSetter(Konva.Tag,"pointerWidth",0),Konva.Factory.addGetterSetter(Konva.Tag,"pointerHeight",0),Konva.Factory.addGetterSetter(Konva.Tag,"cornerRadius",0),Konva.Collection.mapMethods(Konva.Tag)}(),function(){"use strict";Konva.Arrow=function(e){this.____init(e)},Konva.Arrow.prototype={____init:function(e){Konva.Line.call(this,e),this.className="Arrow"},_sceneFunc:function(e){Konva.Line.prototype._sceneFunc.apply(this,arguments);var t=2*Math.PI,i=this.points(),n=i.length,a=i[n-2]-i[n-4],r=i[n-1]-i[n-3],s=(Math.atan2(r,a)+t)%t,o=this.pointerLength(),l=this.pointerWidth();e.save(),e.beginPath(),e.translate(i[n-2],i[n-1]),e.rotate(s),e.moveTo(0,0),e.lineTo(-o,l/2),e.lineTo(-o,-l/2),e.closePath(),e.restore(),this.pointerAtBeginning()&&(e.save(),e.translate(i[0],i[1]),a=i[2]-i[0],r=i[3]-i[1],e.rotate((Math.atan2(-r,-a)+t)%t),e.moveTo(0,0),e.lineTo(-o,l/2),e.lineTo(-o,-l/2),e.closePath(),e.restore()),e.fillStrokeShape(this)}},Konva.Util.extend(Konva.Arrow,Konva.Line),Konva.Factory.addGetterSetter(Konva.Arrow,"pointerLength",10),Konva.Factory.addGetterSetter(Konva.Arrow,"pointerWidth",10),Konva.Factory.addGetterSetter(Konva.Arrow,"pointerAtBeginning",!1),Konva.Collection.mapMethods(Konva.Arrow)}()},{canvas:173,jsdom:173}],173:[function(e,t,i){arguments[4][162][0].apply(i,arguments)},{dup:162}],174:[function(e,t,i){function n(){
this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function r(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,l,h;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],o(i))return!1;if(a(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),l=1;n>l;l++)r[l-1]=arguments[l];i.apply(this,r)}else if(s(i)){for(n=arguments.length,r=new Array(n-1),l=1;n>l;l++)r[l-1]=arguments[l];for(h=i.slice(),n=h.length,l=0;n>l;l++)h[l].apply(this,r)}return!0},n.prototype.addListener=function(e,t){var i;if(!a(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var i;i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!a(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,r,o;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],r=i.length,n=-1,i===t||a(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(o=r;o-->0;)if(i[o]===t||i[o].listener&&i[o].listener===t){n=o;break}if(0>n)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],a(i))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var i;return i=e._events&&e._events[t]?a(e._events[t])?1:e._events[t].length:0}},{}],175:[function(e,t,i){function n(){u=!1,o.length?h=o.concat(h):c=-1,h.length&&a()}function a(){if(!u){var e=setTimeout(n);u=!0;for(var t=h.length;t;){for(o=h,h=[];++c<t;)o[c].run();c=-1,t=h.length}o=null,u=!1,clearTimeout(e)}}function r(e,t){this.fun=e,this.array=t}function s(){}var o,l=t.exports={},h=[],u=!1,c=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new r(e,t)),1!==h.length||u||setTimeout(a,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=s,l.addListener=s,l.once=s,l.off=s,l.removeListener=s,l.removeAllListeners=s,l.emit=s,l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}]},{},[67])(67)});